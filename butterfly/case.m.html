<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>butterfly.case API documentation</title>
    <meta name="description" content="Butterfly OpenFOAM Case." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 0.9em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    margin-left: 25%;
    max-width: 90%;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    position: fixed;
    height: 100%;
    width: 25%;
    float: left;
    padding: 30px;
    overflow: auto;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  .desc {
    white-space: pre-wrap;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      position: inherit;
      float: none;
      width: auto;
    }
    #content {
      width: 95%;
      margin-left: auto;
      border-left: none;
      padding: 30px;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#butterfly.case.Case">Case</a></span>
        
          
  <ul>
    <li class="mono"><a href="#butterfly.case.Case.__init__">__init__</a></li>
    <li class="mono"><a href="#butterfly.case.Case.ToString">ToString</a></li>
    <li class="mono"><a href="#butterfly.case.Case.add_foam_file">add_foam_file</a></li>
    <li class="mono"><a href="#butterfly.case.Case.add_foam_files">add_foam_files</a></li>
    <li class="mono"><a href="#butterfly.case.Case.add_refinement_region">add_refinement_region</a></li>
    <li class="mono"><a href="#butterfly.case.Case.add_refinement_regions">add_refinement_regions</a></li>
    <li class="mono"><a href="#butterfly.case.Case.block_mesh">block_mesh</a></li>
    <li class="mono"><a href="#butterfly.case.Case.calculate_mesh_orthogonality">calculate_mesh_orthogonality</a></li>
    <li class="mono"><a href="#butterfly.case.Case.check_mesh">check_mesh</a></li>
    <li class="mono"><a href="#butterfly.case.Case.command">command</a></li>
    <li class="mono"><a href="#butterfly.case.Case.copy_snappy_hex_mesh">copy_snappy_hex_mesh</a></li>
    <li class="mono"><a href="#butterfly.case.Case.duplicate">duplicate</a></li>
    <li class="mono"><a href="#butterfly.case.Case.from_bf_geometries">from_bf_geometries</a></li>
    <li class="mono"><a href="#butterfly.case.Case.from_folder">from_folder</a></li>
    <li class="mono"><a href="#butterfly.case.Case.from_wind_tunnel">from_wind_tunnel</a></li>
    <li class="mono"><a href="#butterfly.case.Case.get_foam_file_by_name">get_foam_file_by_name</a></li>
    <li class="mono"><a href="#butterfly.case.Case.get_foam_files_from_location">get_foam_files_from_location</a></li>
    <li class="mono"><a href="#butterfly.case.Case.get_result_folders">get_result_folders</a></li>
    <li class="mono"><a href="#butterfly.case.Case.get_snappy_hex_mesh_folders">get_snappy_hex_mesh_folders</a></li>
    <li class="mono"><a href="#butterfly.case.Case.load_mesh">load_mesh</a></li>
    <li class="mono"><a href="#butterfly.case.Case.load_points">load_points</a></li>
    <li class="mono"><a href="#butterfly.case.Case.load_probe_values">load_probe_values</a></li>
    <li class="mono"><a href="#butterfly.case.Case.load_probes">load_probes</a></li>
    <li class="mono"><a href="#butterfly.case.Case.purge">purge</a></li>
    <li class="mono"><a href="#butterfly.case.Case.remove_poly_mesh_content">remove_poly_mesh_content</a></li>
    <li class="mono"><a href="#butterfly.case.Case.remove_post_processing_folder">remove_post_processing_folder</a></li>
    <li class="mono"><a href="#butterfly.case.Case.remove_processor_folders">remove_processor_folders</a></li>
    <li class="mono"><a href="#butterfly.case.Case.remove_result_folders">remove_result_folders</a></li>
    <li class="mono"><a href="#butterfly.case.Case.remove_snappy_hex_mesh_folders">remove_snappy_hex_mesh_folders</a></li>
    <li class="mono"><a href="#butterfly.case.Case.rename_snappy_hex_mesh_folders">rename_snappy_hex_mesh_folders</a></li>
    <li class="mono"><a href="#butterfly.case.Case.sample">sample</a></li>
    <li class="mono"><a href="#butterfly.case.Case.save">save</a></li>
    <li class="mono"><a href="#butterfly.case.Case.snappy_hex_mesh">snappy_hex_mesh</a></li>
    <li class="mono"><a href="#butterfly.case.Case.surface_feature_extract">surface_feature_extract</a></li>
    <li class="mono"><a href="#butterfly.case.Case.update_bc_in_zero_folder">update_bc_in_zero_folder</a></li>
  </ul>

        </li>
      </ul>
    </li>

    
    <li class="set"><h3>Module Index :: <a href="../butterfly/index.html">butterfly</a></h3>
    
    <ul>
      <li class="mono"><a href="../butterfly/RASProperties.m.html">RASProperties</a></li>
      

      <li class="mono"><a href="../butterfly/T.m.html">T</a></li>
      

      <li class="mono"><a href="../butterfly/U.m.html">U</a></li>
      

      <li class="mono"><a href="../butterfly/alphat.m.html">alphat</a></li>
      

      <li class="mono"><a href="../butterfly/blockMeshDict.m.html">blockMeshDict</a></li>
      

      <li class="mono"><a href="../butterfly/boundarycondition.m.html">boundarycondition</a></li>
      

      <li class="mono"><a href="">case</a></li>
      

      <li class="mono"><a href="../butterfly/conditions.m.html">conditions</a></li>
      

      <li class="mono"><a href="../butterfly/controlDict.m.html">controlDict</a></li>
      

      <li class="mono"><a href="../butterfly/decomposeParDict.m.html">decomposeParDict</a></li>
      

      <li class="mono"><a href="../butterfly/epsilon.m.html">epsilon</a></li>
      

      <li class="mono"><a href="../butterfly/exception.m.html">exception</a></li>
      

      <li class="mono"><a href="../butterfly/fields.m.html">fields</a></li>
      

      <li class="mono"><a href="../butterfly/foamfile.m.html">foamfile</a></li>
      

      <li class="mono"><a href="../butterfly/functions.m.html">functions</a></li>
      

      <li class="mono"><a href="../butterfly/fvSchemes.m.html">fvSchemes</a></li>
      

      <li class="mono"><a href="../butterfly/fvSolution.m.html">fvSolution</a></li>
      

      <li class="mono"><a href="../butterfly/g.m.html">g</a></li>
      

      <li class="mono"><a href="../butterfly/geometry.m.html">geometry</a></li>
      

      <li class="mono"><a href="../butterfly/grading.m.html">grading</a></li>
      

      <li class="mono"><a href="../butterfly/k.m.html">k</a></li>
      

      <li class="mono"><a href="../butterfly/make2dparameters.m.html">make2dparameters</a></li>
      

      <li class="mono"><a href="../butterfly/meshingparameters.m.html">meshingparameters</a></li>
      

      <li class="mono"><a href="../butterfly/nut.m.html">nut</a></li>
      

      <li class="mono"><a href="../butterfly/p.m.html">p</a></li>
      

      <li class="mono"><a href="../butterfly/p_rgh.m.html">p_rgh</a></li>
      

      <li class="mono"><a href="../butterfly/parser.m.html">parser</a></li>
      

      <li class="mono"><a href="../butterfly/recipe.m.html">recipe</a></li>
      

      <li class="mono"><a href="../butterfly/refinementRegion.m.html">refinementRegion</a></li>
      

      <li class="mono"><a href="../butterfly/runmanager.m.html">runmanager</a></li>
      

      <li class="mono"><a href="../butterfly/sampleDict.m.html">sampleDict</a></li>
      

      <li class="mono"><a href="../butterfly/snappyHexMeshDict.m.html">snappyHexMeshDict</a></li>
      

      <li class="mono"><a href="../butterfly/solution.m.html">solution</a></li>
      

      <li class="mono"><a href="../butterfly/surfaceFeatureExtractDict.m.html">surfaceFeatureExtractDict</a></li>
      

      <li class="mono"><a href="../butterfly/transportProperties.m.html">transportProperties</a></li>
      

      <li class="mono"><a href="../butterfly/turbulenceProperties.m.html">turbulenceProperties</a></li>
      

      <li class="mono"><a href="../butterfly/utilities.m.html">utilities</a></li>
      

      <li class="mono"><a href="../butterfly/vectormath.m.html">vectormath</a></li>
      

      <li class="mono"><a href="../butterfly/version.m.html">version</a></li>
      

      <li class="mono"><a href="../butterfly/windtunnel.m.html">windtunnel</a></li>
      

      <li class="mono"><a href="../butterfly/z0.m.html">z0</a></li>
      

    </ul>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">butterfly.case</span> module</h1>
  <p>Butterfly OpenFOAM Case.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case" class="source">
    <div class="codehilite"><pre><span></span><span class="err">﻿</span><span class="s2">&quot;&quot;&quot;Butterfly OpenFOAM Case.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># to check input names</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">rmtree</span>  <span class="c1"># to remove case folders if needed</span>
<span class="kn">from</span> <span class="nn">distutils.dir_util</span> <span class="kn">import</span> <span class="n">copy_tree</span>  <span class="c1"># to copy sHM meshes over to tri</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>

<span class="kn">from</span> <span class="nn">.version</span> <span class="kn">import</span> <span class="n">Version</span>
<span class="kn">from</span> <span class="nn">.utilities</span> <span class="kn">import</span> <span class="n">load_case_files</span><span class="p">,</span> <span class="n">load_probe_values_from_folder</span><span class="p">,</span> \
    <span class="n">load_probes_from_post_processing_file</span><span class="p">,</span> <span class="n">load_probes_and_values_from_sample_file</span>
<span class="kn">from</span> <span class="nn">.geometry</span> <span class="kn">import</span> <span class="n">bf_geometry_from_stl_file</span><span class="p">,</span> <span class="n">calculate_min_max_from_bf_geometries</span>
<span class="kn">from</span> <span class="nn">.refinementRegion</span> <span class="kn">import</span> <span class="n">refinement_regions_from_stl_file</span>
<span class="kn">from</span> <span class="nn">.meshingparameters</span> <span class="kn">import</span> <span class="n">MeshingParameters</span>
<span class="kn">from</span> <span class="nn">.fields</span> <span class="kn">import</span> <span class="n">Field</span>

<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">.foamfile</span> <span class="kn">import</span> <span class="n">FoamFile</span>

<span class="c1"># constant folder objects</span>
<span class="kn">from</span> <span class="nn">.turbulenceProperties</span> <span class="kn">import</span> <span class="n">TurbulenceProperties</span>
<span class="kn">from</span> <span class="nn">.RASProperties</span> <span class="kn">import</span> <span class="n">RASProperties</span>
<span class="kn">from</span> <span class="nn">.transportProperties</span> <span class="kn">import</span> <span class="n">TransportProperties</span>
<span class="kn">from</span> <span class="nn">.g</span> <span class="kn">import</span> <span class="n">G</span>

<span class="c1"># 0 folder objects</span>
<span class="kn">from</span> <span class="nn">.U</span> <span class="kn">import</span> <span class="n">U</span>
<span class="kn">from</span> <span class="nn">.k</span> <span class="kn">import</span> <span class="n">K</span>
<span class="kn">from</span> <span class="nn">.p</span> <span class="kn">import</span> <span class="n">P</span>
<span class="kn">from</span> <span class="nn">.nut</span> <span class="kn">import</span> <span class="n">Nut</span>
<span class="kn">from</span> <span class="nn">.epsilon</span> <span class="kn">import</span> <span class="n">Epsilon</span>
<span class="kn">from</span> <span class="nn">.T</span> <span class="kn">import</span> <span class="n">T</span>
<span class="kn">from</span> <span class="nn">.alphat</span> <span class="kn">import</span> <span class="n">Alphat</span>
<span class="kn">from</span> <span class="nn">.p_rgh</span> <span class="kn">import</span> <span class="n">P_rgh</span>
<span class="kn">from</span> <span class="nn">.conditions</span> <span class="kn">import</span> <span class="n">ABLConditions</span><span class="p">,</span> <span class="n">InitialConditions</span>

<span class="c1"># # system folder objects</span>
<span class="kn">from</span> <span class="nn">.blockMeshDict</span> <span class="kn">import</span> <span class="n">BlockMeshDict</span>
<span class="kn">from</span> <span class="nn">.controlDict</span> <span class="kn">import</span> <span class="n">ControlDict</span>
<span class="kn">from</span> <span class="nn">.snappyHexMeshDict</span> <span class="kn">import</span> <span class="n">SnappyHexMeshDict</span>
<span class="kn">from</span> <span class="nn">.fvSchemes</span> <span class="kn">import</span> <span class="n">FvSchemes</span>
<span class="kn">from</span> <span class="nn">.fvSolution</span> <span class="kn">import</span> <span class="n">FvSolution</span>
<span class="kn">from</span> <span class="nn">.functions</span> <span class="kn">import</span> <span class="n">Probes</span>
<span class="kn">from</span> <span class="nn">.decomposeParDict</span> <span class="kn">import</span> <span class="n">DecomposeParDict</span>
<span class="kn">from</span> <span class="nn">.sampleDict</span> <span class="kn">import</span> <span class="n">SampleDict</span>

<span class="kn">from</span> <span class="nn">.runmanager</span> <span class="kn">import</span> <span class="n">RunManager</span>


<span class="k">class</span> <span class="nc">Case</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Principal class for OpenFOAM Cases.</span>

<span class="sd">    This class can either be instantiated directly through the __init__ constructor or</span>
<span class="sd">    through the following classmethods:</span>

<span class="sd">        1. from_folder: Create a Butterfly case from a case folder</span>
<span class="sd">        2. from_bf_geometries: Create a case from Butterfly geometries.</span>
<span class="sd">        3. from_wind_tunnel: Create case from wind tunnel.</span>


<span class="sd">    Notes for beginners:</span>
<span class="sd">        What is an OpenFOAM case?</span>
<span class="sd">            As defined by AndRAS Horvath in &quot;OpenFOAM tutorial collection&quot;, a case is the</span>
<span class="sd">            combination of geometry definition (the finite volume mesh), configuration</span>
<span class="sd">            files (called dictionaries in OpenFOAM language), definition of boundary</span>
<span class="sd">            conditions and initial conditions, custom function and results all structured</span>
<span class="sd">            in many files and directories. The 0-directory contains the initial- and</span>
<span class="sd">            boundary-conditions. The (initial) mesh is in constant/polyMesh. Most config</span>
<span class="sd">            files are in system/. Material and turbulence properties are in</span>
<span class="sd">            constant/.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBFOLDERS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">polyMesh&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">triSurface&#39;</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="c1"># minimum list of files to be able to run blockMesh and snappyHexMesh</span>
    <span class="n">MINFOAMFIles</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;fv_schemes&#39;</span><span class="p">,</span> <span class="s1">&#39;fv_solution&#39;</span><span class="p">,</span> <span class="s1">&#39;controlDict&#39;</span><span class="p">,</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">,</span> <span class="n">geometries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init case.</span>

<span class="sd">        Attributes:</span>
<span class="sd">        name: Case name as a string with no whitespace.</span>

<span class="sd">        :type name: str</span>

<span class="sd">        foamfiles: Collection of FoamFile objects (dictionaries) for this case.</span>

<span class="sd">        :type   foamfiles: FoamFile</span>

<span class="sd">        geometries: Collection of geometry-like objects. Geometries should have</span>
<span class="sd">            a name and toStlString method. The information related to boundary</span>
<span class="sd">            condition should already be included in related foamfiles. If you</span>
<span class="sd">            want to initiate the class form a folder or a number of bf_geometries</span>
<span class="sd">            use from_folder, and from_bf_geometries classmethods.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># original name is a variable to address the current limitation to change</span>
        <span class="c1"># the name of stl file in snappyHexMeshDict. It will be removed once the</span>
        <span class="c1"># limitation is addressed. The value wil be assigned in classmethod from_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__version</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">of_ver</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># optional input for changing working directory</span>
        <span class="c1"># should not be used on OpenFOAM on Windows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;butterfly&#39;</span><span class="p">)</span>

        <span class="c1"># set foamfiles dynamically. This is flexible but makes documentation</span>
        <span class="c1"># tricky. also autocomplete won&#39;t work for this cases.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_foam_files</span><span class="p">(</span><span class="n">foamfiles</span><span class="p">)</span>

        <span class="c1"># set butterfly geometries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>

        <span class="c1"># place holder for refinment regions</span>
        <span class="c1"># use .add_refinement_regions to add regions to case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span> <span class="o">=</span> <span class="n">RunManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_folder</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">convert_from_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Butterfly case from a case folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Full path to case folder.</span>
<span class="sd">            name: An optional new name for this case.</span>
<span class="sd">            convert_from_meters: A number to be multiplied to stl file vertices</span>
<span class="sd">                to be converted to the new units if not meters. This value will</span>
<span class="sd">                be the inverse of convert_to_meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># collect foam files</span>
        <span class="n">__originalName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">__originalName</span>

        <span class="n">_files</span> <span class="o">=</span> <span class="n">load_case_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># convert files to butterfly objects</span>
        <span class="n">ff</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">_files</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">_files</span><span class="o">.</span><span class="n">constant</span><span class="p">,</span> <span class="n">_files</span><span class="o">.</span><span class="n">system</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">cls</span><span class="o">.</span><span class="n">__create_foamfile_from_file</span><span class="p">(</span>
                            <span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">convert_from_meters</span><span class="p">))</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Imported {} from case.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="n">s_hmd</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__get_foam_file_by_name</span><span class="p">(</span><span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">,</span> <span class="n">ff</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s_hmd</span><span class="p">:</span>
            <span class="n">s_hmd</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">name</span>

            <span class="n">stlfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_files</span><span class="o">.</span><span class="n">stl</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.stl&#39;</span><span class="p">))</span>
            <span class="n">bf_geometries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">geo</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">stlfiles</span>
                <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">bf_geometry_from_stl_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">convert_from_meters</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">stl_file_names</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">bf_geometries</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">_case</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ff</span><span class="p">,</span> <span class="n">bf_geometries</span><span class="p">)</span>

        <span class="c1"># update each field of boundary condition for geometries</span>
        <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">_case</span><span class="o">.</span><span class="n">get_foam_files_from_location</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">_case</span><span class="o">.</span><span class="n">geometries</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">get_boundary_field</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">geo</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Conditions&#39;</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># set boundary condition for the field</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Field</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">s_hmd</span><span class="p">:</span>
            <span class="n">refinement_regions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">ref</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_files</span><span class="o">.</span><span class="n">stl</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">refinement_region_names</span>
                <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">refinement_regions_from_stl_file</span><span class="p">(</span>
                    <span class="n">f</span><span class="p">,</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">refinement_region_mode</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]))</span>
            <span class="p">)</span>

            <span class="n">_case</span><span class="o">.</span><span class="n">add_refinement_regions</span><span class="p">(</span><span class="n">refinement_regions</span><span class="p">)</span>

        <span class="c1"># original name is a variable to address the current limitation to change</span>
        <span class="c1"># the name of stl file in snappyHexMeshDict. It will be removed once the</span>
        <span class="c1"># limitation is addressed.</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="n">__originalName</span>

        <span class="k">return</span> <span class="n">_case</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_bf_geometries</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">blockMeshDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">meshing_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">convert_to_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a case from Butterfly geometries.</span>

<span class="sd">        foam_files/dictionaries will be generated based on boundary condition of</span>
<span class="sd">        geometries. fv_solution and fv_schemes will be set to default can can be</span>
<span class="sd">        overwritten once a Solution is created from a Case and a Recipe. You can</span>
<span class="sd">        overwrite them through the recipe.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Case name as a string with no whitespace.</span>
<span class="sd">            geometries: Collection of bf_geometries. FoamFiles/dictionaries will</span>
<span class="sd">                be generated based on boundary condition of geometries.</span>
<span class="sd">            blockMeshDict: Optional input for blockMeshDict. If blockMeshDict is</span>
<span class="sd">                not provided, it will be calculated from geometries in XY</span>
<span class="sd">                direction and boundary condition for faces will be set to</span>
<span class="sd">                BoundingBoxBoundaryCondition. Use BlockMeshDict to create the</span>
<span class="sd">                blockMeshDict if your case is not aligned to XY direction or you</span>
<span class="sd">                need to assign different boundary condition to geometries.</span>
<span class="sd">            meshing_parameters: Optional input for MeshingParameters.</span>
<span class="sd">            make2d_parameters: Optional input for make2d_parameters to make a 2d</span>
<span class="sd">                case.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">geometries</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_check_input_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>

        <span class="c1"># update meshing_parameters</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">meshing_parameters</span><span class="p">:</span>
            <span class="n">meshing_parameters</span> <span class="o">=</span> <span class="n">MeshingParameters</span><span class="p">()</span>

        <span class="c1"># create foam files</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">blockMeshDict</span><span class="p">:</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">calculate_min_max_from_bf_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>
            <span class="n">blockMeshDict</span> <span class="o">=</span> <span class="n">BlockMeshDict</span><span class="o">.</span><span class="n">from_min_max</span><span class="p">(</span>
                <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">make2d_parameters</span><span class="p">:</span>
            <span class="c1"># create the 2D blockMeshDict</span>
            <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">make2d</span><span class="p">(</span>
                <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span>
                <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>

        <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">update_meshing_parameters</span><span class="p">(</span><span class="n">meshing_parameters</span><span class="p">)</span>

        <span class="c1"># set the location_in_mesh for snappyHexMeshDict</span>
        <span class="k">if</span> <span class="n">make2d_parameters</span><span class="p">:</span>
            <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span> <span class="o">=</span> <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">origin</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span><span class="p">:</span>
            <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span> <span class="o">=</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">center</span>

        <span class="c1"># rename name for snappyHexMeshDict and stl file if starts with a digit</span>
        <span class="n">normname</span> <span class="o">=</span> <span class="s1">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">name</span>
        <span class="n">snappyHexMeshDict</span> <span class="o">=</span> <span class="n">SnappyHexMeshDict</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span>
            <span class="n">normname</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">meshing_parameters</span><span class="p">,</span>
            <span class="n">convert_to_meters</span><span class="o">=</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">convert_to_meters</span><span class="p">)</span>

        <span class="c1"># constant folder</span>
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">of_ver</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">turbulence_properties</span> <span class="o">=</span> <span class="n">RASProperties</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">turbulence_properties</span> <span class="o">=</span> <span class="n">TurbulenceProperties</span><span class="p">()</span>
        <span class="n">transport_properties</span> <span class="o">=</span> <span class="n">TransportProperties</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="p">()</span>

        <span class="c1"># 0 floder</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_geometries</span> <span class="o">=</span> <span class="n">geometries</span> <span class="o">+</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">_geometries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span> <span class="o">+</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">Epsilon</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">nut</span> <span class="o">=</span> <span class="n">Nut</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">alphat</span> <span class="o">=</span> <span class="n">Alphat</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">p_rgh</span> <span class="o">=</span> <span class="n">P_rgh</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>

        <span class="c1"># system folder</span>
        <span class="n">fv_schemes</span> <span class="o">=</span> <span class="n">FvSchemes</span><span class="p">()</span>
        <span class="n">fv_solution</span> <span class="o">=</span> <span class="n">FvSolution</span><span class="p">()</span>
        <span class="n">control_dict</span> <span class="o">=</span> <span class="n">ControlDict</span><span class="p">()</span>
        <span class="n">probes</span> <span class="o">=</span> <span class="n">Probes</span><span class="p">()</span>

        <span class="n">foam_files</span> <span class="o">=</span> <span class="p">(</span><span class="n">blockMeshDict</span><span class="p">,</span> <span class="n">snappyHexMeshDict</span><span class="p">,</span> <span class="n">turbulence_properties</span><span class="p">,</span>
                      <span class="n">transport_properties</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">nut</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">alphat</span><span class="p">,</span>
                      <span class="n">p_rgh</span><span class="p">,</span> <span class="n">fv_schemes</span><span class="p">,</span> <span class="n">fv_solution</span><span class="p">,</span> <span class="n">control_dict</span><span class="p">,</span> <span class="n">probes</span><span class="p">)</span>

        <span class="c1"># create case</span>
        <span class="n">_cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">foam_files</span><span class="p">,</span> <span class="n">geometries</span><span class="p">)</span>
        <span class="n">_cls</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="n">normname</span>
        <span class="k">return</span> <span class="n">_cls</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_wind_tunnel</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create case from wind tunnel.&quot;&quot;&quot;</span>
        <span class="n">_case</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span>
            <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">test_geomtries</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="p">,</span>
            <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">meshing_parameters</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="p">)</span>

        <span class="n">initial_conditions</span> <span class="o">=</span> <span class="n">InitialConditions</span><span class="p">(</span>
            <span class="n">uref</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">flow_speed</span><span class="p">,</span> <span class="n">zref</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">zref</span><span class="p">,</span> <span class="n">z0</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">z0</span><span class="p">)</span>

        <span class="n">abl_conditions</span> <span class="o">=</span> <span class="n">ABLConditions</span><span class="o">.</span><span class="n">from_wind_tunnel</span><span class="p">(</span><span class="n">wind_tunnel</span><span class="p">)</span>

        <span class="c1"># add initial_conditions and ABLConditions to _case</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">add_foam_files</span><span class="p">((</span><span class="n">initial_conditions</span><span class="p">,</span> <span class="n">abl_conditions</span><span class="p">))</span>

        <span class="c1"># include condition files in 0 folder files</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $flowVelocity&#39;</span><span class="p">},</span>
                              <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $pressure&#39;</span><span class="p">},</span>
                              <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">k</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $turbulentKE&#39;</span><span class="p">},</span>
                              <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">epsilon</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $turbulentEpsilon&#39;</span><span class="p">},</span>
                                    <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
                <span class="n">_case</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_case</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return True.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Project name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__project_name</span>

    <span class="nd">@project_name.setter</span>
    <span class="k">def</span> <span class="nf">project_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^[a-zA-Z0-9_]*$&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> \
            <span class="s1">&#39;Invalid project name: &quot;{}&quot;.</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;Do not use whitespace or special charecters.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__project_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geometries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Butterfly geometries.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change default working directory.</span>

<span class="sd">        Do not change the working dir if you are using OpenFOAM for Windows</span>
<span class="sd">        to run the analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__workingDir</span>

    <span class="nd">@working_dir.setter</span>
    <span class="k">def</span> <span class="nf">working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__workingDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get project directory.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">zero_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Folder 0 fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constant_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;constant folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">system_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;system folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">log_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;log folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">poly_mesh_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;polyMesh folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">polyMesh&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tri_surface_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;triSurface folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">triSurface&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">post_processing_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;postProcessing folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;postProcessing&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probes_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fullpath to probes folder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">,</span> <span class="s1">&#39;probes&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">foam_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all the foam_files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">refinement_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get refinement regions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_poly_mesh_snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the mesh in polyMesh folder is snappyHexMesh.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">5</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get and set Probes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__probes</span>

    <span class="nd">@probes.setter</span>
    <span class="k">def</span> <span class="nf">probes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inp</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="s1">&#39;probeLocations&#39;</span><span class="p">),</span> \
            <span class="s2">&quot;Expected Probes not {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__probes</span> <span class="o">=</span> <span class="n">inp</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># include probes in controlDict</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controlDict</span><span class="o">.</span><span class="n">include</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">filename</span>

    <span class="k">def</span> <span class="nf">get_foam_file_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a foamfile by name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_foam_file_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return sorted list of numerical folders.&quot;&quot;&quot;</span>
        <span class="n">_f</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                                                    <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">))</span>
                         <span class="p">)])</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_result_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return sorted list of numerical folders.&quot;&quot;&quot;</span>
        <span class="n">_f</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span> <span class="ow">and</span>
                         <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                             <span class="n">name</span><span class="p">,</span>
                             <span class="s1">&#39;polyMesh&#39;</span><span class="p">))</span>
                         <span class="p">)])</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_foam_files_from_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get foam_files in a specific location (0, constant, system).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span>
                         <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="s1">&#39;&quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_foam_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add foamfiles to the Case.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">foamfiles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_foam_file</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_foam_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a foamfile to the case.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">foamfile</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">foamfile</span><span class="p">,</span> <span class="s1">&#39;isFoamFile&#39;</span><span class="p">),</span> \
            <span class="s1">&#39;{} is not a FoamFile&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foamfile</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">foamfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">foamfile</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Failed to add {}.</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foamfile</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_refinement_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refinement_regions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a collections of refinement regions.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">refinement_region</span> <span class="ow">in</span> <span class="n">refinement_regions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_refinement_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refinement_region</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a refinement region.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">,</span> <span class="s1">&#39;isRefinementRegion&#39;</span><span class="p">),</span> \
            <span class="s2">&quot;{} is not a refinement region.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">),</span> \
            <span class="s1">&#39;You can</span><span class="se">\&#39;</span><span class="s1">t add a refinement_region to a case with no snappyHexMeshDict.&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">snappy_hex_meshDict</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy_snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_number</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the results of snappyHexMesh to constant/polyMesh.&quot;&quot;&quot;</span>
        <span class="c1"># pick the last numerical folder</span>
        <span class="k">if</span> <span class="n">folder_number</span><span class="p">:</span>
            <span class="n">_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">folder_number</span><span class="p">),</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_s</span><span class="p">),</span> <span class="s2">&quot;Can&#39;t find {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_folders</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">_folders</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">)</span>

        <span class="c1"># copy files to constant/polyMesh</span>
        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">copy_tree</span><span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Failed to copy snappyHexMesh folder: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">rename_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename snappyHexMesh numerical folders to name.org  and vice versa.</span>

<span class="sd">        Args:</span>
<span class="sd">            add: Set to True to add .org at the end of the file. Set to False</span>
<span class="sd">                to rename them back to the original naming.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># find list of folders in project and collect the numbers</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span>
            <span class="n">_folders</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.org&#39;</span><span class="p">)</span> <span class="ow">and</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                       <span class="s1">&#39;polyMesh&#39;</span><span class="p">))))</span>

            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                          <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.org&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>

            <span class="c1"># rename them starting from 1</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.org&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Failed to rename snappyHexMesh folders: {}&#39;</span>
                                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove snappyHexMesh numerical folders.</span>

<span class="sd">        Use this to clean the folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename_snappy_hex_mesh_folders</span><span class="p">(</span><span class="n">add</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove {}:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_result_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove results folder.&quot;&quot;&quot;</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_folders</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">_f</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove {}:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_f</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_post_processing_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove post postProcessing folder.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove postProcessing folder:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_poly_mesh_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove files inside polyMesh folder.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">_f</span> <span class="o">!=</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span>
                <span class="n">_fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">,</span> <span class="n">_f</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">_fp</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">_fp</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_fp</span><span class="p">):</span>
                    <span class="n">rmtree</span><span class="p">(</span><span class="n">_fp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_processor_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove processor folders for parallel runs.&quot;&quot;&quot;</span>

        <span class="n">ff</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
              <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;processor&#39;</span><span class="p">)</span> <span class="ow">and</span>
              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">d</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ff</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove processor folder:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">purge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_poly_mesh_content</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">remove_snappy_hex_mesh_folders</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">remove_result_folders</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
              <span class="n">remove_post_processing_folder</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Purge case folder.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">remove_poly_mesh_content</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">remove_snappy_hex_mesh_folders</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_snappy_hex_mesh_folders</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">remove_result_folders</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_result_folders</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">remove_post_processing_folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_post_processing_folder</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update_bc_in_zero_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update boundary conditions in files in 0 folder.</span>

<span class="sd">        Call this method if you have made any changes to boundary condition of</span>
<span class="sd">        any of the geometries after initiating the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save case to folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            overwrite: If True all the current content will be overwritten</span>
<span class="sd">                (default: False).</span>
<span class="sd">            minimum: Write minimum necessary files for case. These files will</span>
<span class="sd">                be enough for meshing the case but not running any commands.</span>
<span class="sd">                Files are (&#39;fv_schemes&#39;, &#39;fv_solution&#39;, &#39;controlDict&#39;,</span>
<span class="sd">                &#39;blockMeshDict&#39;,&#39;snappyHexMeshDict&#39;). Rest of the files will be</span>
<span class="sd">                created from a Solution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create folder and subfolders if they are not already created</span>
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">):</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUBFOLDERS</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Butterfly failed to create {}</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[Error 183]&#39;</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># save foamfiles</span>
        <span class="k">if</span> <span class="n">minimum</span><span class="p">:</span>
            <span class="n">foam_files</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span>
                          <span class="k">if</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MINFOAMFIles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">foam_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">foam_files</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>

        <span class="c1"># find blockMeshDict and convert_to_meters so I can scale stl files to meters.</span>
        <span class="n">bmds</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span> <span class="k">if</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">)</span>
        <span class="n">bmd</span> <span class="o">=</span> <span class="n">bmds</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">convert_to_meters</span> <span class="o">=</span> <span class="n">bmd</span><span class="o">.</span><span class="n">convert_to_meters</span>

        <span class="c1"># write bfgeometries to stl file. __geometries is geometries without</span>
        <span class="c1"># blockMesh geometry</span>
        <span class="n">stl_str</span> <span class="o">=</span> <span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">to_stl</span><span class="p">(</span><span class="n">convert_to_meters</span><span class="p">)</span> <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span><span class="p">)</span>
        <span class="n">stl_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__originalName</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tri_surface_folder</span><span class="p">,</span>
                               <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.stl&#39;</span> <span class="o">%</span> <span class="n">stl_name</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stlf</span><span class="p">:</span>
            <span class="n">stlf</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">stl_str</span><span class="p">)</span>

        <span class="c1"># write refinement_regions to stl files</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
            <span class="n">ref</span><span class="o">.</span><span class="n">write_to_stl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tri_surface_folder</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>

        <span class="c1"># add .foam file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">+</span> <span class="s1">&#39;.foam&#39;</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ffile</span><span class="p">:</span>
            <span class="n">ffile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} is saved to: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sa">ur</span><span class="sd">&quot;&quot;&quot;Run an OpenFOAM command for this case.</span>
<span class="sd">        This method creates a log and err file under logFolder for each command.</span>
<span class="sd">        The output will be logged as {cmd}.log and {cmd}.err.</span>
<span class="sd">        Args:</span>
<span class="sd">            cmd: OpenFOAM command.</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            decomposeParDict: Optional input for decomposeParDict to run analysis</span>
<span class="sd">                in parallel if desired.</span>
<span class="sd">            run: Run the command in shell.</span>
<span class="sd">            wait: Wait until the command is over.</span>
<span class="sd">        returns:</span>
<span class="sd">            If run is True returns a namedtuple for</span>
<span class="sd">                (success, error, process, logfiles, errorfiles).</span>
<span class="sd">                success: as a boolen.</span>
<span class="sd">                error: None in case of success otherwise the error message as</span>
<span class="sd">                    a string.</span>
<span class="sd">                process: Popen process.</span>
<span class="sd">                logfiles: List of fullpath to log files.</span>
<span class="sd">                errorfiles: List of fullpath to error files.</span>
<span class="sd">            else return a namedtuple for</span>
<span class="sd">                (cmd, logfiles, errorfiles)</span>
<span class="sd">                cmd: command lines.</span>
<span class="sd">                logfiles: A tuple for log files.</span>
<span class="sd">                errorfiles: A tuple for error files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">run</span><span class="p">:</span>
            <span class="n">cmdlog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cmdlog</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;success error process logfiles errorfiles&#39;</span><span class="p">)</span>

            <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span>
                                                        <span class="n">decomposeParDict</span><span class="p">,</span> <span class="n">wait</span><span class="p">)</span>

            <span class="n">logfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                             <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">logfiles</span><span class="p">)</span>

            <span class="n">errfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                             <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">errfiles</span><span class="p">)</span>

            <span class="c1"># check error files and raise and error</span>
            <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">check_file_contents</span><span class="p">(</span><span class="n">logfiles</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">hascontent</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">check_file_contents</span><span class="p">(</span><span class="n">errfiles</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="ow">not</span> <span class="n">hascontent</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># return a namedtuple assuming that the command is running fine.</span>
                <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">block_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">,):</span>
        <span class="sd">&quot;&quot;&quot;Run blockMesh.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">            overwrite: Overwrite current content of the folder.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;blockMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">surface_feature_extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run surfaceFeatureExtract command.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create surfaceFeatureExtractDict if it&#39;s not created</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;surfaceFeatureExtract&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="c1"># TODO(Mostapha): Sample for multiple fields.</span>
    <span class="c1"># The reason we don&#39;t have it now is that I don&#39;t have the methods in place</span>
    <span class="c1"># for dealing with lists of lists in GRASshopper.</span>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sample the results for a certain field.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: A unique name for this sample.</span>
<span class="sd">            points: List of points as (x, y, z).</span>
<span class="sd">            fields: List of fields (e.g. U, p).</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(probes, values).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="n">SampleDict</span><span class="o">.</span><span class="n">from_points</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="p">(</span><span class="n">field</span><span class="p">,))</span>
        <span class="n">sd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>

        <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span>
            <span class="s1">&#39;postProcess&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-func&#39;</span><span class="p">,</span> <span class="s1">&#39;sampleDict&#39;</span><span class="p">,</span> <span class="s1">&#39;-latest_time&#39;</span><span class="p">),</span>
            <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to sample the case:</span><span class="se">\n\t</span><span class="si">%s</span><span class="s2">&quot;</span>
                            <span class="o">%</span> <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>

        <span class="n">rf</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_folders</span><span class="p">())</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
            <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Found no results folder. Either you have not run the &#39;</span>
                    <span class="s1">&#39;analysis or the run has faild. Check inside &quot;log&quot; folder.&#39;</span><span class="p">)</span>

        <span class="n">fp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">,</span> <span class="s1">&#39;sampleDict&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                <span class="n">f</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sd</span><span class="o">.</span><span class="n">output_filenames</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">load_probes_and_values_from_sample_file</span><span class="p">(</span><span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">pts</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">))</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Results&#39;</span><span class="p">,</span> <span class="s1">&#39;probes values&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run snappyHexMesh.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;snappyHexMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run checkMesh.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;checkMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_mesh_orthogonality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_currnt_check_mesh_log</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate max and average mesh orthogonality.</span>

<span class="sd">        If average values is more than 80, try to generate a better mesh.</span>
<span class="sd">        You can use this values to set discretization schemes.</span>
<span class="sd">        try case.setFvSchemes(average_orthogonality)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">use_currnt_check_mesh_log</span><span class="p">:</span>
            <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_mesh</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-latest_time&#39;</span><span class="p">,))</span>
            <span class="k">assert</span> <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">error</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="p">,</span> <span class="s1">&#39;checkMesh.log&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s1">&#39;Failed to find {}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
            <span class="n">maximum</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="n">results</span> \
                <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;Mesh non-orthogonality Max:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> \
                <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;average:&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>

            <span class="n">average</span> <span class="o">=</span> <span class="n">average</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">maximum</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">average</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_foam_file_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a foamfile by name.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">foamfiles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__create_foamfile_from_file</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a foamfile object from an OpenFOAM foamfile.</span>

<span class="sd">        Args:</span>
<span class="sd">            p: Fullpath to file.</span>
<span class="sd">        Return:</span>
<span class="sd">            A Butterfly foam file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Butterfly FoamFiles. This dictionary should be expanded.</span>
        <span class="n">__foamfilescollection</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;turbulence_properties&#39;</span><span class="p">:</span> <span class="n">TurbulenceProperties</span><span class="p">,</span>
            <span class="s1">&#39;RASProperties&#39;</span><span class="p">:</span> <span class="n">RASProperties</span><span class="p">,</span>
            <span class="s1">&#39;transport_properties&#39;</span><span class="p">:</span> <span class="n">TransportProperties</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span>
            <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;nut&#39;</span><span class="p">:</span> <span class="n">Nut</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span> <span class="n">Epsilon</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span>
            <span class="s1">&#39;alphat&#39;</span><span class="p">:</span> <span class="n">Alphat</span><span class="p">,</span> <span class="s1">&#39;p_rgh&#39;</span><span class="p">:</span> <span class="n">P_rgh</span><span class="p">,</span> <span class="s1">&#39;ABLConditions&#39;</span><span class="p">:</span> <span class="n">ABLConditions</span><span class="p">,</span>
            <span class="s1">&#39;initial_conditions&#39;</span><span class="p">:</span> <span class="n">InitialConditions</span><span class="p">,</span>
            <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span> <span class="n">BlockMeshDict</span><span class="p">,</span> <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">:</span> <span class="n">SnappyHexMeshDict</span><span class="p">,</span>
            <span class="s1">&#39;controlDict&#39;</span><span class="p">:</span> <span class="n">ControlDict</span><span class="p">,</span> <span class="s1">&#39;fv_schemes&#39;</span><span class="p">:</span> <span class="n">FvSchemes</span><span class="p">,</span>
            <span class="s1">&#39;fv_solution&#39;</span><span class="p">:</span> <span class="n">FvSolution</span><span class="p">,</span> <span class="s1">&#39;probes&#39;</span><span class="p">:</span> <span class="n">Probes</span><span class="p">,</span>
            <span class="s1">&#39;decomposeParDict&#39;</span><span class="p">:</span> <span class="n">DecomposeParDict</span>
        <span class="p">}</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">BlockMeshDict</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">__foamfilescollection</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">__foamfilescollection</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">FoamFile</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_input_geometries</span><span class="p">(</span><span class="n">geos</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">geos</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">geo</span><span class="p">,</span> <span class="s1">&#39;isBFMesh&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;Expected butterfly.Mesh not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geos</span>

    <span class="k">def</span> <span class="nf">load_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM mesh as a Rhino mesh.&quot;&quot;&quot;</span>
        <span class="c1"># This is a abstract property which should be implemented in subclasses</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM mesh as a Rhino mesh.&quot;&quot;&quot;</span>
        <span class="c1"># This is a abstract property which should be implemented in subclasses</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_probe_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM probes results for a field.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>

        <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {} in {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">load_probe_values_from_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probes_folder</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_probes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM probes locations for a field.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>

        <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {} in {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">load_probes_from_post_processing_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probes_folder</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString method.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;OpenFOAM CASE.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;OpenFOAM CASE: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="butterfly.case.Case" class="name">class <span class="ident">Case</span></p>
      
  
    <div class="desc"><p>Principal class for OpenFOAM Cases.</p>
<p>This class can either be instantiated directly through the <strong>init</strong> constructor or
through the following classmethods:</p>
<div class="codehilite"><pre><span></span>1. from_folder: Create a Butterfly case from a case folder
2. from_bf_geometries: Create a case from Butterfly geometries.
3. from_wind_tunnel: Create case from wind tunnel.
</pre></div>


<p>Notes for beginners:
    What is an OpenFOAM case?
        As defined by AndRAS Horvath in "OpenFOAM tutorial collection", a case is the
        combination of geometry definition (the finite volume mesh), configuration
        files (called dictionaries in OpenFOAM language), definition of boundary
        conditions and initial conditions, custom function and results all structured
        in many files and directories. The 0-directory contains the initial- and
        boundary-conditions. The (initial) mesh is in constant/polyMesh. Most config
        files are in system/. Material and turbulence properties are in
        constant/.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Case</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Principal class for OpenFOAM Cases.</span>

<span class="sd">    This class can either be instantiated directly through the __init__ constructor or</span>
<span class="sd">    through the following classmethods:</span>

<span class="sd">        1. from_folder: Create a Butterfly case from a case folder</span>
<span class="sd">        2. from_bf_geometries: Create a case from Butterfly geometries.</span>
<span class="sd">        3. from_wind_tunnel: Create case from wind tunnel.</span>


<span class="sd">    Notes for beginners:</span>
<span class="sd">        What is an OpenFOAM case?</span>
<span class="sd">            As defined by AndRAS Horvath in &quot;OpenFOAM tutorial collection&quot;, a case is the</span>
<span class="sd">            combination of geometry definition (the finite volume mesh), configuration</span>
<span class="sd">            files (called dictionaries in OpenFOAM language), definition of boundary</span>
<span class="sd">            conditions and initial conditions, custom function and results all structured</span>
<span class="sd">            in many files and directories. The 0-directory contains the initial- and</span>
<span class="sd">            boundary-conditions. The (initial) mesh is in constant/polyMesh. Most config</span>
<span class="sd">            files are in system/. Material and turbulence properties are in</span>
<span class="sd">            constant/.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBFOLDERS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">polyMesh&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">triSurface&#39;</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="c1"># minimum list of files to be able to run blockMesh and snappyHexMesh</span>
    <span class="n">MINFOAMFIles</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;fv_schemes&#39;</span><span class="p">,</span> <span class="s1">&#39;fv_solution&#39;</span><span class="p">,</span> <span class="s1">&#39;controlDict&#39;</span><span class="p">,</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">,</span> <span class="n">geometries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init case.</span>

<span class="sd">        Attributes:</span>
<span class="sd">        name: Case name as a string with no whitespace.</span>

<span class="sd">        :type name: str</span>

<span class="sd">        foamfiles: Collection of FoamFile objects (dictionaries) for this case.</span>

<span class="sd">        :type   foamfiles: FoamFile</span>

<span class="sd">        geometries: Collection of geometry-like objects. Geometries should have</span>
<span class="sd">            a name and toStlString method. The information related to boundary</span>
<span class="sd">            condition should already be included in related foamfiles. If you</span>
<span class="sd">            want to initiate the class form a folder or a number of bf_geometries</span>
<span class="sd">            use from_folder, and from_bf_geometries classmethods.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># original name is a variable to address the current limitation to change</span>
        <span class="c1"># the name of stl file in snappyHexMeshDict. It will be removed once the</span>
        <span class="c1"># limitation is addressed. The value wil be assigned in classmethod from_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__version</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">of_ver</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># optional input for changing working directory</span>
        <span class="c1"># should not be used on OpenFOAM on Windows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;butterfly&#39;</span><span class="p">)</span>

        <span class="c1"># set foamfiles dynamically. This is flexible but makes documentation</span>
        <span class="c1"># tricky. also autocomplete won&#39;t work for this cases.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_foam_files</span><span class="p">(</span><span class="n">foamfiles</span><span class="p">)</span>

        <span class="c1"># set butterfly geometries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>

        <span class="c1"># place holder for refinment regions</span>
        <span class="c1"># use .add_refinement_regions to add regions to case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span> <span class="o">=</span> <span class="n">RunManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_folder</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">convert_from_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Butterfly case from a case folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Full path to case folder.</span>
<span class="sd">            name: An optional new name for this case.</span>
<span class="sd">            convert_from_meters: A number to be multiplied to stl file vertices</span>
<span class="sd">                to be converted to the new units if not meters. This value will</span>
<span class="sd">                be the inverse of convert_to_meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># collect foam files</span>
        <span class="n">__originalName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">__originalName</span>

        <span class="n">_files</span> <span class="o">=</span> <span class="n">load_case_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># convert files to butterfly objects</span>
        <span class="n">ff</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">_files</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">_files</span><span class="o">.</span><span class="n">constant</span><span class="p">,</span> <span class="n">_files</span><span class="o">.</span><span class="n">system</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">cls</span><span class="o">.</span><span class="n">__create_foamfile_from_file</span><span class="p">(</span>
                            <span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">convert_from_meters</span><span class="p">))</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Imported {} from case.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="n">s_hmd</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__get_foam_file_by_name</span><span class="p">(</span><span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">,</span> <span class="n">ff</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s_hmd</span><span class="p">:</span>
            <span class="n">s_hmd</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">name</span>

            <span class="n">stlfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_files</span><span class="o">.</span><span class="n">stl</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.stl&#39;</span><span class="p">))</span>
            <span class="n">bf_geometries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">geo</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">stlfiles</span>
                <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">bf_geometry_from_stl_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">convert_from_meters</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">stl_file_names</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">bf_geometries</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">_case</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ff</span><span class="p">,</span> <span class="n">bf_geometries</span><span class="p">)</span>

        <span class="c1"># update each field of boundary condition for geometries</span>
        <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">_case</span><span class="o">.</span><span class="n">get_foam_files_from_location</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">_case</span><span class="o">.</span><span class="n">geometries</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">get_boundary_field</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">geo</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Conditions&#39;</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># set boundary condition for the field</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Field</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">s_hmd</span><span class="p">:</span>
            <span class="n">refinement_regions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">ref</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_files</span><span class="o">.</span><span class="n">stl</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">refinement_region_names</span>
                <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">refinement_regions_from_stl_file</span><span class="p">(</span>
                    <span class="n">f</span><span class="p">,</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">refinement_region_mode</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]))</span>
            <span class="p">)</span>

            <span class="n">_case</span><span class="o">.</span><span class="n">add_refinement_regions</span><span class="p">(</span><span class="n">refinement_regions</span><span class="p">)</span>

        <span class="c1"># original name is a variable to address the current limitation to change</span>
        <span class="c1"># the name of stl file in snappyHexMeshDict. It will be removed once the</span>
        <span class="c1"># limitation is addressed.</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="n">__originalName</span>

        <span class="k">return</span> <span class="n">_case</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_bf_geometries</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">blockMeshDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">meshing_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">convert_to_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a case from Butterfly geometries.</span>

<span class="sd">        foam_files/dictionaries will be generated based on boundary condition of</span>
<span class="sd">        geometries. fv_solution and fv_schemes will be set to default can can be</span>
<span class="sd">        overwritten once a Solution is created from a Case and a Recipe. You can</span>
<span class="sd">        overwrite them through the recipe.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Case name as a string with no whitespace.</span>
<span class="sd">            geometries: Collection of bf_geometries. FoamFiles/dictionaries will</span>
<span class="sd">                be generated based on boundary condition of geometries.</span>
<span class="sd">            blockMeshDict: Optional input for blockMeshDict. If blockMeshDict is</span>
<span class="sd">                not provided, it will be calculated from geometries in XY</span>
<span class="sd">                direction and boundary condition for faces will be set to</span>
<span class="sd">                BoundingBoxBoundaryCondition. Use BlockMeshDict to create the</span>
<span class="sd">                blockMeshDict if your case is not aligned to XY direction or you</span>
<span class="sd">                need to assign different boundary condition to geometries.</span>
<span class="sd">            meshing_parameters: Optional input for MeshingParameters.</span>
<span class="sd">            make2d_parameters: Optional input for make2d_parameters to make a 2d</span>
<span class="sd">                case.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">geometries</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_check_input_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>

        <span class="c1"># update meshing_parameters</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">meshing_parameters</span><span class="p">:</span>
            <span class="n">meshing_parameters</span> <span class="o">=</span> <span class="n">MeshingParameters</span><span class="p">()</span>

        <span class="c1"># create foam files</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">blockMeshDict</span><span class="p">:</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">calculate_min_max_from_bf_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>
            <span class="n">blockMeshDict</span> <span class="o">=</span> <span class="n">BlockMeshDict</span><span class="o">.</span><span class="n">from_min_max</span><span class="p">(</span>
                <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">make2d_parameters</span><span class="p">:</span>
            <span class="c1"># create the 2D blockMeshDict</span>
            <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">make2d</span><span class="p">(</span>
                <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span>
                <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>

        <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">update_meshing_parameters</span><span class="p">(</span><span class="n">meshing_parameters</span><span class="p">)</span>

        <span class="c1"># set the location_in_mesh for snappyHexMeshDict</span>
        <span class="k">if</span> <span class="n">make2d_parameters</span><span class="p">:</span>
            <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span> <span class="o">=</span> <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">origin</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span><span class="p">:</span>
            <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span> <span class="o">=</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">center</span>

        <span class="c1"># rename name for snappyHexMeshDict and stl file if starts with a digit</span>
        <span class="n">normname</span> <span class="o">=</span> <span class="s1">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">name</span>
        <span class="n">snappyHexMeshDict</span> <span class="o">=</span> <span class="n">SnappyHexMeshDict</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span>
            <span class="n">normname</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">meshing_parameters</span><span class="p">,</span>
            <span class="n">convert_to_meters</span><span class="o">=</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">convert_to_meters</span><span class="p">)</span>

        <span class="c1"># constant folder</span>
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">of_ver</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">turbulence_properties</span> <span class="o">=</span> <span class="n">RASProperties</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">turbulence_properties</span> <span class="o">=</span> <span class="n">TurbulenceProperties</span><span class="p">()</span>
        <span class="n">transport_properties</span> <span class="o">=</span> <span class="n">TransportProperties</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="p">()</span>

        <span class="c1"># 0 floder</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_geometries</span> <span class="o">=</span> <span class="n">geometries</span> <span class="o">+</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">_geometries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span> <span class="o">+</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">Epsilon</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">nut</span> <span class="o">=</span> <span class="n">Nut</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">alphat</span> <span class="o">=</span> <span class="n">Alphat</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
        <span class="n">p_rgh</span> <span class="o">=</span> <span class="n">P_rgh</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>

        <span class="c1"># system folder</span>
        <span class="n">fv_schemes</span> <span class="o">=</span> <span class="n">FvSchemes</span><span class="p">()</span>
        <span class="n">fv_solution</span> <span class="o">=</span> <span class="n">FvSolution</span><span class="p">()</span>
        <span class="n">control_dict</span> <span class="o">=</span> <span class="n">ControlDict</span><span class="p">()</span>
        <span class="n">probes</span> <span class="o">=</span> <span class="n">Probes</span><span class="p">()</span>

        <span class="n">foam_files</span> <span class="o">=</span> <span class="p">(</span><span class="n">blockMeshDict</span><span class="p">,</span> <span class="n">snappyHexMeshDict</span><span class="p">,</span> <span class="n">turbulence_properties</span><span class="p">,</span>
                      <span class="n">transport_properties</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">nut</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">alphat</span><span class="p">,</span>
                      <span class="n">p_rgh</span><span class="p">,</span> <span class="n">fv_schemes</span><span class="p">,</span> <span class="n">fv_solution</span><span class="p">,</span> <span class="n">control_dict</span><span class="p">,</span> <span class="n">probes</span><span class="p">)</span>

        <span class="c1"># create case</span>
        <span class="n">_cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">foam_files</span><span class="p">,</span> <span class="n">geometries</span><span class="p">)</span>
        <span class="n">_cls</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="n">normname</span>
        <span class="k">return</span> <span class="n">_cls</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_wind_tunnel</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create case from wind tunnel.&quot;&quot;&quot;</span>
        <span class="n">_case</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span>
            <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">test_geomtries</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="p">,</span>
            <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">meshing_parameters</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="p">)</span>

        <span class="n">initial_conditions</span> <span class="o">=</span> <span class="n">InitialConditions</span><span class="p">(</span>
            <span class="n">uref</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">flow_speed</span><span class="p">,</span> <span class="n">zref</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">zref</span><span class="p">,</span> <span class="n">z0</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">z0</span><span class="p">)</span>

        <span class="n">abl_conditions</span> <span class="o">=</span> <span class="n">ABLConditions</span><span class="o">.</span><span class="n">from_wind_tunnel</span><span class="p">(</span><span class="n">wind_tunnel</span><span class="p">)</span>

        <span class="c1"># add initial_conditions and ABLConditions to _case</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">add_foam_files</span><span class="p">((</span><span class="n">initial_conditions</span><span class="p">,</span> <span class="n">abl_conditions</span><span class="p">))</span>

        <span class="c1"># include condition files in 0 folder files</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $flowVelocity&#39;</span><span class="p">},</span>
                              <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $pressure&#39;</span><span class="p">},</span>
                              <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">k</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $turbulentKE&#39;</span><span class="p">},</span>
                              <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">epsilon</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $turbulentEpsilon&#39;</span><span class="p">},</span>
                                    <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
                <span class="n">_case</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_case</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return True.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Project name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__project_name</span>

    <span class="nd">@project_name.setter</span>
    <span class="k">def</span> <span class="nf">project_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^[a-zA-Z0-9_]*$&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> \
            <span class="s1">&#39;Invalid project name: &quot;{}&quot;.</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;Do not use whitespace or special charecters.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__project_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geometries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Butterfly geometries.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change default working directory.</span>

<span class="sd">        Do not change the working dir if you are using OpenFOAM for Windows</span>
<span class="sd">        to run the analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__workingDir</span>

    <span class="nd">@working_dir.setter</span>
    <span class="k">def</span> <span class="nf">working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__workingDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get project directory.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">zero_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Folder 0 fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constant_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;constant folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">system_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;system folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">log_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;log folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">poly_mesh_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;polyMesh folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">polyMesh&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tri_surface_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;triSurface folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;constant</span><span class="se">\\</span><span class="s1">triSurface&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">post_processing_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;postProcessing folder fullpath.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;postProcessing&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probes_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fullpath to probes folder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">,</span> <span class="s1">&#39;probes&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">foam_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all the foam_files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">refinement_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get refinement regions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_poly_mesh_snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the mesh in polyMesh folder is snappyHexMesh.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">5</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get and set Probes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__probes</span>

    <span class="nd">@probes.setter</span>
    <span class="k">def</span> <span class="nf">probes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inp</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="s1">&#39;probeLocations&#39;</span><span class="p">),</span> \
            <span class="s2">&quot;Expected Probes not {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__probes</span> <span class="o">=</span> <span class="n">inp</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># include probes in controlDict</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controlDict</span><span class="o">.</span><span class="n">include</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">filename</span>

    <span class="k">def</span> <span class="nf">get_foam_file_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a foamfile by name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_foam_file_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return sorted list of numerical folders.&quot;&quot;&quot;</span>
        <span class="n">_f</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                                                    <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">))</span>
                         <span class="p">)])</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_result_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return sorted list of numerical folders.&quot;&quot;&quot;</span>
        <span class="n">_f</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span> <span class="ow">and</span>
                         <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                             <span class="n">name</span><span class="p">,</span>
                             <span class="s1">&#39;polyMesh&#39;</span><span class="p">))</span>
                         <span class="p">)])</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_foam_files_from_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get foam_files in a specific location (0, constant, system).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span>
                         <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="s1">&#39;&quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_foam_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add foamfiles to the Case.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">foamfiles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_foam_file</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_foam_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a foamfile to the case.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">foamfile</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">foamfile</span><span class="p">,</span> <span class="s1">&#39;isFoamFile&#39;</span><span class="p">),</span> \
            <span class="s1">&#39;{} is not a FoamFile&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foamfile</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">foamfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">foamfile</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Failed to add {}.</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foamfile</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_refinement_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refinement_regions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a collections of refinement regions.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">refinement_region</span> <span class="ow">in</span> <span class="n">refinement_regions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_refinement_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refinement_region</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a refinement region.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">,</span> <span class="s1">&#39;isRefinementRegion&#39;</span><span class="p">),</span> \
            <span class="s2">&quot;{} is not a refinement region.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">),</span> \
            <span class="s1">&#39;You can</span><span class="se">\&#39;</span><span class="s1">t add a refinement_region to a case with no snappyHexMeshDict.&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">snappy_hex_meshDict</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy_snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_number</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the results of snappyHexMesh to constant/polyMesh.&quot;&quot;&quot;</span>
        <span class="c1"># pick the last numerical folder</span>
        <span class="k">if</span> <span class="n">folder_number</span><span class="p">:</span>
            <span class="n">_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">folder_number</span><span class="p">),</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_s</span><span class="p">),</span> <span class="s2">&quot;Can&#39;t find {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_folders</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">_folders</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">)</span>

        <span class="c1"># copy files to constant/polyMesh</span>
        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">copy_tree</span><span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Failed to copy snappyHexMesh folder: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">rename_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename snappyHexMesh numerical folders to name.org  and vice versa.</span>

<span class="sd">        Args:</span>
<span class="sd">            add: Set to True to add .org at the end of the file. Set to False</span>
<span class="sd">                to rename them back to the original naming.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># find list of folders in project and collect the numbers</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span>
            <span class="n">_folders</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.org&#39;</span><span class="p">)</span> <span class="ow">and</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                       <span class="s1">&#39;polyMesh&#39;</span><span class="p">))))</span>

            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                          <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.org&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>

            <span class="c1"># rename them starting from 1</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.org&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Failed to rename snappyHexMesh folders: {}&#39;</span>
                                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove snappyHexMesh numerical folders.</span>

<span class="sd">        Use this to clean the folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename_snappy_hex_mesh_folders</span><span class="p">(</span><span class="n">add</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove {}:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_result_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove results folder.&quot;&quot;&quot;</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_folders</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">_f</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove {}:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_f</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_post_processing_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove post postProcessing folder.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove postProcessing folder:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_poly_mesh_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove files inside polyMesh folder.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">_f</span> <span class="o">!=</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span>
                <span class="n">_fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">,</span> <span class="n">_f</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">_fp</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">_fp</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_fp</span><span class="p">):</span>
                    <span class="n">rmtree</span><span class="p">(</span><span class="n">_fp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_processor_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove processor folders for parallel runs.&quot;&quot;&quot;</span>

        <span class="n">ff</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
              <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;processor&#39;</span><span class="p">)</span> <span class="ow">and</span>
              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">d</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ff</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove processor folder:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">purge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_poly_mesh_content</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">remove_snappy_hex_mesh_folders</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">remove_result_folders</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
              <span class="n">remove_post_processing_folder</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Purge case folder.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">remove_poly_mesh_content</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">remove_snappy_hex_mesh_folders</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_snappy_hex_mesh_folders</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">remove_result_folders</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_result_folders</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">remove_post_processing_folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_post_processing_folder</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update_bc_in_zero_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update boundary conditions in files in 0 folder.</span>

<span class="sd">        Call this method if you have made any changes to boundary condition of</span>
<span class="sd">        any of the geometries after initiating the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save case to folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            overwrite: If True all the current content will be overwritten</span>
<span class="sd">                (default: False).</span>
<span class="sd">            minimum: Write minimum necessary files for case. These files will</span>
<span class="sd">                be enough for meshing the case but not running any commands.</span>
<span class="sd">                Files are (&#39;fv_schemes&#39;, &#39;fv_solution&#39;, &#39;controlDict&#39;,</span>
<span class="sd">                &#39;blockMeshDict&#39;,&#39;snappyHexMeshDict&#39;). Rest of the files will be</span>
<span class="sd">                created from a Solution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create folder and subfolders if they are not already created</span>
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">):</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUBFOLDERS</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Butterfly failed to create {}</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[Error 183]&#39;</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># save foamfiles</span>
        <span class="k">if</span> <span class="n">minimum</span><span class="p">:</span>
            <span class="n">foam_files</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span>
                          <span class="k">if</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MINFOAMFIles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">foam_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">foam_files</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>

        <span class="c1"># find blockMeshDict and convert_to_meters so I can scale stl files to meters.</span>
        <span class="n">bmds</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span> <span class="k">if</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">)</span>
        <span class="n">bmd</span> <span class="o">=</span> <span class="n">bmds</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">convert_to_meters</span> <span class="o">=</span> <span class="n">bmd</span><span class="o">.</span><span class="n">convert_to_meters</span>

        <span class="c1"># write bfgeometries to stl file. __geometries is geometries without</span>
        <span class="c1"># blockMesh geometry</span>
        <span class="n">stl_str</span> <span class="o">=</span> <span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">to_stl</span><span class="p">(</span><span class="n">convert_to_meters</span><span class="p">)</span> <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span><span class="p">)</span>
        <span class="n">stl_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__originalName</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tri_surface_folder</span><span class="p">,</span>
                               <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.stl&#39;</span> <span class="o">%</span> <span class="n">stl_name</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stlf</span><span class="p">:</span>
            <span class="n">stlf</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">stl_str</span><span class="p">)</span>

        <span class="c1"># write refinement_regions to stl files</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
            <span class="n">ref</span><span class="o">.</span><span class="n">write_to_stl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tri_surface_folder</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>

        <span class="c1"># add .foam file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">+</span> <span class="s1">&#39;.foam&#39;</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ffile</span><span class="p">:</span>
            <span class="n">ffile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} is saved to: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sa">ur</span><span class="sd">&quot;&quot;&quot;Run an OpenFOAM command for this case.</span>
<span class="sd">        This method creates a log and err file under logFolder for each command.</span>
<span class="sd">        The output will be logged as {cmd}.log and {cmd}.err.</span>
<span class="sd">        Args:</span>
<span class="sd">            cmd: OpenFOAM command.</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            decomposeParDict: Optional input for decomposeParDict to run analysis</span>
<span class="sd">                in parallel if desired.</span>
<span class="sd">            run: Run the command in shell.</span>
<span class="sd">            wait: Wait until the command is over.</span>
<span class="sd">        returns:</span>
<span class="sd">            If run is True returns a namedtuple for</span>
<span class="sd">                (success, error, process, logfiles, errorfiles).</span>
<span class="sd">                success: as a boolen.</span>
<span class="sd">                error: None in case of success otherwise the error message as</span>
<span class="sd">                    a string.</span>
<span class="sd">                process: Popen process.</span>
<span class="sd">                logfiles: List of fullpath to log files.</span>
<span class="sd">                errorfiles: List of fullpath to error files.</span>
<span class="sd">            else return a namedtuple for</span>
<span class="sd">                (cmd, logfiles, errorfiles)</span>
<span class="sd">                cmd: command lines.</span>
<span class="sd">                logfiles: A tuple for log files.</span>
<span class="sd">                errorfiles: A tuple for error files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">run</span><span class="p">:</span>
            <span class="n">cmdlog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cmdlog</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;success error process logfiles errorfiles&#39;</span><span class="p">)</span>

            <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span>
                                                        <span class="n">decomposeParDict</span><span class="p">,</span> <span class="n">wait</span><span class="p">)</span>

            <span class="n">logfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                             <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">logfiles</span><span class="p">)</span>

            <span class="n">errfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                             <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">errfiles</span><span class="p">)</span>

            <span class="c1"># check error files and raise and error</span>
            <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">check_file_contents</span><span class="p">(</span><span class="n">logfiles</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">hascontent</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">check_file_contents</span><span class="p">(</span><span class="n">errfiles</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="ow">not</span> <span class="n">hascontent</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># return a namedtuple assuming that the command is running fine.</span>
                <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">block_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">,):</span>
        <span class="sd">&quot;&quot;&quot;Run blockMesh.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">            overwrite: Overwrite current content of the folder.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;blockMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">surface_feature_extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run surfaceFeatureExtract command.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create surfaceFeatureExtractDict if it&#39;s not created</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;surfaceFeatureExtract&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="c1"># TODO(Mostapha): Sample for multiple fields.</span>
    <span class="c1"># The reason we don&#39;t have it now is that I don&#39;t have the methods in place</span>
    <span class="c1"># for dealing with lists of lists in GRASshopper.</span>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sample the results for a certain field.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: A unique name for this sample.</span>
<span class="sd">            points: List of points as (x, y, z).</span>
<span class="sd">            fields: List of fields (e.g. U, p).</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(probes, values).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="n">SampleDict</span><span class="o">.</span><span class="n">from_points</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="p">(</span><span class="n">field</span><span class="p">,))</span>
        <span class="n">sd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>

        <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span>
            <span class="s1">&#39;postProcess&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-func&#39;</span><span class="p">,</span> <span class="s1">&#39;sampleDict&#39;</span><span class="p">,</span> <span class="s1">&#39;-latest_time&#39;</span><span class="p">),</span>
            <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to sample the case:</span><span class="se">\n\t</span><span class="si">%s</span><span class="s2">&quot;</span>
                            <span class="o">%</span> <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>

        <span class="n">rf</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_folders</span><span class="p">())</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
            <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Found no results folder. Either you have not run the &#39;</span>
                    <span class="s1">&#39;analysis or the run has faild. Check inside &quot;log&quot; folder.&#39;</span><span class="p">)</span>

        <span class="n">fp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">,</span> <span class="s1">&#39;sampleDict&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                <span class="n">f</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sd</span><span class="o">.</span><span class="n">output_filenames</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">load_probes_and_values_from_sample_file</span><span class="p">(</span><span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">pts</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">))</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Results&#39;</span><span class="p">,</span> <span class="s1">&#39;probes values&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run snappyHexMesh.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;snappyHexMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run checkMesh.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: Command arguments.</span>
<span class="sd">            wait: Wait until command execution ends.</span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;checkMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span><span class="p">,</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_mesh_orthogonality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_currnt_check_mesh_log</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate max and average mesh orthogonality.</span>

<span class="sd">        If average values is more than 80, try to generate a better mesh.</span>
<span class="sd">        You can use this values to set discretization schemes.</span>
<span class="sd">        try case.setFvSchemes(average_orthogonality)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">use_currnt_check_mesh_log</span><span class="p">:</span>
            <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_mesh</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-latest_time&#39;</span><span class="p">,))</span>
            <span class="k">assert</span> <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">error</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="p">,</span> <span class="s1">&#39;checkMesh.log&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s1">&#39;Failed to find {}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
            <span class="n">maximum</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="n">results</span> \
                <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;Mesh non-orthogonality Max:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> \
                <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;average:&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>

            <span class="n">average</span> <span class="o">=</span> <span class="n">average</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">maximum</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">average</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_foam_file_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a foamfile by name.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">foamfiles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__create_foamfile_from_file</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a foamfile object from an OpenFOAM foamfile.</span>

<span class="sd">        Args:</span>
<span class="sd">            p: Fullpath to file.</span>
<span class="sd">        Return:</span>
<span class="sd">            A Butterfly foam file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Butterfly FoamFiles. This dictionary should be expanded.</span>
        <span class="n">__foamfilescollection</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;turbulence_properties&#39;</span><span class="p">:</span> <span class="n">TurbulenceProperties</span><span class="p">,</span>
            <span class="s1">&#39;RASProperties&#39;</span><span class="p">:</span> <span class="n">RASProperties</span><span class="p">,</span>
            <span class="s1">&#39;transport_properties&#39;</span><span class="p">:</span> <span class="n">TransportProperties</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span>
            <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;nut&#39;</span><span class="p">:</span> <span class="n">Nut</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span> <span class="n">Epsilon</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span>
            <span class="s1">&#39;alphat&#39;</span><span class="p">:</span> <span class="n">Alphat</span><span class="p">,</span> <span class="s1">&#39;p_rgh&#39;</span><span class="p">:</span> <span class="n">P_rgh</span><span class="p">,</span> <span class="s1">&#39;ABLConditions&#39;</span><span class="p">:</span> <span class="n">ABLConditions</span><span class="p">,</span>
            <span class="s1">&#39;initial_conditions&#39;</span><span class="p">:</span> <span class="n">InitialConditions</span><span class="p">,</span>
            <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span> <span class="n">BlockMeshDict</span><span class="p">,</span> <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">:</span> <span class="n">SnappyHexMeshDict</span><span class="p">,</span>
            <span class="s1">&#39;controlDict&#39;</span><span class="p">:</span> <span class="n">ControlDict</span><span class="p">,</span> <span class="s1">&#39;fv_schemes&#39;</span><span class="p">:</span> <span class="n">FvSchemes</span><span class="p">,</span>
            <span class="s1">&#39;fv_solution&#39;</span><span class="p">:</span> <span class="n">FvSolution</span><span class="p">,</span> <span class="s1">&#39;probes&#39;</span><span class="p">:</span> <span class="n">Probes</span><span class="p">,</span>
            <span class="s1">&#39;decomposeParDict&#39;</span><span class="p">:</span> <span class="n">DecomposeParDict</span>
        <span class="p">}</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">BlockMeshDict</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">__foamfilescollection</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">__foamfilescollection</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">FoamFile</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_input_geometries</span><span class="p">(</span><span class="n">geos</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">geos</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">geo</span><span class="p">,</span> <span class="s1">&#39;isBFMesh&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;Expected butterfly.Mesh not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geos</span>

    <span class="k">def</span> <span class="nf">load_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM mesh as a Rhino mesh.&quot;&quot;&quot;</span>
        <span class="c1"># This is a abstract property which should be implemented in subclasses</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM mesh as a Rhino mesh.&quot;&quot;&quot;</span>
        <span class="c1"># This is a abstract property which should be implemented in subclasses</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_probe_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM probes results for a field.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>

        <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {} in {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">load_probe_values_from_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probes_folder</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_probes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return OpenFOAM probes locations for a field.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>

        <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {} in {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">load_probes_from_post_processing_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probes_folder</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString method.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;OpenFOAM CASE.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;OpenFOAM CASE: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#butterfly.case.Case">Case</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="butterfly.case.Case.MINFOAMFIles" class="name">var <span class="ident">MINFOAMFIles</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.SUBFOLDERS" class="name">var <span class="ident">SUBFOLDERS</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="butterfly.case.Case.constant_folder" class="name">var <span class="ident">constant_folder</span></p>
            

            
  
    <div class="desc"><p>constant folder fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.decomposeParDict" class="name">var <span class="ident">decomposeParDict</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.foam_files" class="name">var <span class="ident">foam_files</span></p>
            

            
  
    <div class="desc"><p>Get all the foam_files.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.geometries" class="name">var <span class="ident">geometries</span></p>
            

            
  
    <div class="desc"><p>Butterfly geometries.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.is_case" class="name">var <span class="ident">is_case</span></p>
            

            
  
    <div class="desc"><p>return True.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.is_poly_mesh_snappy_hex_mesh" class="name">var <span class="ident">is_poly_mesh_snappy_hex_mesh</span></p>
            

            
  
    <div class="desc"><p>Check if the mesh in polyMesh folder is snappyHexMesh.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.log_folder" class="name">var <span class="ident">log_folder</span></p>
            

            
  
    <div class="desc"><p>log folder fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.poly_mesh_folder" class="name">var <span class="ident">poly_mesh_folder</span></p>
            

            
  
    <div class="desc"><p>polyMesh folder fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.post_processing_folder" class="name">var <span class="ident">post_processing_folder</span></p>
            

            
  
    <div class="desc"><p>postProcessing folder fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.probes" class="name">var <span class="ident">probes</span></p>
            

            
  
    <div class="desc"><p>Get and set Probes.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.probes_folder" class="name">var <span class="ident">probes_folder</span></p>
            

            
  
    <div class="desc"><p>Fullpath to probes folder.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.project_dir" class="name">var <span class="ident">project_dir</span></p>
            

            
  
    <div class="desc"><p>Get project directory.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.project_name" class="name">var <span class="ident">project_name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.refinement_regions" class="name">var <span class="ident">refinement_regions</span></p>
            

            
  
    <div class="desc"><p>Get refinement regions.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.runmanager" class="name">var <span class="ident">runmanager</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.system_folder" class="name">var <span class="ident">system_folder</span></p>
            

            
  
    <div class="desc"><p>system folder fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.tri_surface_folder" class="name">var <span class="ident">tri_surface_folder</span></p>
            

            
  
    <div class="desc"><p>triSurface folder fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.working_dir" class="name">var <span class="ident">working_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="butterfly.case.Case.zero_folder" class="name">var <span class="ident">zero_folder</span></p>
            

            
  
    <div class="desc"><p>Folder 0 fullpath.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, name, foamfiles, geometries)</p>
    </div>
    

    
  
    <div class="desc"><p>Init case.</p>
<p>Attributes:
name: Case name as a string with no whitespace.</p>
<p>:type name: str</p>
<p>foamfiles: Collection of FoamFile objects (dictionaries) for this case.</p>
<p>:type   foamfiles: FoamFile</p>
<p>geometries: Collection of geometry-like objects. Geometries should have
    a name and toStlString method. The information related to boundary
    condition should already be included in related foamfiles. If you
    want to initiate the class form a folder or a number of bf_geometries
    use from_folder, and from_bf_geometries classmethods.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.__init__', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">,</span> <span class="n">geometries</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Init case.</span>
<span class="sd">    Attributes:</span>
<span class="sd">    name: Case name as a string with no whitespace.</span>
<span class="sd">    :type name: str</span>
<span class="sd">    foamfiles: Collection of FoamFile objects (dictionaries) for this case.</span>
<span class="sd">    :type   foamfiles: FoamFile</span>
<span class="sd">    geometries: Collection of geometry-like objects. Geometries should have</span>
<span class="sd">        a name and toStlString method. The information related to boundary</span>
<span class="sd">        condition should already be included in related foamfiles. If you</span>
<span class="sd">        want to initiate the class form a folder or a number of bf_geometries</span>
<span class="sd">        use from_folder, and from_bf_geometries classmethods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># original name is a variable to address the current limitation to change</span>
    <span class="c1"># the name of stl file in snappyHexMeshDict. It will be removed once the</span>
    <span class="c1"># limitation is addressed. The value wil be assigned in classmethod from_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__version</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">of_ver</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c1"># optional input for changing working directory</span>
    <span class="c1"># should not be used on OpenFOAM on Windows</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;butterfly&#39;</span><span class="p">)</span>
    <span class="c1"># set foamfiles dynamically. This is flexible but makes documentation</span>
    <span class="c1"># tricky. also autocomplete won&#39;t work for this cases.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_foam_files</span><span class="p">(</span><span class="n">foamfiles</span><span class="p">)</span>
    <span class="c1"># set butterfly geometries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>
    <span class="c1"># place holder for refinment regions</span>
    <span class="c1"># use .add_refinement_regions to add regions to case</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span> <span class="o">=</span> <span class="n">RunManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.ToString">
    <p>def <span class="ident">ToString</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Overwrite .NET ToString method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.ToString', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.ToString" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString method.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.add_foam_file">
    <p>def <span class="ident">add_foam_file</span>(</p><p>self, foamfile)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a foamfile to the case.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.add_foam_file', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.add_foam_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_foam_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a foamfile to the case.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">foamfile</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">foamfile</span><span class="p">,</span> <span class="s1">&#39;isFoamFile&#39;</span><span class="p">),</span> \
        <span class="s1">&#39;{} is not a FoamFile&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foamfile</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">foamfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">foamfile</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Failed to add {}.</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foamfile</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.add_foam_files">
    <p>def <span class="ident">add_foam_files</span>(</p><p>self, foamfiles)</p>
    </div>
    

    
  
    <div class="desc"><p>Add foamfiles to the Case.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.add_foam_files', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.add_foam_files" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_foam_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foamfiles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add foamfiles to the Case.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">foamfiles</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_foam_file</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.add_refinement_region">
    <p>def <span class="ident">add_refinement_region</span>(</p><p>self, refinement_region)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a refinement region.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.add_refinement_region', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.add_refinement_region" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_refinement_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refinement_region</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a refinement region.&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">,</span> <span class="s1">&#39;isRefinementRegion&#39;</span><span class="p">),</span> \
        <span class="s2">&quot;{} is not a refinement region.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__refinement_regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">),</span> \
        <span class="s1">&#39;You can</span><span class="se">\&#39;</span><span class="s1">t add a refinement_region to a case with no snappyHexMeshDict.&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">snappy_hex_meshDict</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.add_refinement_regions">
    <p>def <span class="ident">add_refinement_regions</span>(</p><p>self, refinement_regions)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a collections of refinement regions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.add_refinement_regions', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.add_refinement_regions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_refinement_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refinement_regions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a collections of refinement regions.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">refinement_region</span> <span class="ow">in</span> <span class="n">refinement_regions</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">refinement_region</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.block_mesh">
    <p>def <span class="ident">block_mesh</span>(</p><p>self, args=None, wait=True, overwrite=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Run blockMesh.</p>
<p>Args:
    args: Command arguments.
    wait: Wait until command execution ends.
    overwrite: Overwrite current content of the folder.
Returns:
    namedtuple(success, error, process, logfiles, errorfiles).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.block_mesh', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.block_mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">block_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">,):</span>
    <span class="sd">&quot;&quot;&quot;Run blockMesh.</span>
<span class="sd">    Args:</span>
<span class="sd">        args: Command arguments.</span>
<span class="sd">        wait: Wait until command execution ends.</span>
<span class="sd">        overwrite: Overwrite current content of the folder.</span>
<span class="sd">    Returns:</span>
<span class="sd">        namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;blockMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.calculate_mesh_orthogonality">
    <p>def <span class="ident">calculate_mesh_orthogonality</span>(</p><p>self, use_currnt_check_mesh_log=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate max and average mesh orthogonality.</p>
<p>If average values is more than 80, try to generate a better mesh.
You can use this values to set discretization schemes.
try case.setFvSchemes(average_orthogonality)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.calculate_mesh_orthogonality', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.calculate_mesh_orthogonality" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculate_mesh_orthogonality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_currnt_check_mesh_log</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate max and average mesh orthogonality.</span>
<span class="sd">    If average values is more than 80, try to generate a better mesh.</span>
<span class="sd">    You can use this values to set discretization schemes.</span>
<span class="sd">    try case.setFvSchemes(average_orthogonality)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_currnt_check_mesh_log</span><span class="p">:</span>
        <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_mesh</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-latest_time&#39;</span><span class="p">,))</span>
        <span class="k">assert</span> <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">error</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="p">,</span> <span class="s1">&#39;checkMesh.log&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="s1">&#39;Failed to find {}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
        <span class="n">maximum</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="n">results</span> \
            <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;Mesh non-orthogonality Max:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> \
            <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;average:&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">average</span> <span class="o">=</span> <span class="n">average</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">maximum</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">average</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.check_mesh">
    <p>def <span class="ident">check_mesh</span>(</p><p>self, args=None, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Run checkMesh.</p>
<p>Args:
    args: Command arguments.
    wait: Wait until command execution ends.
Returns:
    namedtuple(success, error, process, logfiles, errorfiles).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.check_mesh', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.check_mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run checkMesh.</span>
<span class="sd">    Args:</span>
<span class="sd">        args: Command arguments.</span>
<span class="sd">        wait: Wait until command execution ends.</span>
<span class="sd">    Returns:</span>
<span class="sd">        namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;checkMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span><span class="p">,</span>
                        <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.command">
    <p>def <span class="ident">command</span>(</p><p>self, cmd, args=None, decomposeParDict=None, run=True, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Run an OpenFOAM command for this case.
This method creates a log and err file under logFolder for each command.
The output will be logged as {cmd}.log and {cmd}.err.
Args:
    cmd: OpenFOAM command.
    args: Command arguments.
    decomposeParDict: Optional input for decomposeParDict to run analysis
        in parallel if desired.
    run: Run the command in shell.
    wait: Wait until the command is over.
returns:
    If run is True returns a namedtuple for
        (success, error, process, logfiles, errorfiles).
        success: as a boolen.
        error: None in case of success otherwise the error message as
            a string.
        process: Popen process.
        logfiles: List of fullpath to log files.
        errorfiles: List of fullpath to error files.
    else return a namedtuple for
        (cmd, logfiles, errorfiles)
        cmd: command lines.
        logfiles: A tuple for log files.
        errorfiles: A tuple for error files.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.command', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.command" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sa">ur</span><span class="sd">&quot;&quot;&quot;Run an OpenFOAM command for this case.</span>
<span class="sd">    This method creates a log and err file under logFolder for each command.</span>
<span class="sd">    The output will be logged as {cmd}.log and {cmd}.err.</span>
<span class="sd">    Args:</span>
<span class="sd">        cmd: OpenFOAM command.</span>
<span class="sd">        args: Command arguments.</span>
<span class="sd">        decomposeParDict: Optional input for decomposeParDict to run analysis</span>
<span class="sd">            in parallel if desired.</span>
<span class="sd">        run: Run the command in shell.</span>
<span class="sd">        wait: Wait until the command is over.</span>
<span class="sd">    returns:</span>
<span class="sd">        If run is True returns a namedtuple for</span>
<span class="sd">            (success, error, process, logfiles, errorfiles).</span>
<span class="sd">            success: as a boolen.</span>
<span class="sd">            error: None in case of success otherwise the error message as</span>
<span class="sd">                a string.</span>
<span class="sd">            process: Popen process.</span>
<span class="sd">            logfiles: List of fullpath to log files.</span>
<span class="sd">            errorfiles: List of fullpath to error files.</span>
<span class="sd">        else return a namedtuple for</span>
<span class="sd">            (cmd, logfiles, errorfiles)</span>
<span class="sd">            cmd: command lines.</span>
<span class="sd">            logfiles: A tuple for log files.</span>
<span class="sd">            errorfiles: A tuple for error files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">run</span><span class="p">:</span>
        <span class="n">cmdlog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cmdlog</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;success error process logfiles errorfiles&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span>
                                                    <span class="n">decomposeParDict</span><span class="p">,</span> <span class="n">wait</span><span class="p">)</span>
        <span class="n">logfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                         <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">logfiles</span><span class="p">)</span>
        <span class="n">errfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                         <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">errfiles</span><span class="p">)</span>
        <span class="c1"># check error files and raise and error</span>
        <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">check_file_contents</span><span class="p">(</span><span class="n">logfiles</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">hascontent</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runmanager</span><span class="o">.</span><span class="n">check_file_contents</span><span class="p">(</span><span class="n">errfiles</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="ow">not</span> <span class="n">hascontent</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># return a namedtuple assuming that the command is running fine.</span>
            <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">logfiles</span><span class="p">,</span> <span class="n">errfiles</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.copy_snappy_hex_mesh">
    <p>def <span class="ident">copy_snappy_hex_mesh</span>(</p><p>self, folder_number=None, overwrite=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Copy the results of snappyHexMesh to constant/polyMesh.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.copy_snappy_hex_mesh', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.copy_snappy_hex_mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">copy_snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_number</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy the results of snappyHexMesh to constant/polyMesh.&quot;&quot;&quot;</span>
    <span class="c1"># pick the last numerical folder</span>
    <span class="k">if</span> <span class="n">folder_number</span><span class="p">:</span>
        <span class="n">_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">folder_number</span><span class="p">),</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_s</span><span class="p">),</span> <span class="s2">&quot;Can&#39;t find {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">_s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">_folders</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">)</span>
    <span class="c1"># copy files to constant/polyMesh</span>
    <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">copy_tree</span><span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Failed to copy snappyHexMesh folder: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.duplicate">
    <p>def <span class="ident">duplicate</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a copy of this object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.duplicate', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.duplicate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a copy of this object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.from_bf_geometries">
    <p>def <span class="ident">from_bf_geometries</span>(</p><p>cls, name, geometries, blockMeshDict=None, meshing_parameters=None, make2d_parameters=None, convert_to_meters=1)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a case from Butterfly geometries.</p>
<p>foam_files/dictionaries will be generated based on boundary condition of
geometries. fv_solution and fv_schemes will be set to default can can be
overwritten once a Solution is created from a Case and a Recipe. You can
overwrite them through the recipe.</p>
<p>Args:
    name: Case name as a string with no whitespace.
    geometries: Collection of bf_geometries. FoamFiles/dictionaries will
        be generated based on boundary condition of geometries.
    blockMeshDict: Optional input for blockMeshDict. If blockMeshDict is
        not provided, it will be calculated from geometries in XY
        direction and boundary condition for faces will be set to
        BoundingBoxBoundaryCondition. Use BlockMeshDict to create the
        blockMeshDict if your case is not aligned to XY direction or you
        need to assign different boundary condition to geometries.
    meshing_parameters: Optional input for MeshingParameters.
    make2d_parameters: Optional input for make2d_parameters to make a 2d
        case.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.from_bf_geometries', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.from_bf_geometries" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_bf_geometries</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">blockMeshDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">meshing_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">convert_to_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a case from Butterfly geometries.</span>
<span class="sd">    foam_files/dictionaries will be generated based on boundary condition of</span>
<span class="sd">    geometries. fv_solution and fv_schemes will be set to default can can be</span>
<span class="sd">    overwritten once a Solution is created from a Case and a Recipe. You can</span>
<span class="sd">    overwrite them through the recipe.</span>
<span class="sd">    Args:</span>
<span class="sd">        name: Case name as a string with no whitespace.</span>
<span class="sd">        geometries: Collection of bf_geometries. FoamFiles/dictionaries will</span>
<span class="sd">            be generated based on boundary condition of geometries.</span>
<span class="sd">        blockMeshDict: Optional input for blockMeshDict. If blockMeshDict is</span>
<span class="sd">            not provided, it will be calculated from geometries in XY</span>
<span class="sd">            direction and boundary condition for faces will be set to</span>
<span class="sd">            BoundingBoxBoundaryCondition. Use BlockMeshDict to create the</span>
<span class="sd">            blockMeshDict if your case is not aligned to XY direction or you</span>
<span class="sd">            need to assign different boundary condition to geometries.</span>
<span class="sd">        meshing_parameters: Optional input for MeshingParameters.</span>
<span class="sd">        make2d_parameters: Optional input for make2d_parameters to make a 2d</span>
<span class="sd">            case.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">geometries</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_check_input_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>
    <span class="c1"># update meshing_parameters</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">meshing_parameters</span><span class="p">:</span>
        <span class="n">meshing_parameters</span> <span class="o">=</span> <span class="n">MeshingParameters</span><span class="p">()</span>
    <span class="c1"># create foam files</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">blockMeshDict</span><span class="p">:</span>
        <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">calculate_min_max_from_bf_geometries</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>
        <span class="n">blockMeshDict</span> <span class="o">=</span> <span class="n">BlockMeshDict</span><span class="o">.</span><span class="n">from_min_max</span><span class="p">(</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">make2d_parameters</span><span class="p">:</span>
        <span class="c1"># create the 2D blockMeshDict</span>
        <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">make2d</span><span class="p">(</span>
            <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span>
            <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
    <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">update_meshing_parameters</span><span class="p">(</span><span class="n">meshing_parameters</span><span class="p">)</span>
    <span class="c1"># set the location_in_mesh for snappyHexMeshDict</span>
    <span class="k">if</span> <span class="n">make2d_parameters</span><span class="p">:</span>
        <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span> <span class="o">=</span> <span class="n">make2d_parameters</span><span class="o">.</span><span class="n">origin</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span><span class="p">:</span>
        <span class="n">meshing_parameters</span><span class="o">.</span><span class="n">location_in_mesh</span> <span class="o">=</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">center</span>
    <span class="c1"># rename name for snappyHexMeshDict and stl file if starts with a digit</span>
    <span class="n">normname</span> <span class="o">=</span> <span class="s1">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">name</span>
    <span class="n">snappyHexMeshDict</span> <span class="o">=</span> <span class="n">SnappyHexMeshDict</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span>
        <span class="n">normname</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">meshing_parameters</span><span class="p">,</span>
        <span class="n">convert_to_meters</span><span class="o">=</span><span class="n">blockMeshDict</span><span class="o">.</span><span class="n">convert_to_meters</span><span class="p">)</span>
    <span class="c1"># constant folder</span>
    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">of_ver</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">turbulence_properties</span> <span class="o">=</span> <span class="n">RASProperties</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">turbulence_properties</span> <span class="o">=</span> <span class="n">TurbulenceProperties</span><span class="p">()</span>
    <span class="n">transport_properties</span> <span class="o">=</span> <span class="n">TransportProperties</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="p">()</span>
    <span class="c1"># 0 floder</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_geometries</span> <span class="o">=</span> <span class="n">geometries</span> <span class="o">+</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">_geometries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span> <span class="o">+</span> <span class="n">blockMeshDict</span><span class="o">.</span><span class="n">geometry</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">Epsilon</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">nut</span> <span class="o">=</span> <span class="n">Nut</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">alphat</span> <span class="o">=</span> <span class="n">Alphat</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="n">p_rgh</span> <span class="o">=</span> <span class="n">P_rgh</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span><span class="n">_geometries</span><span class="p">)</span>
    <span class="c1"># system folder</span>
    <span class="n">fv_schemes</span> <span class="o">=</span> <span class="n">FvSchemes</span><span class="p">()</span>
    <span class="n">fv_solution</span> <span class="o">=</span> <span class="n">FvSolution</span><span class="p">()</span>
    <span class="n">control_dict</span> <span class="o">=</span> <span class="n">ControlDict</span><span class="p">()</span>
    <span class="n">probes</span> <span class="o">=</span> <span class="n">Probes</span><span class="p">()</span>
    <span class="n">foam_files</span> <span class="o">=</span> <span class="p">(</span><span class="n">blockMeshDict</span><span class="p">,</span> <span class="n">snappyHexMeshDict</span><span class="p">,</span> <span class="n">turbulence_properties</span><span class="p">,</span>
                  <span class="n">transport_properties</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">nut</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">alphat</span><span class="p">,</span>
                  <span class="n">p_rgh</span><span class="p">,</span> <span class="n">fv_schemes</span><span class="p">,</span> <span class="n">fv_solution</span><span class="p">,</span> <span class="n">control_dict</span><span class="p">,</span> <span class="n">probes</span><span class="p">)</span>
    <span class="c1"># create case</span>
    <span class="n">_cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">foam_files</span><span class="p">,</span> <span class="n">geometries</span><span class="p">)</span>
    <span class="n">_cls</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="n">normname</span>
    <span class="k">return</span> <span class="n">_cls</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.from_folder">
    <p>def <span class="ident">from_folder</span>(</p><p>cls, path, name=None, convert_from_meters=1)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a Butterfly case from a case folder.</p>
<p>Args:
    path: Full path to case folder.
    name: An optional new name for this case.
    convert_from_meters: A number to be multiplied to stl file vertices
        to be converted to the new units if not meters. This value will
        be the inverse of convert_to_meters.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.from_folder', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.from_folder" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_folder</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">convert_from_meters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a Butterfly case from a case folder.</span>
<span class="sd">    Args:</span>
<span class="sd">        path: Full path to case folder.</span>
<span class="sd">        name: An optional new name for this case.</span>
<span class="sd">        convert_from_meters: A number to be multiplied to stl file vertices</span>
<span class="sd">            to be converted to the new units if not meters. This value will</span>
<span class="sd">            be the inverse of convert_to_meters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># collect foam files</span>
    <span class="n">__originalName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">__originalName</span>
    <span class="n">_files</span> <span class="o">=</span> <span class="n">load_case_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c1"># convert files to butterfly objects</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">_files</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">_files</span><span class="o">.</span><span class="n">constant</span><span class="p">,</span> <span class="n">_files</span><span class="o">.</span><span class="n">system</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">__create_foamfile_from_file</span><span class="p">(</span>
                        <span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">convert_from_meters</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Imported {} from case.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to import {}:</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
    <span class="n">s_hmd</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__get_foam_file_by_name</span><span class="p">(</span><span class="s1">&#39;snappyHexMeshDict&#39;</span><span class="p">,</span> <span class="n">ff</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s_hmd</span><span class="p">:</span>
        <span class="n">s_hmd</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">stlfiles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_files</span><span class="o">.</span><span class="n">stl</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.stl&#39;</span><span class="p">))</span>
        <span class="n">bf_geometries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">geo</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">stlfiles</span>
            <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">bf_geometry_from_stl_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">convert_from_meters</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">stl_file_names</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bf_geometries</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_case</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ff</span><span class="p">,</span> <span class="n">bf_geometries</span><span class="p">)</span>
    <span class="c1"># update each field of boundary condition for geometries</span>
    <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">_case</span><span class="o">.</span><span class="n">get_foam_files_from_location</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="n">_case</span><span class="o">.</span><span class="n">geometries</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">get_boundary_field</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">geo</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Conditions&#39;</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># set boundary condition for the field</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Field</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">s_hmd</span><span class="p">:</span>
        <span class="n">refinement_regions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">ref</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_files</span><span class="o">.</span><span class="n">stl</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">refinement_region_names</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">refinement_regions_from_stl_file</span><span class="p">(</span>
                <span class="n">f</span><span class="p">,</span> <span class="n">s_hmd</span><span class="o">.</span><span class="n">refinement_region_mode</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="n">_case</span><span class="o">.</span><span class="n">add_refinement_regions</span><span class="p">(</span><span class="n">refinement_regions</span><span class="p">)</span>
    <span class="c1"># original name is a variable to address the current limitation to change</span>
    <span class="c1"># the name of stl file in snappyHexMeshDict. It will be removed once the</span>
    <span class="c1"># limitation is addressed.</span>
    <span class="n">_case</span><span class="o">.</span><span class="n">__originalName</span> <span class="o">=</span> <span class="n">__originalName</span>
    <span class="k">return</span> <span class="n">_case</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.from_wind_tunnel">
    <p>def <span class="ident">from_wind_tunnel</span>(</p><p>cls, wind_tunnel, make2d_parameters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Create case from wind tunnel.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.from_wind_tunnel', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.from_wind_tunnel" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_wind_tunnel</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create case from wind tunnel.&quot;&quot;&quot;</span>
    <span class="n">_case</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_bf_geometries</span><span class="p">(</span>
        <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">test_geomtries</span><span class="p">,</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">blockMeshDict</span><span class="p">,</span>
        <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">meshing_parameters</span><span class="p">,</span> <span class="n">make2d_parameters</span><span class="p">)</span>
    <span class="n">initial_conditions</span> <span class="o">=</span> <span class="n">InitialConditions</span><span class="p">(</span>
        <span class="n">uref</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">flow_speed</span><span class="p">,</span> <span class="n">zref</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">zref</span><span class="p">,</span> <span class="n">z0</span><span class="o">=</span><span class="n">wind_tunnel</span><span class="o">.</span><span class="n">z0</span><span class="p">)</span>
    <span class="n">abl_conditions</span> <span class="o">=</span> <span class="n">ABLConditions</span><span class="o">.</span><span class="n">from_wind_tunnel</span><span class="p">(</span><span class="n">wind_tunnel</span><span class="p">)</span>
    <span class="c1"># add initial_conditions and ABLConditions to _case</span>
    <span class="n">_case</span><span class="o">.</span><span class="n">add_foam_files</span><span class="p">((</span><span class="n">initial_conditions</span><span class="p">,</span> <span class="n">abl_conditions</span><span class="p">))</span>
    <span class="c1"># include condition files in 0 folder files</span>
    <span class="n">_case</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $flowVelocity&#39;</span><span class="p">},</span>
                          <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">_case</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $pressure&#39;</span><span class="p">},</span>
                          <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">_case</span><span class="o">.</span><span class="n">k</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $turbulentKE&#39;</span><span class="p">},</span>
                          <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">_case</span><span class="o">.</span><span class="n">epsilon</span><span class="o">.</span><span class="n">update_values</span><span class="p">({</span><span class="s1">&#39;#include&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;initial_conditions&quot;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;internalField&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform $turbulentEpsilon&#39;</span><span class="p">},</span>
                                <span class="n">mute</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">wind_tunnel</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
            <span class="n">_case</span><span class="o">.</span><span class="n">add_refinement_region</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_case</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.get_foam_file_by_name">
    <p>def <span class="ident">get_foam_file_by_name</span>(</p><p>self, name)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a foamfile by name.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.get_foam_file_by_name', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.get_foam_file_by_name" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_foam_file_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a foamfile by name.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_foam_file_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.get_foam_files_from_location">
    <p>def <span class="ident">get_foam_files_from_location</span>(</p><p>self, location=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get foam_files in a specific location (0, constant, system).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.get_foam_files_from_location', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.get_foam_files_from_location" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_foam_files_from_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get foam_files in a specific location (0, constant, system).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__foamfiles</span>
                     <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="s1">&#39;&quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.get_result_folders">
    <p>def <span class="ident">get_result_folders</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return sorted list of numerical folders.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.get_result_folders', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.get_result_folders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_result_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return sorted list of numerical folders.&quot;&quot;&quot;</span>
    <span class="n">_f</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                 <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span>
                     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span> <span class="ow">and</span>
                     <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span>
                     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                         <span class="n">name</span><span class="p">,</span>
                         <span class="s1">&#39;polyMesh&#39;</span><span class="p">))</span>
                     <span class="p">)])</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_f</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.get_snappy_hex_mesh_folders">
    <p>def <span class="ident">get_snappy_hex_mesh_folders</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return sorted list of numerical folders.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.get_snappy_hex_mesh_folders', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.get_snappy_hex_mesh_folders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return sorted list of numerical folders.&quot;&quot;&quot;</span>
    <span class="n">_f</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                 <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span>
                     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                                                <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;polyMesh&#39;</span><span class="p">))</span>
                     <span class="p">)])</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_f</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.load_mesh">
    <p>def <span class="ident">load_mesh</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return OpenFOAM mesh as a Rhino mesh.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.load_mesh', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.load_mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return OpenFOAM mesh as a Rhino mesh.&quot;&quot;&quot;</span>
    <span class="c1"># This is a abstract property which should be implemented in subclasses</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.load_points">
    <p>def <span class="ident">load_points</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return OpenFOAM mesh as a Rhino mesh.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.load_points', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.load_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return OpenFOAM mesh as a Rhino mesh.&quot;&quot;&quot;</span>
    <span class="c1"># This is a abstract property which should be implemented in subclasses</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.load_probe_values">
    <p>def <span class="ident">load_probe_values</span>(</p><p>self, field)</p>
    </div>
    

    
  
    <div class="desc"><p>Return OpenFOAM probes results for a field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.load_probe_values', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.load_probe_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_probe_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return OpenFOAM probes results for a field.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">()</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {} in {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">load_probe_values_from_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probes_folder</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.load_probes">
    <p>def <span class="ident">load_probes</span>(</p><p>self, field)</p>
    </div>
    

    
  
    <div class="desc"><p>Return OpenFOAM probes locations for a field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.load_probes', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.load_probes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_probes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return OpenFOAM probes locations for a field.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">probes_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">()</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {} in {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">load_probes_from_post_processing_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probes_folder</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.purge">
    <p>def <span class="ident">purge</span>(</p><p>self, remove_poly_mesh_content=True, remove_snappy_hex_mesh_folders=True, remove_result_folders=False, remove_post_processing_folder=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Purge case folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.purge', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.purge" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">purge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_poly_mesh_content</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
          <span class="n">remove_snappy_hex_mesh_folders</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
          <span class="n">remove_result_folders</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
          <span class="n">remove_post_processing_folder</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Purge case folder.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">remove_poly_mesh_content</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_poly_mesh_content</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">remove_snappy_hex_mesh_folders</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_snappy_hex_mesh_folders</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">remove_result_folders</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_result_folders</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">remove_post_processing_folder</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_post_processing_folder</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.remove_poly_mesh_content">
    <p>def <span class="ident">remove_poly_mesh_content</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove files inside polyMesh folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.remove_poly_mesh_content', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.remove_poly_mesh_content" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_poly_mesh_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove files inside polyMesh folder.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">_f</span> <span class="o">!=</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">:</span>
            <span class="n">_fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_mesh_folder</span><span class="p">,</span> <span class="n">_f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">_fp</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">_fp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_fp</span><span class="p">):</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">_fp</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.remove_post_processing_folder">
    <p>def <span class="ident">remove_post_processing_folder</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove post postProcessing folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.remove_post_processing_folder', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.remove_post_processing_folder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_post_processing_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove post postProcessing folder.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove postProcessing folder:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.remove_processor_folders">
    <p>def <span class="ident">remove_processor_folders</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove processor folders for parallel runs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.remove_processor_folders', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.remove_processor_folders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_processor_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove processor folders for parallel runs.&quot;&quot;&quot;</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;processor&#39;</span><span class="p">)</span> <span class="ow">and</span>
          <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">d</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ff</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove processor folder:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.remove_result_folders">
    <p>def <span class="ident">remove_result_folders</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove results folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.remove_result_folders', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.remove_result_folders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_result_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove results folder.&quot;&quot;&quot;</span>
    <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_folders</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">_f</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove {}:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_f</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.remove_snappy_hex_mesh_folders">
    <p>def <span class="ident">remove_snappy_hex_mesh_folders</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove snappyHexMesh numerical folders.</p>
<p>Use this to clean the folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.remove_snappy_hex_mesh_folders', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.remove_snappy_hex_mesh_folders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove snappyHexMesh numerical folders.</span>
<span class="sd">    Use this to clean the folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rename_snappy_hex_mesh_folders</span><span class="p">(</span><span class="n">add</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Failed to remove {}:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.rename_snappy_hex_mesh_folders">
    <p>def <span class="ident">rename_snappy_hex_mesh_folders</span>(</p><p>self, add=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Rename snappyHexMesh numerical folders to name.org  and vice versa.</p>
<p>Args:
    add: Set to True to add .org at the end of the file. Set to False
        to rename them back to the original naming.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.rename_snappy_hex_mesh_folders', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.rename_snappy_hex_mesh_folders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rename_snappy_hex_mesh_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rename snappyHexMesh numerical folders to name.org  and vice versa.</span>
<span class="sd">    Args:</span>
<span class="sd">        add: Set to True to add .org at the end of the file. Set to False</span>
<span class="sd">            to rename them back to the original naming.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># find list of folders in project and collect the numbers</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.org&#39;</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                   <span class="s1">&#39;polyMesh&#39;</span><span class="p">))))</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                      <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.org&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_folders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snappy_hex_mesh_folders</span><span class="p">()</span>
        <span class="c1"># rename them starting from 1</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_folders</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                          <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.org&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Failed to rename snappyHexMesh folders: {}&#39;</span>
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.sample">
    <p>def <span class="ident">sample</span>(</p><p>self, name, points, field, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Sample the results for a certain field.</p>
<p>Args:
    name: A unique name for this sample.
    points: List of points as (x, y, z).
    fields: List of fields (e.g. U, p).
    args: Command arguments.
    wait: Wait until command execution ends.
Returns:
    namedtuple(probes, values).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.sample', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.sample" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sample the results for a certain field.</span>
<span class="sd">    Args:</span>
<span class="sd">        name: A unique name for this sample.</span>
<span class="sd">        points: List of points as (x, y, z).</span>
<span class="sd">        fields: List of fields (e.g. U, p).</span>
<span class="sd">        args: Command arguments.</span>
<span class="sd">        wait: Wait until command execution ends.</span>
<span class="sd">    Returns:</span>
<span class="sd">        namedtuple(probes, values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">SampleDict</span><span class="o">.</span><span class="n">from_points</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="p">(</span><span class="n">field</span><span class="p">,))</span>
    <span class="n">sd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
    <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span>
        <span class="s1">&#39;postProcess&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-func&#39;</span><span class="p">,</span> <span class="s1">&#39;sampleDict&#39;</span><span class="p">,</span> <span class="s1">&#39;-latest_time&#39;</span><span class="p">),</span>
        <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to sample the case:</span><span class="se">\n\t</span><span class="si">%s</span><span class="s2">&quot;</span>
                        <span class="o">%</span> <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_folders</span><span class="p">())</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
        <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Found no results folder. Either you have not run the &#39;</span>
                <span class="s1">&#39;analysis or the run has faild. Check inside &quot;log&quot; folder.&#39;</span><span class="p">)</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post_processing_folder</span><span class="p">,</span> <span class="s1">&#39;sampleDict&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                            <span class="n">f</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sd</span><span class="o">.</span><span class="n">output_filenames</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">load_probes_and_values_from_sample_file</span><span class="p">(</span><span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">pts</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Results&#39;</span><span class="p">,</span> <span class="s1">&#39;probes values&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.save">
    <p>def <span class="ident">save</span>(</p><p>self, overwrite=False, minimum=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Save case to folder.</p>
<p>Args:
    overwrite: If True all the current content will be overwritten
        (default: False).
    minimum: Write minimum necessary files for case. These files will
        be enough for meshing the case but not running any commands.
        Files are ('fv_schemes', 'fv_solution', 'controlDict',
        'blockMeshDict','snappyHexMeshDict'). Rest of the files will be
        created from a Solution.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.save', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save case to folder.</span>
<span class="sd">    Args:</span>
<span class="sd">        overwrite: If True all the current content will be overwritten</span>
<span class="sd">            (default: False).</span>
<span class="sd">        minimum: Write minimum necessary files for case. These files will</span>
<span class="sd">            be enough for meshing the case but not running any commands.</span>
<span class="sd">            Files are (&#39;fv_schemes&#39;, &#39;fv_solution&#39;, &#39;controlDict&#39;,</span>
<span class="sd">            &#39;blockMeshDict&#39;,&#39;snappyHexMeshDict&#39;). Rest of the files will be</span>
<span class="sd">            created from a Solution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create folder and subfolders if they are not already created</span>
    <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">):</span>
        <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUBFOLDERS</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Butterfly failed to create {}</span><span class="se">\n\t</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[Error 183]&#39;</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="c1"># save foamfiles</span>
    <span class="k">if</span> <span class="n">minimum</span><span class="p">:</span>
        <span class="n">foam_files</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span>
                      <span class="k">if</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MINFOAMFIles</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">foam_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">foam_files</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">)</span>
    <span class="c1"># find blockMeshDict and convert_to_meters so I can scale stl files to meters.</span>
    <span class="n">bmds</span> <span class="o">=</span> <span class="p">(</span><span class="n">ff</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">foam_files</span> <span class="k">if</span> <span class="n">ff</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;blockMeshDict&#39;</span><span class="p">)</span>
    <span class="n">bmd</span> <span class="o">=</span> <span class="n">bmds</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
    <span class="n">convert_to_meters</span> <span class="o">=</span> <span class="n">bmd</span><span class="o">.</span><span class="n">convert_to_meters</span>
    <span class="c1"># write bfgeometries to stl file. __geometries is geometries without</span>
    <span class="c1"># blockMesh geometry</span>
    <span class="n">stl_str</span> <span class="o">=</span> <span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">to_stl</span><span class="p">(</span><span class="n">convert_to_meters</span><span class="p">)</span> <span class="k">for</span> <span class="n">geo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geometries</span><span class="p">)</span>
    <span class="n">stl_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__originalName</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tri_surface_folder</span><span class="p">,</span>
                           <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.stl&#39;</span> <span class="o">%</span> <span class="n">stl_name</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stlf</span><span class="p">:</span>
        <span class="n">stlf</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">stl_str</span><span class="p">)</span>
    <span class="c1"># write refinement_regions to stl files</span>
    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_regions</span><span class="p">:</span>
        <span class="n">ref</span><span class="o">.</span><span class="n">write_to_stl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tri_surface_folder</span><span class="p">,</span> <span class="n">convert_to_meters</span><span class="p">)</span>
    <span class="c1"># add .foam file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">+</span> <span class="s1">&#39;.foam&#39;</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ffile</span><span class="p">:</span>
        <span class="n">ffile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} is saved to: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_dir</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.snappy_hex_mesh">
    <p>def <span class="ident">snappy_hex_mesh</span>(</p><p>self, args=None, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Run snappyHexMesh.</p>
<p>Args:
    args: Command arguments.
    wait: Wait until command execution ends.
Returns:
    namedtuple(success, error, process, logfiles, errorfiles).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.snappy_hex_mesh', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.snappy_hex_mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">snappy_hex_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run snappyHexMesh.</span>
<span class="sd">    Args:</span>
<span class="sd">        args: Command arguments.</span>
<span class="sd">        wait: Wait until command execution ends.</span>
<span class="sd">    Returns:</span>
<span class="sd">        namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;snappyHexMesh&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposeParDict</span><span class="p">,</span>
                        <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.surface_feature_extract">
    <p>def <span class="ident">surface_feature_extract</span>(</p><p>self, args=None, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Run surfaceFeatureExtract command.</p>
<p>Args:
    args: Command arguments.
    wait: Wait until command execution ends.
Returns:
    namedtuple(success, error, process, logfiles, errorfiles).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.surface_feature_extract', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.surface_feature_extract" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">surface_feature_extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run surfaceFeatureExtract command.</span>
<span class="sd">    Args:</span>
<span class="sd">        args: Command arguments.</span>
<span class="sd">        wait: Wait until command execution ends.</span>
<span class="sd">    Returns:</span>
<span class="sd">        namedtuple(success, error, process, logfiles, errorfiles).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create surfaceFeatureExtractDict if it&#39;s not created</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;surfaceFeatureExtract&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">decomposeParDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="butterfly.case.Case.update_bc_in_zero_folder">
    <p>def <span class="ident">update_bc_in_zero_folder</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Update boundary conditions in files in 0 folder.</p>
<p>Call this method if you have made any changes to boundary condition of
any of the geometries after initiating the class.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-butterfly.case.Case.update_bc_in_zero_folder', this);">Show source &equiv;</a></p>
  <div id="source-butterfly.case.Case.update_bc_in_zero_folder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_bc_in_zero_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update boundary conditions in files in 0 folder.</span>
<span class="sd">    Call this method if you have made any changes to boundary condition of</span>
<span class="sd">    any of the geometries after initiating the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>
  </footer>
</div>
</body>
</html>