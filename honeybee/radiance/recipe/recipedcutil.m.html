<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>honeybee.radiance.recipe.recipedcutil API documentation</title>
    <meta name="description" content="A collection of useful methods for daylight-coeff recipes." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 0.9em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    margin-left: 25%;
    max-width: 90%;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    position: fixed;
    height: 100%;
    width: 25%;
    float: left;
    padding: 30px;
    overflow: auto;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  .desc {
    white-space: pre-wrap;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      position: inherit;
      float: none;
      width: auto;
    }
    #content {
      width: 95%;
      margin-left: auto;
      border-left: none;
      padding: 30px;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.coeff_matrix_commands">coeff_matrix_commands</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.create_reference_map_command">create_reference_map_command</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.final_matrix_addition">final_matrix_addition</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.final_matrix_addition_radiation">final_matrix_addition_radiation</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.get_commands_radiation_sky">get_commands_radiation_sky</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.get_commands_scene_daylight_coeff">get_commands_scene_daylight_coeff</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.get_commands_sky">get_commands_sky</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.get_commands_w_groups_daylight_coeff">get_commands_w_groups_daylight_coeff</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.image_based_view_coeff_matrix_commands">image_based_view_coeff_matrix_commands</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.image_based_view_matrix_calculation">image_based_view_matrix_calculation</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.image_based_view_sampling_commands">image_based_view_sampling_commands</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.imaged_based_sun_coeff_matrix_commands">imaged_based_sun_coeff_matrix_commands</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.matrix_calculation">matrix_calculation</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.rgb_matrix_file_to_ill">rgb_matrix_file_to_ill</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.sky_receiver">sky_receiver</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.skymtx_to_gendaymtx">skymtx_to_gendaymtx</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.sun_coeff_matrix_commands">sun_coeff_matrix_commands</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.sun_matrix_calculation">sun_matrix_calculation</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.window_group_to_receiver">window_group_to_receiver</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.recipedcutil.write_rad_files_daylight_coeff">write_rad_files_daylight_coeff</a></li>
  </ul>

    </li>


    
    <li class="set"><h3>Module Index :: <a href="../../../honeybee/index.html">honeybee</a></h3>
    
    <ul>
      <li class="mono"><a href="../../../honeybee/config.m.html">config</a></li>
      

      <li class="mono"><a href="../../../honeybee/dataoperation.m.html">dataoperation</a></li>
      

      <li class="mono"><a href="../../../honeybee/energyplus/index.html">energyplus</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/energyplus/filemanager.m.html">filemanager</a></li>
      

      <li class="mono"><a href="../../../honeybee/energyplus/geometryrules.m.html">geometryrules</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/futil.m.html">futil</a></li>
      

      <li class="mono"><a href="../../../honeybee/geometryoperation.m.html">geometryoperation</a></li>
      

      <li class="mono"><a href="../../../honeybee/hbdynamicsurface.m.html">hbdynamicsurface</a></li>
      

      <li class="mono"><a href="../../../honeybee/hbfensurface.m.html">hbfensurface</a></li>
      

      <li class="mono"><a href="../../../honeybee/hbobject.m.html">hbobject</a></li>
      

      <li class="mono"><a href="../../../honeybee/hbshadesurface.m.html">hbshadesurface</a></li>
      

      <li class="mono"><a href="../../../honeybee/hbsurface.m.html">hbsurface</a></li>
      

      <li class="mono"><a href="../../../honeybee/hbzone.m.html">hbzone</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/index.html">radiance</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/analysisgrid.m.html">analysisgrid</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/analysispoint.m.html">analysispoint</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/index.html">command</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/command/dctimestep.m.html">dctimestep</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/epw2wea.m.html">epw2wea</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/falsecolor.m.html">falsecolor</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/genBSDF.m.html">genBSDF</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/gendaymtx.m.html">gendaymtx</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/gensky.m.html">gensky</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/genskyvec.m.html">genskyvec</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/getbbox.m.html">getbbox</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/getinfo.m.html">getinfo</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/objview.m.html">objview</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/oconv.m.html">oconv</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/pcomb.m.html">pcomb</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/pyRad/index.html">pyRad</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/command/pyRad/objview.m.html">objview</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/pyRad/pyRadLib/index.html">pyRadLib</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/command/pyRad/pyRadLib/pyrad_proc.m.html">pyrad_proc</a></li>
      

    </ul>

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/command/raBmp.m.html">raBmp</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/raTiff.m.html">raTiff</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rcalc.m.html">rcalc</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rcollate.m.html">rcollate</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rcontrib.m.html">rcontrib</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rfluxmtx.m.html">rfluxmtx</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rmtxop.m.html">rmtxop</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rpict.m.html">rpict</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/rtrace.m.html">rtrace</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/vwrays.m.html">vwrays</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/command/xform.m.html">xform</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/datatype.m.html">datatype</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/filemanager.m.html">filemanager</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/geometry.m.html">geometry</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/imagecollection.m.html">imagecollection</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/index.html">material</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/material/bsdf.m.html">bsdf</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/custom.m.html">custom</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/glass.m.html">glass</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/glow.m.html">glow</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/light.m.html">light</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/metal.m.html">metal</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/material/plastic.m.html">plastic</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/parameters/index.html">parameters</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/parameters/dctimestep.m.html">dctimestep</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/falsecolor.m.html">falsecolor</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/genBsdf.m.html">genBsdf</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/gendaymtx.m.html">gendaymtx</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/gensky.m.html">gensky</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/imagebased.m.html">imagebased</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/oconv.m.html">oconv</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/pcomb.m.html">pcomb</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/raBmp.m.html">raBmp</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/raTiff.m.html">raTiff</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/rcalc.m.html">rcalc</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/rcollate.m.html">rcollate</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/rcontrib.m.html">rcontrib</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/rfluxmtx.m.html">rfluxmtx</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/rmtxop.m.html">rmtxop</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/vwrays.m.html">vwrays</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/parameters/xform.m.html">xform</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/properties.m.html">properties</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/radfile.m.html">radfile</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/index.html">recipe</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/annual/index.html">annual</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/annual/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/recipe/daylightcoeff/index.html">daylightcoeff</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/daylightcoeff/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/daylightcoeff/imagebased.m.html">imagebased</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/recipe/daylightfactor/index.html">daylightfactor</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/daylightfactor/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/recipe/fivephase/index.html">fivephase</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/fivephase/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/recipe/parameters.m.html">parameters</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/pointintime/index.html">pointintime</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/pointintime/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/pointintime/imagebased.m.html">imagebased</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/recipe/radiation/index.html">radiation</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/radiation/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="">recipedcutil</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/recipeutil.m.html">recipeutil</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/recipexphaseutil.m.html">recipexphaseutil</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/recipe/solaraccess/index.html">solaraccess</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/solaraccess/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/recipe/threephase/index.html">threephase</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/recipe/threephase/gridbased.m.html">gridbased</a></li>
      

    </ul>

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/runmanager.m.html">runmanager</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/scene.m.html">scene</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/index.html">sky</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/radiance/sky/certainIlluminance.m.html">certainIlluminance</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/cie.m.html">cie</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/climatebased.m.html">climatebased</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/skymatrix.m.html">skymatrix</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/skyvector.m.html">skyvector</a></li>
      

      <li class="mono"><a href="../../../honeybee/radiance/sky/sunmatrix.m.html">sunmatrix</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/radiance/view.m.html">view</a></li>
      

    </ul>

      <li class="mono"><a href="../../../honeybee/room.m.html">room</a></li>
      

      <li class="mono"><a href="../../../honeybee/schedule.m.html">schedule</a></li>
      

      <li class="mono"><a href="../../../honeybee/surfaceproperties.m.html">surfaceproperties</a></li>
      

      <li class="mono"><a href="../../../honeybee/surfacetype.m.html">surfacetype</a></li>
      

      <li class="mono"><a href="../../../honeybee/utilcol.m.html">utilcol</a></li>
      

      <li class="mono"><a href="../../../honeybee/vectormath/index.html">vectormath</a></li>
      
    <ul>
      <li class="mono"><a href="../../../honeybee/vectormath/euclid.m.html">euclid</a></li>
      

    </ul>

    </ul>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">honeybee.radiance.recipe.recipedcutil</span> module</h1>
  <p>A collection of useful methods for daylight-coeff recipes.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;A collection of useful methods for daylight-coeff recipes.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">..command.rfluxmtx</span> <span class="kn">import</span> <span class="n">Rfluxmtx</span>
<span class="kn">from</span> <span class="nn">..command.dctimestep</span> <span class="kn">import</span> <span class="n">Dctimestep</span>
<span class="kn">from</span> <span class="nn">..command.rmtxop</span> <span class="kn">import</span> <span class="n">Rmtxop</span><span class="p">,</span> <span class="n">RmtxopMatrix</span>
<span class="kn">from</span> <span class="nn">..command.gendaymtx</span> <span class="kn">import</span> <span class="n">Gendaymtx</span>
<span class="kn">from</span> <span class="nn">..sky.sunmatrix</span> <span class="kn">import</span> <span class="n">SunMatrix</span>
<span class="kn">from</span> <span class="nn">..command.oconv</span> <span class="kn">import</span> <span class="n">Oconv</span>
<span class="kn">from</span> <span class="nn">..command.rpict</span> <span class="kn">import</span> <span class="n">Rpict</span>
<span class="kn">from</span> <span class="nn">..command.rcontrib</span> <span class="kn">import</span> <span class="n">Rcontrib</span>
<span class="kn">from</span> <span class="nn">..command.vwrays</span> <span class="kn">import</span> <span class="n">Vwrays</span>
<span class="kn">from</span> <span class="nn">..parameters.imagebased</span> <span class="kn">import</span> <span class="n">ImageBasedParameters</span>
<span class="kn">from</span> <span class="nn">.recipeutil</span> <span class="kn">import</span> <span class="n">glz_srf_towin_group</span>
<span class="kn">from</span> <span class="nn">.parameters</span> <span class="kn">import</span> <span class="n">get_radiance_parameters_grid_based</span><span class="p">,</span> \
    <span class="n">get_radiance_parameters_image_based</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>


<span class="k">def</span> <span class="nf">write_rad_files_daylight_coeff</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">opq</span><span class="p">,</span> <span class="n">glz</span><span class="p">,</span> <span class="n">wgs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write files to a target directory for daylight coefficeint method.</span>

<span class="sd">    The files will be written under</span>
<span class="sd">        working_dir/opaque</span>
<span class="sd">        working_dir/glazing</span>
<span class="sd">        working_dir/wgroup</span>

<span class="sd">    Args:</span>
<span class="sd">        working_dir: Path to working directory.</span>
<span class="sd">        opq: A RadFile for opaque surfaces.</span>
<span class="sd">        glz: A RadFile for glazing surfaces.</span>
<span class="sd">        wgs: A collection of RadFiles for window-groups.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A named tuple for each RadFile as (fp, fpblk)</span>
<span class="sd">        fp returns the file path to the list of radiance files.</span>
<span class="sd">        fpblk returns the file path to the list of blacked radiance files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Files</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Files&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span> <span class="s1">&#39;fpblk&#39;</span><span class="p">])</span>

    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="s1">&#39;opaque&#39;</span><span class="p">)</span>
    <span class="n">of</span> <span class="o">=</span> <span class="n">opq</span><span class="o">.</span><span class="n">write_geometries</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..opq.rad&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">om</span> <span class="o">=</span> <span class="n">opq</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..opq.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">bm</span> <span class="o">=</span> <span class="n">opq</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..blk.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">opqf</span> <span class="o">=</span> <span class="n">Files</span><span class="p">((</span><span class="n">om</span><span class="p">,</span> <span class="n">of</span><span class="p">),</span> <span class="p">(</span><span class="n">bm</span><span class="p">,</span> <span class="n">of</span><span class="p">))</span>

    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="s1">&#39;glazing&#39;</span><span class="p">)</span>
    <span class="n">ogf</span> <span class="o">=</span> <span class="n">glz</span><span class="o">.</span><span class="n">write_geometries</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..glz.rad&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ogm</span> <span class="o">=</span> <span class="n">glz</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..glz.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">bgm</span> <span class="o">=</span> <span class="n">glz</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..blk.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">glzf</span> <span class="o">=</span> <span class="n">Files</span><span class="p">((</span><span class="n">ogm</span><span class="p">,</span> <span class="n">ogf</span><span class="p">),</span> <span class="p">(</span><span class="n">bgm</span><span class="p">,</span> <span class="n">ogf</span><span class="p">))</span>

    <span class="n">wgfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="s1">&#39;wgroup&#39;</span><span class="p">)</span>
    <span class="c1"># write black material to folder</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">wgf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wgs</span><span class="p">):</span>
        <span class="c1"># write it as a black geometry</span>
        <span class="n">wg</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">hb_surfaces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">wgbm</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">write_black_material</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;black.mat&#39;</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">wgbf</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">write_geometries_blacked</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..blk.rad&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># write files for each state</span>
        <span class="n">wgfstate</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">scount</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
            <span class="n">wg</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">scount</span>
            <span class="n">wgfst</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..</span><span class="si">%s</span><span class="s1">.rad&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">wgfstate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wgfst</span><span class="p">)</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># set the state back to 0</span>
        <span class="n">wgfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Files</span><span class="p">(</span><span class="n">wgfstate</span><span class="p">,</span> <span class="p">(</span><span class="n">wgbm</span><span class="p">,</span> <span class="n">wgbf</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">opqf</span><span class="p">,</span> <span class="n">glzf</span><span class="p">,</span> <span class="n">wgfs</span>


<span class="k">def</span> <span class="nf">get_commands_sky</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="p">,</span> <span class="n">reuse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of commands to generate the skies.</span>

<span class="sd">    1. total sky matrix</span>
<span class="sd">    2. direct only sky matrix</span>
<span class="sd">    3. sun matrix (aka analemma)</span>

<span class="sd">    This methdo genrates sun matrix under project_folder/sky and return the commands</span>
<span class="sd">    to generate skies number 1 and 2.</span>

<span class="sd">    Returns a namedtuple for (output_files, commands)</span>
<span class="sd">    output_files in a namedtuple itself (sky_mtx_total, sky_mtx_direct, analemma,</span>
<span class="sd">        sunlist, analemmaMtx).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">OutputFiles</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;OutputFiles&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;sky_mtx_total sky_mtx_direct analemma sunlist analemmaMtx&#39;</span><span class="p">)</span>

    <span class="n">SkyCommands</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SkyCommands&#39;</span><span class="p">,</span> <span class="s1">&#39;output_files commands&#39;</span><span class="p">)</span>

    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># # 2.1.Create sky matrix.</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sky_mtx_total</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">sky_mtx_direct</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># add commands for total and direct sky matrix.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="s1">&#39;isSkyMatrix&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">m</span>
            <span class="n">gdm</span> <span class="o">=</span> <span class="n">skymtx_to_gendaymtx</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gdm</span><span class="p">:</span>
                <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;:: {} sky matrix&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span> <span class="k">if</span> <span class="n">m</span> <span class="k">else</span> <span class="s1">&#39;total&#39;</span><span class="p">)</span>
                <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">note</span><span class="p">,</span> <span class="n">gdm</span><span class="p">))</span>
        <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># sky vector</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;You must use a SkyMatrix to generate the sky.&#39;</span><span class="p">)</span>

    <span class="c1"># # 2.2. Create sun matrix</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">sun_matrix</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">wea</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">hoys</span><span class="p">,</span>
                    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">sky_type</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">suffix</span><span class="p">)</span>
    <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span> <span class="o">=</span> \
        <span class="n">sm</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="s1">&#39;sky&#39;</span><span class="p">),</span> <span class="n">reuse</span><span class="o">=</span><span class="n">reuse</span><span class="p">)</span>

    <span class="n">of</span> <span class="o">=</span> <span class="n">OutputFiles</span><span class="p">(</span><span class="n">sky_mtx_total</span><span class="p">,</span> <span class="n">sky_mtx_direct</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SkyCommands</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_commands_radiation_sky</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="p">,</span> <span class="n">reuse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of commands to generate the skies.</span>

<span class="sd">    1. sky matrix diffuse</span>
<span class="sd">    3. sun matrix (aka analemma)</span>

<span class="sd">    This methdo genrates sun matrix under project_folder/sky and return the commands</span>
<span class="sd">    to generate sky number 1.</span>

<span class="sd">    Returns a namedtuple for (output_files, commands)</span>
<span class="sd">    output_files in a namedtuple itself (sky_mtx_total, sky_mtx_direct, analemma,</span>
<span class="sd">        sunlist, analemmaMtx).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">OutputFiles</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;OutputFiles&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;sky_mtxDiff analemma sunlist analemmaMtx&#39;</span><span class="p">)</span>

    <span class="n">SkyCommands</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SkyCommands&#39;</span><span class="p">,</span> <span class="s1">&#39;output_files commands&#39;</span><span class="p">)</span>

    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="s1">&#39;isSkyMatrix&#39;</span><span class="p">):</span>
        <span class="c1"># sky vector</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;You must use a SkyMatrix to generate the sky.&#39;</span><span class="p">)</span>

    <span class="c1"># # 2.1.Create sky matrix.</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">sky_mtx_diff</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">gdm</span> <span class="o">=</span> <span class="n">skymtx_to_gendaymtx</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gdm</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;:: diffuse sky matrix&#39;</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">note</span><span class="p">,</span> <span class="n">gdm</span><span class="p">))</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># # 2.2. Create sun matrix</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">sun_matrix</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">wea</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">hoys</span><span class="p">,</span>
                    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">sky_type</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">suffix</span><span class="p">)</span>
    <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span> <span class="o">=</span> \
        <span class="n">sm</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="s1">&#39;sky&#39;</span><span class="p">),</span> <span class="n">reuse</span><span class="o">=</span><span class="n">reuse</span><span class="p">)</span>

    <span class="n">of</span> <span class="o">=</span> <span class="n">OutputFiles</span><span class="p">(</span><span class="n">sky_mtx_diff</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SkyCommands</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>


<span class="c1"># TODO(mostapha): restructure inputs to make the method useful for a normal user.</span>
<span class="c1"># It&#39;s currently structured to satisfy what we need for the recipes.</span>
<span class="k">def</span> <span class="nf">get_commands_scene_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span> <span class="n">inputfiles</span><span class="p">,</span>
        <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">total_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radiation_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for the static windows in the scene.</span>

<span class="sd">    Use get_commands_w_groups_daylight_coeff to get the commands for the rest of the</span>
<span class="sd">    scene.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name: A string to generate uniqe file names for this project.</span>
<span class="sd">        sky_density: Sky density for this study.</span>
<span class="sd">        project_folder: Path to project_folder.</span>
<span class="sd">        skyfiles: Collection of path to sky files. The order must be (sky_mtx_total,</span>
<span class="sd">            sky_mtx_direct, analemma, sunlist, analemmaMtx). You can use get_commands_sky</span>
<span class="sd">            function to generate this list.</span>
<span class="sd">        inputfiles: Input files for this study. The order must be (opqfiles, glzfiles,</span>
<span class="sd">            wgsfiles, extrafiles). Each files object is a namedtuple which includes</span>
<span class="sd">            filepath to radiance files under fp and filepath to backed out files under</span>
<span class="sd">            fpblk.</span>
<span class="sd">        points_file: Path to points_file.</span>
<span class="sd">        total_point_count: Number of total points inside points_file.</span>
<span class="sd">        rfluxmtx_parameters: An instance of rfluxmtx_parameters for daylight matrix.</span>
<span class="sd">        reuse_daylight_mtx: A boolean not to include the commands for daylight matrix</span>
<span class="sd">            calculation if they already exist inside the folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># unpack inputs</span>
    <span class="n">opqfiles</span><span class="p">,</span> <span class="n">glzfiles</span><span class="p">,</span> <span class="n">wgsfiles</span><span class="p">,</span> <span class="n">extrafiles</span> <span class="o">=</span> <span class="n">inputfiles</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgsfiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># material is the first file</span>
        <span class="n">blkmaterial</span> <span class="o">=</span> <span class="p">[</span><span class="n">wgsfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="c1"># collect files for blacked geometries for all window groups</span>
        <span class="n">wgsblacked</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wgsfiles</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># there is no window group, return an empty tuple</span>
        <span class="n">blkmaterial</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">wgsblacked</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">window_group</span> <span class="o">=</span> <span class="n">glz_srf_towin_group</span><span class="p">()</span>
    <span class="n">window_groupfiles</span> <span class="o">=</span> <span class="n">glzfiles</span><span class="o">.</span><span class="n">fp</span>

    <span class="n">commands</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">_get_commands_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_group</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span>
        <span class="n">inputfiles</span><span class="p">,</span> <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">,</span>
        <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">window_groupfiles</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">total_count</span><span class="p">),</span>
        <span class="n">radiation_only</span><span class="o">=</span><span class="n">radiation_only</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">commands</span><span class="p">,</span> <span class="n">results</span>


<span class="k">def</span> <span class="nf">get_commands_w_groups_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_groups</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span> <span class="n">inputfiles</span><span class="p">,</span>
        <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">total_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radiation_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for the static windows in the scene.</span>

<span class="sd">    Use get_commands_w_groups_daylight_coeff to get the commands for the rest of the</span>
<span class="sd">    scene.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name: A string to generate uniqe file names for this project.</span>
<span class="sd">        sky_density: Sky density for this study.</span>
<span class="sd">        project_folder: Path to project_folder.</span>
<span class="sd">        window_groups: List of window_groups.</span>
<span class="sd">        skyfiles: Collection of path to sky files. The order must be (sky_mtx_total,</span>
<span class="sd">            sky_mtx_direct, analemma, sunlist, analemmaMtx). You can use get_commands_sky</span>
<span class="sd">            function to generate this list.</span>
<span class="sd">        inputfiles: Input files for this study. The order must be (opqfiles, glzfiles,</span>
<span class="sd">            wgsfiles, extrafiles). Each files object is a namedtuple which includes</span>
<span class="sd">            filepath to radiance files under fp and filepath to backed out files under</span>
<span class="sd">            fpblk.</span>
<span class="sd">        points_file: Path to points_file.</span>
<span class="sd">        total_point_count: Number of total points inside points_file.</span>
<span class="sd">        rfluxmtx_parameters: An instance of rfluxmtx_parameters for daylight matrix.</span>
<span class="sd">        reuse_daylight_mtx: A boolean not to include the commands for daylight matrix</span>
<span class="sd">            calculation if they already exist inside the folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># unpack inputs</span>
    <span class="n">opqfiles</span><span class="p">,</span> <span class="n">glzfiles</span><span class="p">,</span> <span class="n">wgsfiles</span><span class="p">,</span> <span class="n">extrafiles</span> <span class="o">=</span> <span class="n">inputfiles</span>
    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">window_group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">window_groups</span><span class="p">):</span>
        <span class="c1"># get black material file</span>
        <span class="n">blkmaterial</span> <span class="o">=</span> <span class="p">[</span><span class="n">wgsfiles</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="c1"># add all the blacked window groups but the one in use</span>
        <span class="c1"># and finally add non-window group glazing as black</span>
        <span class="n">wgsblacked</span> <span class="o">=</span> \
            <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wgsfiles</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">count</span><span class="p">]</span> <span class="o">+</span> \
            <span class="nb">list</span><span class="p">(</span><span class="n">glzfiles</span><span class="o">.</span><span class="n">fpblk</span><span class="p">)</span>

        <span class="n">counter</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">state_count</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">window_groups</span><span class="p">[:</span><span class="n">count</span><span class="p">])</span>

        <span class="n">cmds</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_get_commands_daylight_coeff</span><span class="p">(</span>
            <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_group</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span>
            <span class="n">inputfiles</span><span class="p">,</span> <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">,</span>
            <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">window_groupfiles</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="n">reuse_daylight_mtx</span><span class="p">,</span> <span class="n">counter</span><span class="o">=</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">total_count</span><span class="p">),</span>
            <span class="n">radiation_only</span><span class="o">=</span><span class="n">radiation_only</span><span class="p">)</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cmds</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">commands</span><span class="p">,</span> <span class="n">results</span>


<span class="c1"># TODO(): use logging instead of print</span>
<span class="k">def</span> <span class="nf">_get_commands_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_group</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span> <span class="n">inputfiles</span><span class="p">,</span>
        <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="p">,</span>
        <span class="n">window_group_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">window_groupfiles</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">counter</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">radiation_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for the daylight coefficient recipe.</span>

<span class="sd">    This function is used by get_commands_scene_daylight_coeff and</span>
<span class="sd">    get_commands_w_groups_daylight_coeff. You usually don&#39;t want to use this function</span>
<span class="sd">    directly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">result_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># unpack inputs</span>
    <span class="n">opqfiles</span><span class="p">,</span> <span class="n">glzfiles</span><span class="p">,</span> <span class="n">wgsfiles</span><span class="p">,</span> <span class="n">extrafiles</span> <span class="o">=</span> <span class="n">inputfiles</span>
    <span class="k">if</span> <span class="n">radiation_only</span><span class="p">:</span>
        <span class="n">sky_mtxDiff</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span> <span class="o">=</span> <span class="n">skyfiles</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sky_mtx_total</span><span class="p">,</span> <span class="n">sky_mtx_direct</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span> <span class="o">=</span> <span class="n">skyfiles</span>

    <span class="k">for</span> <span class="n">scount</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
        <span class="c1"># 2.3.Generate daylight coefficients using rfluxmtx</span>
        <span class="c1"># collect list of radiance files in the scene for both total and direct</span>
        <span class="k">if</span> <span class="n">counter</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">((</span><span class="n">counter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scount</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">counter</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: Done with {} of {} ^|{}{}^| ({:.2f}</span><span class="si">%%</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">counter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">counter</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;#&#39;</span> <span class="o">*</span> <span class="n">c</span><span class="p">,</span>
                    <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="n">c</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">&#39;:: start of the calculation for {}, {}. State {} of {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">scount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">window_group</span><span class="o">.</span><span class="n">state_count</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">window_groupfiles</span><span class="p">:</span>
            <span class="c1"># in case window group is not already provided</span>
            <span class="n">window_groupfiles</span> <span class="o">=</span> <span class="p">(</span><span class="n">wgsfiles</span><span class="p">[</span><span class="n">window_group_count</span><span class="p">]</span><span class="o">.</span><span class="n">fp</span><span class="p">[</span><span class="n">scount</span><span class="p">],)</span>

        <span class="n">rflux_scene</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">f</span> <span class="k">for</span> <span class="n">fl</span> <span class="ow">in</span>
            <span class="p">(</span><span class="n">window_groupfiles</span><span class="p">,</span> <span class="n">opqfiles</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span> <span class="n">extrafiles</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span>
             <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">)</span>

        <span class="n">rflux_scene_blacked</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">f</span> <span class="k">for</span> <span class="n">fl</span> <span class="ow">in</span>
            <span class="p">(</span><span class="n">window_groupfiles</span><span class="p">,</span> <span class="n">opqfiles</span><span class="o">.</span><span class="n">fpblk</span><span class="p">,</span> <span class="n">extrafiles</span><span class="o">.</span><span class="n">fpblk</span><span class="p">,</span>
             <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">)</span>

        <span class="n">d_matrix</span> <span class="o">=</span> <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">matrix</span><span class="se">\\</span><span class="s1">normal_{}..{}..{}.dc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">project_name</span><span class="p">,</span> <span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">d_matrix_direct</span> <span class="o">=</span> <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">matrix</span><span class="se">\\</span><span class="s1">black_{}..{}..{}.dc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">project_name</span><span class="p">,</span> <span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">sun_matrix</span> <span class="o">=</span> <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">matrix</span><span class="se">\\</span><span class="s1">sun_{}..{}..{}.dc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">project_name</span><span class="p">,</span> <span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">d_matrix</span><span class="p">))</span> \
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">reuse_daylight_mtx</span><span class="p">:</span>
            <span class="n">rad_files</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">rflux_scene</span><span class="p">)</span>
            <span class="n">sender</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
            <span class="n">receiver</span> <span class="o">=</span> <span class="n">sky_receiver</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">rfluxSky.rad&#39;</span><span class="p">),</span> <span class="n">sky_density</span>
            <span class="p">)</span>

            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: 1. calculating daylight matrices&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>

            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [1/3] scene daylight matrix&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rfluxmtx - [sky] [points] [wgroup] [blacked wgroups] [scene]&#39;</span>
                <span class="s1">&#39; ^&gt; [dc.mtx]&#39;</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>

            <span class="c1"># sampling_rays_count = 1 based on @sariths studies</span>
            <span class="n">rflux</span> <span class="o">=</span> <span class="n">coeff_matrix_commands</span><span class="p">(</span>
                <span class="n">d_matrix</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span> <span class="n">rad_files</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">points_file</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span> <span class="n">total_point_count</span><span class="p">,</span>
                <span class="n">rfluxmtx_parameters</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rflux</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

            <span class="n">rad_files_blacked</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
                                      <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">rflux_scene_blacked</span><span class="p">)</span>

            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [2/3] black scene daylight matrix&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rfluxmtx - [sky] [points] [wgroup] [blacked wgroups] &#39;</span>
                <span class="s1">&#39;[blacked scene] ^&gt; [black dc.mtx]&#39;</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>

            <span class="n">original_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rfluxmtx_parameters</span><span class="o">.</span><span class="n">ambient_bounces</span><span class="p">)</span>
            <span class="n">rfluxmtx_parameters</span><span class="o">.</span><span class="n">ambient_bounces</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rflux_direct</span> <span class="o">=</span> <span class="n">coeff_matrix_commands</span><span class="p">(</span>
                <span class="n">d_matrix_direct</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span>
                <span class="n">rad_files_blacked</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">points_file</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span>
                <span class="n">total_point_count</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rflux_direct</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>
            <span class="n">rfluxmtx_parameters</span><span class="o">.</span><span class="n">ambient_bounces</span> <span class="o">=</span> <span class="n">original_value</span>

            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [3/3] black scene analemma daylight matrix&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rcontrib - [sun_matrix] [points] [wgroup] [blacked wgroups] &#39;</span>
                <span class="s1">&#39;[blacked scene] ^&gt; [analemma dc.mtx]&#39;</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
            <span class="n">sun_commands</span> <span class="o">=</span> <span class="n">sun_coeff_matrix_commands</span><span class="p">(</span>
                <span class="n">sun_matrix</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">points_file</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span>
                <span class="n">rad_files_blacked</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">analemma</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">sunlist</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">),</span>
                <span class="n">rfluxmtx_parameters</span><span class="o">.</span><span class="n">irradiance_calc</span>
            <span class="p">)</span>

            <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">sun_commands</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: 1. reusing daylight matrices&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: 2. matrix multiplication&#39;</span><span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">radiation_only</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [1/2] calculating daylight mtx * diffuse sky&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: dctimestep [dc.mtx] [diffuse sky] ^&gt; [diffuse results.rgb]&#39;</span><span class="p">)</span>
            <span class="n">dct_total</span> <span class="o">=</span> <span class="n">matrix_calculation</span><span class="p">(</span>
                <span class="s1">&#39;tmp</span><span class="se">\\</span><span class="s1">diffuse..{}..{}.rgb&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="n">d_matrix</span><span class="o">=</span><span class="n">d_matrix</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="n">sky_mtxDiff</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [1/3] calculating daylight mtx * total sky&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: dctimestep [dc.mtx] [total sky] ^&gt; [total results.rgb]&#39;</span><span class="p">)</span>

            <span class="n">dct_total</span> <span class="o">=</span> <span class="n">matrix_calculation</span><span class="p">(</span>
                <span class="s1">&#39;tmp</span><span class="se">\\</span><span class="s1">total..{}..{}.rgb&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="n">d_matrix</span><span class="o">=</span><span class="n">d_matrix</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="n">sky_mtx_total</span>
            <span class="p">)</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dct_total</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">radiation_only</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rmtxop -c 47.4 119.9 11.6 [results.rgb] ^&gt; [diffuse results.ill]&#39;</span>
            <span class="p">)</span>
            <span class="n">finalmtx</span> <span class="o">=</span> <span class="n">rgb_matrix_file_to_ill</span><span class="p">(</span>
                <span class="p">(</span><span class="n">dct_total</span><span class="o">.</span><span class="n">output_file</span><span class="p">,),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">diffuse..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rmtxop -c 47.4 119.9 11.6 [results.rgb] ^&gt; [total results.ill]&#39;</span>
            <span class="p">)</span>
            <span class="n">finalmtx</span> <span class="o">=</span> <span class="n">rgb_matrix_file_to_ill</span><span class="p">(</span>
                <span class="p">(</span><span class="n">dct_total</span><span class="o">.</span><span class="n">output_file</span><span class="p">,),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">total..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finalmtx</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">radiation_only</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: [2/3] calculating black daylight mtx * direct only sky&#39;</span><span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: dctimestep [black dc.mtx] [direct only sky] ^&gt; &#39;</span>
                <span class="s1">&#39;[direct results.rgb]&#39;</span><span class="p">)</span>

            <span class="n">dct_direct</span> <span class="o">=</span> <span class="n">matrix_calculation</span><span class="p">(</span>
                <span class="s1">&#39;tmp</span><span class="se">\\</span><span class="s1">direct..{}..{}.rgb&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="n">d_matrix</span><span class="o">=</span><span class="n">d_matrix_direct</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="n">sky_mtx_direct</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dct_direct</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rmtxop -c 47.4 119.9 11.6 [direct results.rgb] ^&gt; &#39;</span>
                <span class="s1">&#39;[direct results.ill]&#39;</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
            <span class="n">finalmtx</span> <span class="o">=</span> <span class="n">rgb_matrix_file_to_ill</span><span class="p">(</span>
                <span class="p">(</span><span class="n">dct_direct</span><span class="o">.</span><span class="n">output_file</span><span class="p">,),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">direct..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finalmtx</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">radiation_only</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [3/3] calculating black daylight mtx * analemma&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: [2/2] calculating black daylight mtx * analemma&#39;</span><span class="p">)</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">&#39;:: :: dctimestep [black dc.mtx] [analemma only sky] ^&gt; [sun results.rgb]&#39;</span><span class="p">)</span>
        <span class="n">dct_sun</span> <span class="o">=</span> <span class="n">sun_matrix_calculation</span><span class="p">(</span>
            <span class="s1">&#39;tmp</span><span class="se">\\</span><span class="s1">sun..{}..{}.rgb&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="n">dc_matrix</span><span class="o">=</span><span class="n">sun_matrix</span><span class="p">,</span>
            <span class="n">sky_matrix</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">analemmaMtx</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dct_sun</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">&#39;:: :: rmtxop -c 47.4 119.9 11.6 [sun results.rgb] ^&gt; &#39;</span>
            <span class="s1">&#39;[sun results.ill]&#39;</span>
        <span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
        <span class="n">finalmtx</span> <span class="o">=</span> <span class="n">rgb_matrix_file_to_ill</span><span class="p">(</span>
            <span class="p">(</span><span class="n">dct_sun</span><span class="o">.</span><span class="n">output_file</span><span class="p">,),</span>
            <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">sun..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finalmtx</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;:: :: 3. calculating final results&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">radiation_only</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rmtxop [diff results.ill] &#39;</span>
                <span class="s1">&#39;+ [sun results.ill] ^&gt; [final results.ill]&#39;</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
            <span class="n">fmtx</span> <span class="o">=</span> <span class="n">final_matrix_addition_radiation</span><span class="p">(</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">diffuse..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">sun..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmtx</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;:: :: rmtxop [total results.ill] - [direct results.ill] &#39;</span>
                <span class="s1">&#39;+ [sun results.ill] ^&gt; [final results.ill]&#39;</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
            <span class="n">fmtx</span> <span class="o">=</span> <span class="n">final_matrix_addition</span><span class="p">(</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">total..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">direct..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">sun..{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">{}..{}.ill&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmtx</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">())</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">&#39;:: end of calculation for {}, {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">window_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>

        <span class="n">result_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fmtx</span><span class="o">.</span><span class="n">output_file</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">commands</span><span class="p">,</span> <span class="n">result_files</span>


<span class="k">def</span> <span class="nf">image_based_view_sampling_commands</span><span class="p">(</span>
        <span class="n">project_folder</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_file</span><span class="p">,</span> <span class="n">vwrays_parameters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return VWrays command for calculating view coefficient matrix.&quot;&quot;&quot;</span>
    <span class="c1"># calculate view dimensions</span>
    <span class="n">vwr_dim_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">project_folder</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;view</span><span class="se">\\</span><span class="s1">{}.dim&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_view_dimension</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vwr_dim_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">vdfile</span><span class="p">:</span>
        <span class="n">vdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-x </span><span class="si">%d</span><span class="s1"> -y </span><span class="si">%d</span><span class="s1"> -ld-</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="c1"># calculate sampling for each view</span>
    <span class="c1"># the value will be different for each view</span>
    <span class="n">vwrays_parameters</span><span class="o">.</span><span class="n">x_resolution</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">x_res</span>
    <span class="n">vwrays_parameters</span><span class="o">.</span><span class="n">y_resolution</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">y_res</span>

    <span class="n">vwr_samp</span> <span class="o">=</span> <span class="n">Vwrays</span><span class="p">()</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">vwrays_parameters</span> <span class="o">=</span> <span class="n">vwrays_parameters</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">view_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">view_file</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;view</span><span class="se">\\</span><span class="s1">{}.rays&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>

    <span class="k">return</span> <span class="n">vwr_dim_file</span><span class="p">,</span> <span class="n">vwr_samp</span>


<span class="k">def</span> <span class="nf">create_reference_map_command</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">view_file</span><span class="p">,</span> <span class="n">outputfolder</span><span class="p">,</span> <span class="n">octree_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a reference map to conver illuminance to luminance.&quot;&quot;&quot;</span>
    <span class="c1"># set the parameters / options</span>
    <span class="n">img_par</span> <span class="o">=</span> <span class="n">ImageBasedParameters</span><span class="p">()</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">ambient_accuracy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">ambient_value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.31831</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">pixel_sampling</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">pixel_jitter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_view_dimension</span><span class="p">()</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">x_resolution</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">y_resolution</span> <span class="o">=</span> <span class="n">y</span>

    <span class="n">rp</span> <span class="o">=</span> <span class="n">Rpict</span><span class="p">()</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">rpict_parameters</span> <span class="o">=</span> <span class="n">img_par</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">octree_file</span> <span class="o">=</span> <span class="n">octree_file</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">view_file</span> <span class="o">=</span> <span class="n">view_file</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outputfolder</span><span class="p">,</span> <span class="s1">&#39;{}_map.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">rp</span>


<span class="k">def</span> <span class="nf">imaged_based_sun_coeff_matrix_commands</span><span class="p">(</span>
        <span class="n">output_filename_format</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_rays_file</span><span class="p">,</span> <span class="n">scene_files</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">):</span>
    <span class="c1"># output, point_file, scene_files, analemma, sunlist, irradiance_calc</span>

    <span class="n">octree</span> <span class="o">=</span> <span class="n">Oconv</span><span class="p">()</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">scene_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scene_files</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">analemma</span><span class="p">]</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;analemma.oct&#39;</span>

    <span class="c1"># Creating sun coefficients</span>
    <span class="c1"># -ab 0 -i -ffc -dj 0 -dc 1 -dt 0</span>
    <span class="n">rctb_param</span> <span class="o">=</span> <span class="n">get_radiance_parameters_image_based</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">smtx</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">x_dimension</span><span class="p">,</span> <span class="n">rctb_param</span><span class="o">.</span><span class="n">y_dimension</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_view_dimension</span><span class="p">()</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">mod_file</span> <span class="o">=</span> <span class="n">sunlist</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> <span class="s1">&#39;fc&#39;</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">irradiance_calc</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># -I</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">i_irradiance_calc</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c1"># -i</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">output_filename_format</span> <span class="o">=</span> <span class="n">output_filename_format</span>

    <span class="n">rctb</span> <span class="o">=</span> <span class="n">Rcontrib</span><span class="p">()</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">octree_file</span> <span class="o">=</span> <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">points_file</span> <span class="o">=</span> <span class="n">view_rays_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">rcontrib_parameters</span> <span class="o">=</span> <span class="n">rctb_param</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">octree</span><span class="p">,</span> <span class="n">rctb</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">image_based_view_coeff_matrix_commands</span><span class="p">(</span>
        <span class="n">receiver</span><span class="p">,</span> <span class="n">rad_files</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">view_info_file</span><span class="p">,</span> <span class="n">view_file</span><span class="p">,</span> <span class="n">view_rays_file</span><span class="p">,</span>
        <span class="n">rfluxmtx_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns radiance commands to create coefficient matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        receiver: A radiance file to indicate the receiver. In view matrix it will be the</span>
<span class="sd">        window group and in daylight matrix it will be the sky.</span>
<span class="sd">        rad_files: A collection of Radiance files that should be included in the scene.</span>
<span class="sd">        sender: A collection of files for senders if senders are radiance geometries</span>
<span class="sd">            such as window groups (Default: &#39;-&#39;).</span>
<span class="sd">        points_file: Path to point file which will be used instead of sender.</span>
<span class="sd">        number_of_points: Number of points in points_file as an integer.</span>
<span class="sd">        sampling_rays_count: Number of sampling rays (Default: 1000).</span>
<span class="sd">        rfluxmtx_parameters: Radiance parameters for Rfluxmtx command using a</span>
<span class="sd">            RfluxmtxParameters instance (Default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rflux</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="p">()</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">rfluxmtx_parameters</span> <span class="o">=</span> <span class="n">rfluxmtx_parameters</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">rad_files</span> <span class="o">=</span> <span class="n">rad_files</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span> <span class="ow">or</span> <span class="s1">&#39;-&#39;</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">receiver_file</span> <span class="o">=</span> <span class="n">receiver</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> <span class="s1">&#39;fc&#39;</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">view_info_file</span> <span class="o">=</span> <span class="n">view_info_file</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">view_rays_file</span> <span class="o">=</span> <span class="n">view_rays_file</span>

    <span class="k">return</span> <span class="n">rflux</span>


<span class="k">def</span> <span class="nf">coeff_matrix_commands</span><span class="p">(</span><span class="n">output_name</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">rad_files</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">points_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">number_of_points</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns radiance commands to create coefficient matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_name: Output file name.</span>
<span class="sd">        receiver: A radiance file to indicate the receiver. In view matrix it will be the</span>
<span class="sd">        window group and in daylight matrix it will be the sky.</span>
<span class="sd">        rad_files: A collection of Radiance files that should be included in the scene.</span>
<span class="sd">        sender: A collection of files for senders if senders are radiance geometries</span>
<span class="sd">            such as window groups (Default: &#39;-&#39;).</span>
<span class="sd">        points_file: Path to point file which will be used instead of sender.</span>
<span class="sd">        number_of_points: Number of points in points_file as an integer.</span>
<span class="sd">        rfluxmtx_parameters: Radiance parameters for Rfluxmtx command using a</span>
<span class="sd">            RfluxmtxParameters instance (Default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span> <span class="ow">or</span> <span class="s1">&#39;-&#39;</span>
    <span class="n">rad_files</span> <span class="o">=</span> <span class="n">rad_files</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">number_of_points</span> <span class="o">=</span> <span class="n">number_of_points</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="n">rfluxmtx</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">points_file</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have to set the points_file when sender is not defined.&#39;</span><span class="p">)</span>

    <span class="c1"># -------------- set the parameters ----------------- #</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">rfluxmtx_parameters</span> <span class="o">=</span> <span class="n">rfluxmtx_parameters</span>

    <span class="c1"># -------------- set up the sender objects ---------- #</span>
    <span class="c1"># &#39;-&#39; in case of view matrix, window group in case of</span>
    <span class="c1"># daylight matrix. This is normally the receiver file</span>
    <span class="c1"># in view matrix</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span>

    <span class="c1"># points file are the senders in view matrix</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">number_of_points</span> <span class="o">=</span> <span class="n">number_of_points</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">points_file</span> <span class="o">=</span> <span class="n">points_file</span>

    <span class="c1"># --------------- set up the  receiver --------------- #</span>
    <span class="c1"># This will be the window for view matrix and the sky for</span>
    <span class="c1"># daylight matrix. It makes sense to make a method for each</span>
    <span class="c1"># of thme as they are pretty repetitive</span>
    <span class="c1"># Klems full basis sampling</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">receiver_file</span> <span class="o">=</span> <span class="n">receiver</span>

    <span class="c1"># ------------- add radiance geometry files ----------------</span>
    <span class="c1"># For view matrix it&#39;s usually the room itself and the materials</span>
    <span class="c1"># in case of each view analysis rest of the windows should be</span>
    <span class="c1"># blacked! In case of daylight matrix it will be the context</span>
    <span class="c1"># outside the window.</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">rad_files</span> <span class="o">=</span> <span class="n">rad_files</span>

    <span class="c1"># output file address/name</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">output_matrix</span> <span class="o">=</span> <span class="n">output_name</span>

    <span class="k">return</span> <span class="n">rfluxmtx</span>


<span class="k">def</span> <span class="nf">window_group_to_receiver</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">upnormal</span><span class="p">,</span> <span class="n">material_name</span><span class="o">=</span><span class="s1">&#39;vmtx_glow&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take a filepath to a window group and create a receiver.&quot;&quot;&quot;</span>
    <span class="n">rec_ctrl_par</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">control_parameters</span><span class="p">(</span>
        <span class="n">hemi_type</span><span class="o">=</span><span class="s1">&#39;kf&#39;</span><span class="p">,</span> <span class="n">hemi_up_direction</span><span class="o">=</span><span class="n">upnormal</span><span class="p">)</span>
    <span class="n">wg_m</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">add_control_parameters</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">{</span><span class="n">material_name</span><span class="p">:</span> <span class="n">rec_ctrl_par</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">wg_m</span>


<span class="k">def</span> <span class="nf">sky_receiver</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">ground_file_format</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sky_file_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a receiver sky for daylight coefficient studies.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ground_file_format</span> <span class="ow">and</span> <span class="n">sky_file_format</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">default_sky_ground</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">sky_type</span><span class="o">=</span><span class="s1">&#39;r{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">density</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">default_sky_ground</span><span class="p">(</span>
            <span class="n">filepath</span><span class="p">,</span> <span class="n">sky_type</span><span class="o">=</span><span class="s1">&#39;r{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">density</span><span class="p">),</span>
            <span class="n">ground_file_format</span><span class="o">=</span><span class="n">ground_file_format</span><span class="p">,</span>
            <span class="n">sky_file_format</span><span class="o">=</span><span class="n">sky_file_format</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">matrix_calculation</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">v_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">t_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">d_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for matrix calculation.</span>

<span class="sd">    This method sets up a matrix calculations using Dctimestep.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">Dctimestep</span><span class="p">()</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">tmatrix_file</span> <span class="o">=</span> <span class="n">t_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">vmatrix_spec</span> <span class="o">=</span> <span class="n">v_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">dmatrix_file</span> <span class="o">=</span> <span class="n">d_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">sky_vector_file</span> <span class="o">=</span> <span class="n">sky_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>
    <span class="k">return</span> <span class="n">dct</span>


<span class="k">def</span> <span class="nf">image_based_view_matrix_calculation</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">wg</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="p">,</span> <span class="n">extention</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                        <span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">Dctimestep</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">daylight_coeff_spec</span> <span class="o">=</span> \
            <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">dc</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="si">%%</span><span class="s1">0{}d_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">digits</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">daylight_coeff_spec</span> <span class="o">=</span> \
            <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">dc</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="s1">%0{}d_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">digits</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="n">dct</span><span class="o">.</span><span class="n">sky_vector_file</span> <span class="o">=</span> <span class="n">sky_matrix</span>

    <span class="c1"># sky matrix is annual</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">dctimestep_parameters</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> \
            <span class="s1">&#39; result</span><span class="se">\\</span><span class="s1">hdr</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="si">%%</span><span class="s1">04d_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">dctimestep_parameters</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> \
            <span class="s1">&#39; result</span><span class="se">\\</span><span class="s1">hdr</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="si">%04d</span><span class="s1">_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dct</span>


<span class="k">def</span> <span class="nf">sun_matrix_calculation</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dc_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for sun matrix calculation.</span>

<span class="sd">    This method sets up a matrix calculations using Dctimestep.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">Dctimestep</span><span class="p">()</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">daylight_coeff_spec</span> <span class="o">=</span> <span class="n">dc_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">sky_vector_file</span> <span class="o">=</span> <span class="n">sky_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>
    <span class="k">return</span> <span class="n">dct</span>


<span class="k">def</span> <span class="nf">sun_coeff_matrix_commands</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">point_file</span><span class="p">,</span> <span class="n">scene_files</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span>
                              <span class="n">irradiance_calc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return commands for calculating analemma coefficient.</span>

<span class="sd">    Args:</span>
<span class="sd">        output: Output daylight coefficient file (e.g. suncoeff.dc).</span>
<span class="sd">        point_file: Path to point / analysis grid file. In case of multiple grid</span>
<span class="sd">            put them together in a single file.</span>
<span class="sd">        scene_files: A list fo scene files. Usually black scene.</span>
<span class="sd">        analemma: Path to analemma file. You can generate analemma file using</span>
<span class="sd">            sun_matrix class. Analemma has list of sun positions with their respective</span>
<span class="sd">            values.</span>
<span class="sd">        sunlist: Path to sunlist. Use sun_matrix to generate sunlist.</span>
<span class="sd">        simulation_type:</span>
<span class="sd">    Returns:</span>
<span class="sd">        octree and rcontrib commands ready to be executed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">octree</span> <span class="o">=</span> <span class="n">Oconv</span><span class="p">()</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">scene_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scene_files</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">analemma</span><span class="p">]</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;analemma.oct&#39;</span>

    <span class="c1"># Creating sun coefficients</span>
    <span class="n">rctb_param</span> <span class="o">=</span> <span class="n">get_radiance_parameters_grid_based</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">smtx</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">mod_file</span> <span class="o">=</span> <span class="n">sunlist</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">irradiance_calc</span> <span class="o">=</span> <span class="n">irradiance_calc</span>

    <span class="n">rctb</span> <span class="o">=</span> <span class="n">Rcontrib</span><span class="p">()</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">octree_file</span> <span class="o">=</span> <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">points_file</span> <span class="o">=</span> <span class="n">point_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">rcontrib_parameters</span> <span class="o">=</span> <span class="n">rctb_param</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">octree</span><span class="p">,</span> <span class="n">rctb</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">final_matrix_addition</span><span class="p">(</span><span class="n">skymtx</span><span class="p">,</span> <span class="n">skydirmtx</span><span class="p">,</span> <span class="n">sunmtx</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add final sky, direct sky and sun matrix.&quot;&quot;&quot;</span>
    <span class="c1"># Instantiate matrices for subtraction and addition.</span>
    <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">Rmtxop</span><span class="p">()</span>

    <span class="c1"># std. dc matrix.</span>
    <span class="n">dc_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">dc_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">skymtx</span>

    <span class="c1"># direct dc matrix. -1 indicates that this one is being subtracted from dc matrix.</span>
    <span class="n">dc_direct_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">dc_direct_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">skydirmtx</span>
    <span class="n">dc_direct_matrix</span><span class="o">.</span><span class="n">scalar_factors</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Sun coefficient matrix.</span>
    <span class="n">sun_coeff_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">sun_coeff_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">sunmtx</span>

    <span class="c1"># combine the matrices together. Sequence is extremely important</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">rmtxop_matrices</span> <span class="o">=</span> <span class="p">[</span><span class="n">dc_matrix</span><span class="p">,</span> <span class="n">dc_direct_matrix</span><span class="p">,</span> <span class="n">sun_coeff_matrix</span><span class="p">]</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">return</span> <span class="n">final_matrix</span>


<span class="k">def</span> <span class="nf">final_matrix_addition_radiation</span><span class="p">(</span><span class="n">skydifmtx</span><span class="p">,</span> <span class="n">sunmtx</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add final diffuse sky and sun matrix.&quot;&quot;&quot;</span>
    <span class="c1"># Instantiate matrices for subtraction and addition.</span>
    <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">Rmtxop</span><span class="p">()</span>

    <span class="c1"># std. dc matrix.</span>
    <span class="n">dc_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">dc_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">skydifmtx</span>

    <span class="c1"># Sun coefficient matrix.</span>
    <span class="n">sun_coeff_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">sun_coeff_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">sunmtx</span>

    <span class="c1"># combine the matrices together. Sequence is extremely important</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">rmtxop_matrices</span> <span class="o">=</span> <span class="p">[</span><span class="n">dc_matrix</span><span class="p">,</span> <span class="n">sun_coeff_matrix</span><span class="p">]</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">return</span> <span class="n">final_matrix</span>


<span class="k">def</span> <span class="nf">rgb_matrix_file_to_ill</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert rgb values in matrix to illuminance values.&quot;&quot;&quot;</span>
    <span class="n">finalmtx</span> <span class="o">=</span> <span class="n">Rmtxop</span><span class="p">(</span><span class="n">matrix_files</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
    <span class="n">finalmtx</span><span class="o">.</span><span class="n">rmtxop_parameters</span><span class="o">.</span><span class="n">output_format</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
    <span class="n">finalmtx</span><span class="o">.</span><span class="n">rmtxop_parameters</span><span class="o">.</span><span class="n">combine_values</span> <span class="o">=</span> <span class="p">(</span><span class="mf">47.4</span><span class="p">,</span> <span class="mf">119.9</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">)</span>
    <span class="n">finalmtx</span><span class="o">.</span><span class="n">rmtxop_parameters</span><span class="o">.</span><span class="n">transpose_matrix</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="n">finalmtx</span>


<span class="k">def</span> <span class="nf">skymtx_to_gendaymtx</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="n">target_folder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return gendaymtx command based on input sky_matrix.&quot;&quot;&quot;</span>
    <span class="n">wea_filepath</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.wea&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sky_mtx</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">hours_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.hrs&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="n">sky_mtx</span><span class="p">))</span> \
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="n">wea_filepath</span><span class="p">))</span> \
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">hours_match</span><span class="p">(</span><span class="n">hours_file</span><span class="p">):</span>
        <span class="c1"># write wea file to folder</span>
        <span class="n">sky_matrix</span><span class="o">.</span><span class="n">write_wea</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="s1">&#39;sky&#39;</span><span class="p">),</span> <span class="n">write_hours</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">gdm</span> <span class="o">=</span> <span class="n">Gendaymtx</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="n">sky_mtx</span><span class="p">,</span> <span class="n">wea_file</span><span class="o">=</span><span class="n">wea_filepath</span><span class="p">)</span>
        <span class="n">gdm</span><span class="o">.</span><span class="n">gendaymtx_parameters</span> <span class="o">=</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">sky_matrix_parameters</span>
        <span class="k">return</span> <span class="n">gdm</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.coeff_matrix_commands">
    <p>def <span class="ident">coeff_matrix_commands</span>(</p><p>output_name, receiver, rad_files, sender, points_file=None, number_of_points=None, rfluxmtx_parameters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns radiance commands to create coefficient matrix.</p>
<p>Args:
    output_name: Output file name.
    receiver: A radiance file to indicate the receiver. In view matrix it will be the
    window group and in daylight matrix it will be the sky.
    rad_files: A collection of Radiance files that should be included in the scene.
    sender: A collection of files for senders if senders are radiance geometries
        such as window groups (Default: '-').
    points_file: Path to point file which will be used instead of sender.
    number_of_points: Number of points in points_file as an integer.
    rfluxmtx_parameters: Radiance parameters for Rfluxmtx command using a
        RfluxmtxParameters instance (Default: None).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.coeff_matrix_commands', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.coeff_matrix_commands" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">coeff_matrix_commands</span><span class="p">(</span><span class="n">output_name</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">rad_files</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">points_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">number_of_points</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns radiance commands to create coefficient matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_name: Output file name.</span>
<span class="sd">        receiver: A radiance file to indicate the receiver. In view matrix it will be the</span>
<span class="sd">        window group and in daylight matrix it will be the sky.</span>
<span class="sd">        rad_files: A collection of Radiance files that should be included in the scene.</span>
<span class="sd">        sender: A collection of files for senders if senders are radiance geometries</span>
<span class="sd">            such as window groups (Default: &#39;-&#39;).</span>
<span class="sd">        points_file: Path to point file which will be used instead of sender.</span>
<span class="sd">        number_of_points: Number of points in points_file as an integer.</span>
<span class="sd">        rfluxmtx_parameters: Radiance parameters for Rfluxmtx command using a</span>
<span class="sd">            RfluxmtxParameters instance (Default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span> <span class="ow">or</span> <span class="s1">&#39;-&#39;</span>
    <span class="n">rad_files</span> <span class="o">=</span> <span class="n">rad_files</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">number_of_points</span> <span class="o">=</span> <span class="n">number_of_points</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="n">rfluxmtx</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">points_file</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have to set the points_file when sender is not defined.&#39;</span><span class="p">)</span>

    <span class="c1"># -------------- set the parameters ----------------- #</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">rfluxmtx_parameters</span> <span class="o">=</span> <span class="n">rfluxmtx_parameters</span>

    <span class="c1"># -------------- set up the sender objects ---------- #</span>
    <span class="c1"># &#39;-&#39; in case of view matrix, window group in case of</span>
    <span class="c1"># daylight matrix. This is normally the receiver file</span>
    <span class="c1"># in view matrix</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span>

    <span class="c1"># points file are the senders in view matrix</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">number_of_points</span> <span class="o">=</span> <span class="n">number_of_points</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">points_file</span> <span class="o">=</span> <span class="n">points_file</span>

    <span class="c1"># --------------- set up the  receiver --------------- #</span>
    <span class="c1"># This will be the window for view matrix and the sky for</span>
    <span class="c1"># daylight matrix. It makes sense to make a method for each</span>
    <span class="c1"># of thme as they are pretty repetitive</span>
    <span class="c1"># Klems full basis sampling</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">receiver_file</span> <span class="o">=</span> <span class="n">receiver</span>

    <span class="c1"># ------------- add radiance geometry files ----------------</span>
    <span class="c1"># For view matrix it&#39;s usually the room itself and the materials</span>
    <span class="c1"># in case of each view analysis rest of the windows should be</span>
    <span class="c1"># blacked! In case of daylight matrix it will be the context</span>
    <span class="c1"># outside the window.</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">rad_files</span> <span class="o">=</span> <span class="n">rad_files</span>

    <span class="c1"># output file address/name</span>
    <span class="n">rfluxmtx</span><span class="o">.</span><span class="n">output_matrix</span> <span class="o">=</span> <span class="n">output_name</span>

    <span class="k">return</span> <span class="n">rfluxmtx</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.create_reference_map_command">
    <p>def <span class="ident">create_reference_map_command</span>(</p><p>view, view_file, outputfolder, octree_file)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a reference map to conver illuminance to luminance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.create_reference_map_command', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.create_reference_map_command" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_reference_map_command</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">view_file</span><span class="p">,</span> <span class="n">outputfolder</span><span class="p">,</span> <span class="n">octree_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a reference map to conver illuminance to luminance.&quot;&quot;&quot;</span>
    <span class="c1"># set the parameters / options</span>
    <span class="n">img_par</span> <span class="o">=</span> <span class="n">ImageBasedParameters</span><span class="p">()</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">ambient_accuracy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">ambient_value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.31831</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">pixel_sampling</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">pixel_jitter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_view_dimension</span><span class="p">()</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">x_resolution</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">img_par</span><span class="o">.</span><span class="n">y_resolution</span> <span class="o">=</span> <span class="n">y</span>

    <span class="n">rp</span> <span class="o">=</span> <span class="n">Rpict</span><span class="p">()</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">rpict_parameters</span> <span class="o">=</span> <span class="n">img_par</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">octree_file</span> <span class="o">=</span> <span class="n">octree_file</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">view_file</span> <span class="o">=</span> <span class="n">view_file</span>
    <span class="n">rp</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outputfolder</span><span class="p">,</span> <span class="s1">&#39;{}_map.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">rp</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.final_matrix_addition">
    <p>def <span class="ident">final_matrix_addition</span>(</p><p>skymtx, skydirmtx, sunmtx, output)</p>
    </div>
    

    
  
    <div class="desc"><p>Add final sky, direct sky and sun matrix.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.final_matrix_addition', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.final_matrix_addition" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">final_matrix_addition</span><span class="p">(</span><span class="n">skymtx</span><span class="p">,</span> <span class="n">skydirmtx</span><span class="p">,</span> <span class="n">sunmtx</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add final sky, direct sky and sun matrix.&quot;&quot;&quot;</span>
    <span class="c1"># Instantiate matrices for subtraction and addition.</span>
    <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">Rmtxop</span><span class="p">()</span>

    <span class="c1"># std. dc matrix.</span>
    <span class="n">dc_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">dc_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">skymtx</span>

    <span class="c1"># direct dc matrix. -1 indicates that this one is being subtracted from dc matrix.</span>
    <span class="n">dc_direct_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">dc_direct_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">skydirmtx</span>
    <span class="n">dc_direct_matrix</span><span class="o">.</span><span class="n">scalar_factors</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Sun coefficient matrix.</span>
    <span class="n">sun_coeff_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">sun_coeff_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">sunmtx</span>

    <span class="c1"># combine the matrices together. Sequence is extremely important</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">rmtxop_matrices</span> <span class="o">=</span> <span class="p">[</span><span class="n">dc_matrix</span><span class="p">,</span> <span class="n">dc_direct_matrix</span><span class="p">,</span> <span class="n">sun_coeff_matrix</span><span class="p">]</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">return</span> <span class="n">final_matrix</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.final_matrix_addition_radiation">
    <p>def <span class="ident">final_matrix_addition_radiation</span>(</p><p>skydifmtx, sunmtx, output)</p>
    </div>
    

    
  
    <div class="desc"><p>Add final diffuse sky and sun matrix.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.final_matrix_addition_radiation', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.final_matrix_addition_radiation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">final_matrix_addition_radiation</span><span class="p">(</span><span class="n">skydifmtx</span><span class="p">,</span> <span class="n">sunmtx</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add final diffuse sky and sun matrix.&quot;&quot;&quot;</span>
    <span class="c1"># Instantiate matrices for subtraction and addition.</span>
    <span class="n">final_matrix</span> <span class="o">=</span> <span class="n">Rmtxop</span><span class="p">()</span>

    <span class="c1"># std. dc matrix.</span>
    <span class="n">dc_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">dc_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">skydifmtx</span>

    <span class="c1"># Sun coefficient matrix.</span>
    <span class="n">sun_coeff_matrix</span> <span class="o">=</span> <span class="n">RmtxopMatrix</span><span class="p">()</span>
    <span class="n">sun_coeff_matrix</span><span class="o">.</span><span class="n">matrix_file</span> <span class="o">=</span> <span class="n">sunmtx</span>

    <span class="c1"># combine the matrices together. Sequence is extremely important</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">rmtxop_matrices</span> <span class="o">=</span> <span class="p">[</span><span class="n">dc_matrix</span><span class="p">,</span> <span class="n">sun_coeff_matrix</span><span class="p">]</span>
    <span class="n">final_matrix</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">return</span> <span class="n">final_matrix</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.get_commands_radiation_sky">
    <p>def <span class="ident">get_commands_radiation_sky</span>(</p><p>project_folder, sky_matrix, reuse=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Get list of commands to generate the skies.</p>
<ol>
<li>sky matrix diffuse</li>
<li>sun matrix (aka analemma)</li>
</ol>
<p>This methdo genrates sun matrix under project_folder/sky and return the commands
to generate sky number 1.</p>
<p>Returns a namedtuple for (output_files, commands)
output_files in a namedtuple itself (sky_mtx_total, sky_mtx_direct, analemma,
    sunlist, analemmaMtx).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.get_commands_radiation_sky', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.get_commands_radiation_sky" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_commands_radiation_sky</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="p">,</span> <span class="n">reuse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of commands to generate the skies.</span>

<span class="sd">    1. sky matrix diffuse</span>
<span class="sd">    3. sun matrix (aka analemma)</span>

<span class="sd">    This methdo genrates sun matrix under project_folder/sky and return the commands</span>
<span class="sd">    to generate sky number 1.</span>

<span class="sd">    Returns a namedtuple for (output_files, commands)</span>
<span class="sd">    output_files in a namedtuple itself (sky_mtx_total, sky_mtx_direct, analemma,</span>
<span class="sd">        sunlist, analemmaMtx).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">OutputFiles</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;OutputFiles&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;sky_mtxDiff analemma sunlist analemmaMtx&#39;</span><span class="p">)</span>

    <span class="n">SkyCommands</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SkyCommands&#39;</span><span class="p">,</span> <span class="s1">&#39;output_files commands&#39;</span><span class="p">)</span>

    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="s1">&#39;isSkyMatrix&#39;</span><span class="p">):</span>
        <span class="c1"># sky vector</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;You must use a SkyMatrix to generate the sky.&#39;</span><span class="p">)</span>

    <span class="c1"># # 2.1.Create sky matrix.</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">sky_mtx_diff</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">gdm</span> <span class="o">=</span> <span class="n">skymtx_to_gendaymtx</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gdm</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;:: diffuse sky matrix&#39;</span>
        <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">note</span><span class="p">,</span> <span class="n">gdm</span><span class="p">))</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># # 2.2. Create sun matrix</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">sun_matrix</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">wea</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">hoys</span><span class="p">,</span>
                    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">sky_type</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">suffix</span><span class="p">)</span>
    <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span> <span class="o">=</span> \
        <span class="n">sm</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="s1">&#39;sky&#39;</span><span class="p">),</span> <span class="n">reuse</span><span class="o">=</span><span class="n">reuse</span><span class="p">)</span>

    <span class="n">of</span> <span class="o">=</span> <span class="n">OutputFiles</span><span class="p">(</span><span class="n">sky_mtx_diff</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SkyCommands</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.get_commands_scene_daylight_coeff">
    <p>def <span class="ident">get_commands_scene_daylight_coeff</span>(</p><p>project_name, sky_density, project_folder, skyfiles, inputfiles, points_file, total_point_count, rfluxmtx_parameters, reuse_daylight_mtx=False, total_count=1, radiation_only=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get commands for the static windows in the scene.</p>
<p>Use get_commands_w_groups_daylight_coeff to get the commands for the rest of the
scene.</p>
<p>Args:
    project_name: A string to generate uniqe file names for this project.
    sky_density: Sky density for this study.
    project_folder: Path to project_folder.
    skyfiles: Collection of path to sky files. The order must be (sky_mtx_total,
        sky_mtx_direct, analemma, sunlist, analemmaMtx). You can use get_commands_sky
        function to generate this list.
    inputfiles: Input files for this study. The order must be (opqfiles, glzfiles,
        wgsfiles, extrafiles). Each files object is a namedtuple which includes
        filepath to radiance files under fp and filepath to backed out files under
        fpblk.
    points_file: Path to points_file.
    total_point_count: Number of total points inside points_file.
    rfluxmtx_parameters: An instance of rfluxmtx_parameters for daylight matrix.
    reuse_daylight_mtx: A boolean not to include the commands for daylight matrix
        calculation if they already exist inside the folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.get_commands_scene_daylight_coeff', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.get_commands_scene_daylight_coeff" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_commands_scene_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span> <span class="n">inputfiles</span><span class="p">,</span>
        <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">total_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radiation_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for the static windows in the scene.</span>

<span class="sd">    Use get_commands_w_groups_daylight_coeff to get the commands for the rest of the</span>
<span class="sd">    scene.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name: A string to generate uniqe file names for this project.</span>
<span class="sd">        sky_density: Sky density for this study.</span>
<span class="sd">        project_folder: Path to project_folder.</span>
<span class="sd">        skyfiles: Collection of path to sky files. The order must be (sky_mtx_total,</span>
<span class="sd">            sky_mtx_direct, analemma, sunlist, analemmaMtx). You can use get_commands_sky</span>
<span class="sd">            function to generate this list.</span>
<span class="sd">        inputfiles: Input files for this study. The order must be (opqfiles, glzfiles,</span>
<span class="sd">            wgsfiles, extrafiles). Each files object is a namedtuple which includes</span>
<span class="sd">            filepath to radiance files under fp and filepath to backed out files under</span>
<span class="sd">            fpblk.</span>
<span class="sd">        points_file: Path to points_file.</span>
<span class="sd">        total_point_count: Number of total points inside points_file.</span>
<span class="sd">        rfluxmtx_parameters: An instance of rfluxmtx_parameters for daylight matrix.</span>
<span class="sd">        reuse_daylight_mtx: A boolean not to include the commands for daylight matrix</span>
<span class="sd">            calculation if they already exist inside the folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># unpack inputs</span>
    <span class="n">opqfiles</span><span class="p">,</span> <span class="n">glzfiles</span><span class="p">,</span> <span class="n">wgsfiles</span><span class="p">,</span> <span class="n">extrafiles</span> <span class="o">=</span> <span class="n">inputfiles</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgsfiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># material is the first file</span>
        <span class="n">blkmaterial</span> <span class="o">=</span> <span class="p">[</span><span class="n">wgsfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="c1"># collect files for blacked geometries for all window groups</span>
        <span class="n">wgsblacked</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wgsfiles</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># there is no window group, return an empty tuple</span>
        <span class="n">blkmaterial</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">wgsblacked</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">window_group</span> <span class="o">=</span> <span class="n">glz_srf_towin_group</span><span class="p">()</span>
    <span class="n">window_groupfiles</span> <span class="o">=</span> <span class="n">glzfiles</span><span class="o">.</span><span class="n">fp</span>

    <span class="n">commands</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">_get_commands_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_group</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span>
        <span class="n">inputfiles</span><span class="p">,</span> <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">,</span>
        <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">window_groupfiles</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">total_count</span><span class="p">),</span>
        <span class="n">radiation_only</span><span class="o">=</span><span class="n">radiation_only</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">commands</span><span class="p">,</span> <span class="n">results</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.get_commands_sky">
    <p>def <span class="ident">get_commands_sky</span>(</p><p>project_folder, sky_matrix, reuse=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Get list of commands to generate the skies.</p>
<ol>
<li>total sky matrix</li>
<li>direct only sky matrix</li>
<li>sun matrix (aka analemma)</li>
</ol>
<p>This methdo genrates sun matrix under project_folder/sky and return the commands
to generate skies number 1 and 2.</p>
<p>Returns a namedtuple for (output_files, commands)
output_files in a namedtuple itself (sky_mtx_total, sky_mtx_direct, analemma,
    sunlist, analemmaMtx).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.get_commands_sky', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.get_commands_sky" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_commands_sky</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="p">,</span> <span class="n">reuse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of commands to generate the skies.</span>

<span class="sd">    1. total sky matrix</span>
<span class="sd">    2. direct only sky matrix</span>
<span class="sd">    3. sun matrix (aka analemma)</span>

<span class="sd">    This methdo genrates sun matrix under project_folder/sky and return the commands</span>
<span class="sd">    to generate skies number 1 and 2.</span>

<span class="sd">    Returns a namedtuple for (output_files, commands)</span>
<span class="sd">    output_files in a namedtuple itself (sky_mtx_total, sky_mtx_direct, analemma,</span>
<span class="sd">        sunlist, analemmaMtx).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">OutputFiles</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;OutputFiles&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;sky_mtx_total sky_mtx_direct analemma sunlist analemmaMtx&#39;</span><span class="p">)</span>

    <span class="n">SkyCommands</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SkyCommands&#39;</span><span class="p">,</span> <span class="s1">&#39;output_files commands&#39;</span><span class="p">)</span>

    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># # 2.1.Create sky matrix.</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sky_mtx_total</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">sky_mtx_direct</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># add commands for total and direct sky matrix.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="s1">&#39;isSkyMatrix&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">m</span>
            <span class="n">gdm</span> <span class="o">=</span> <span class="n">skymtx_to_gendaymtx</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gdm</span><span class="p">:</span>
                <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;:: {} sky matrix&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span> <span class="k">if</span> <span class="n">m</span> <span class="k">else</span> <span class="s1">&#39;total&#39;</span><span class="p">)</span>
                <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">note</span><span class="p">,</span> <span class="n">gdm</span><span class="p">))</span>
        <span class="n">sky_matrix</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># sky vector</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;You must use a SkyMatrix to generate the sky.&#39;</span><span class="p">)</span>

    <span class="c1"># # 2.2. Create sun matrix</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">sun_matrix</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">wea</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">hoys</span><span class="p">,</span>
                    <span class="n">sky_matrix</span><span class="o">.</span><span class="n">sky_type</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">suffix</span><span class="p">)</span>
    <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span> <span class="o">=</span> \
        <span class="n">sm</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="s1">&#39;sky&#39;</span><span class="p">),</span> <span class="n">reuse</span><span class="o">=</span><span class="n">reuse</span><span class="p">)</span>

    <span class="n">of</span> <span class="o">=</span> <span class="n">OutputFiles</span><span class="p">(</span><span class="n">sky_mtx_total</span><span class="p">,</span> <span class="n">sky_mtx_direct</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span> <span class="n">analemmaMtx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SkyCommands</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.get_commands_w_groups_daylight_coeff">
    <p>def <span class="ident">get_commands_w_groups_daylight_coeff</span>(</p><p>project_name, sky_density, project_folder, window_groups, skyfiles, inputfiles, points_file, total_point_count, rfluxmtx_parameters, reuse_daylight_mtx=False, total_count=1, radiation_only=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get commands for the static windows in the scene.</p>
<p>Use get_commands_w_groups_daylight_coeff to get the commands for the rest of the
scene.</p>
<p>Args:
    project_name: A string to generate uniqe file names for this project.
    sky_density: Sky density for this study.
    project_folder: Path to project_folder.
    window_groups: List of window_groups.
    skyfiles: Collection of path to sky files. The order must be (sky_mtx_total,
        sky_mtx_direct, analemma, sunlist, analemmaMtx). You can use get_commands_sky
        function to generate this list.
    inputfiles: Input files for this study. The order must be (opqfiles, glzfiles,
        wgsfiles, extrafiles). Each files object is a namedtuple which includes
        filepath to radiance files under fp and filepath to backed out files under
        fpblk.
    points_file: Path to points_file.
    total_point_count: Number of total points inside points_file.
    rfluxmtx_parameters: An instance of rfluxmtx_parameters for daylight matrix.
    reuse_daylight_mtx: A boolean not to include the commands for daylight matrix
        calculation if they already exist inside the folder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.get_commands_w_groups_daylight_coeff', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.get_commands_w_groups_daylight_coeff" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_commands_w_groups_daylight_coeff</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_groups</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span> <span class="n">inputfiles</span><span class="p">,</span>
        <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">total_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radiation_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for the static windows in the scene.</span>

<span class="sd">    Use get_commands_w_groups_daylight_coeff to get the commands for the rest of the</span>
<span class="sd">    scene.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name: A string to generate uniqe file names for this project.</span>
<span class="sd">        sky_density: Sky density for this study.</span>
<span class="sd">        project_folder: Path to project_folder.</span>
<span class="sd">        window_groups: List of window_groups.</span>
<span class="sd">        skyfiles: Collection of path to sky files. The order must be (sky_mtx_total,</span>
<span class="sd">            sky_mtx_direct, analemma, sunlist, analemmaMtx). You can use get_commands_sky</span>
<span class="sd">            function to generate this list.</span>
<span class="sd">        inputfiles: Input files for this study. The order must be (opqfiles, glzfiles,</span>
<span class="sd">            wgsfiles, extrafiles). Each files object is a namedtuple which includes</span>
<span class="sd">            filepath to radiance files under fp and filepath to backed out files under</span>
<span class="sd">            fpblk.</span>
<span class="sd">        points_file: Path to points_file.</span>
<span class="sd">        total_point_count: Number of total points inside points_file.</span>
<span class="sd">        rfluxmtx_parameters: An instance of rfluxmtx_parameters for daylight matrix.</span>
<span class="sd">        reuse_daylight_mtx: A boolean not to include the commands for daylight matrix</span>
<span class="sd">            calculation if they already exist inside the folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># unpack inputs</span>
    <span class="n">opqfiles</span><span class="p">,</span> <span class="n">glzfiles</span><span class="p">,</span> <span class="n">wgsfiles</span><span class="p">,</span> <span class="n">extrafiles</span> <span class="o">=</span> <span class="n">inputfiles</span>
    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">window_group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">window_groups</span><span class="p">):</span>
        <span class="c1"># get black material file</span>
        <span class="n">blkmaterial</span> <span class="o">=</span> <span class="p">[</span><span class="n">wgsfiles</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="c1"># add all the blacked window groups but the one in use</span>
        <span class="c1"># and finally add non-window group glazing as black</span>
        <span class="n">wgsblacked</span> <span class="o">=</span> \
            <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">fpblk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wgsfiles</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">count</span><span class="p">]</span> <span class="o">+</span> \
            <span class="nb">list</span><span class="p">(</span><span class="n">glzfiles</span><span class="o">.</span><span class="n">fpblk</span><span class="p">)</span>

        <span class="n">counter</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">state_count</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">window_groups</span><span class="p">[:</span><span class="n">count</span><span class="p">])</span>

        <span class="n">cmds</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_get_commands_daylight_coeff</span><span class="p">(</span>
            <span class="n">project_name</span><span class="p">,</span> <span class="n">sky_density</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">window_group</span><span class="p">,</span> <span class="n">skyfiles</span><span class="p">,</span>
            <span class="n">inputfiles</span><span class="p">,</span> <span class="n">points_file</span><span class="p">,</span> <span class="n">total_point_count</span><span class="p">,</span> <span class="n">blkmaterial</span><span class="p">,</span> <span class="n">wgsblacked</span><span class="p">,</span>
            <span class="n">rfluxmtx_parameters</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">window_groupfiles</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">reuse_daylight_mtx</span><span class="o">=</span><span class="n">reuse_daylight_mtx</span><span class="p">,</span> <span class="n">counter</span><span class="o">=</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">total_count</span><span class="p">),</span>
            <span class="n">radiation_only</span><span class="o">=</span><span class="n">radiation_only</span><span class="p">)</span>

        <span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cmds</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">commands</span><span class="p">,</span> <span class="n">results</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.image_based_view_coeff_matrix_commands">
    <p>def <span class="ident">image_based_view_coeff_matrix_commands</span>(</p><p>receiver, rad_files, sender, view_info_file, view_file, view_rays_file, rfluxmtx_parameters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns radiance commands to create coefficient matrix.</p>
<p>Args:
    receiver: A radiance file to indicate the receiver. In view matrix it will be the
    window group and in daylight matrix it will be the sky.
    rad_files: A collection of Radiance files that should be included in the scene.
    sender: A collection of files for senders if senders are radiance geometries
        such as window groups (Default: '-').
    points_file: Path to point file which will be used instead of sender.
    number_of_points: Number of points in points_file as an integer.
    sampling_rays_count: Number of sampling rays (Default: 1000).
    rfluxmtx_parameters: Radiance parameters for Rfluxmtx command using a
        RfluxmtxParameters instance (Default: None).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.image_based_view_coeff_matrix_commands', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.image_based_view_coeff_matrix_commands" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">image_based_view_coeff_matrix_commands</span><span class="p">(</span>
        <span class="n">receiver</span><span class="p">,</span> <span class="n">rad_files</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">view_info_file</span><span class="p">,</span> <span class="n">view_file</span><span class="p">,</span> <span class="n">view_rays_file</span><span class="p">,</span>
        <span class="n">rfluxmtx_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns radiance commands to create coefficient matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        receiver: A radiance file to indicate the receiver. In view matrix it will be the</span>
<span class="sd">        window group and in daylight matrix it will be the sky.</span>
<span class="sd">        rad_files: A collection of Radiance files that should be included in the scene.</span>
<span class="sd">        sender: A collection of files for senders if senders are radiance geometries</span>
<span class="sd">            such as window groups (Default: &#39;-&#39;).</span>
<span class="sd">        points_file: Path to point file which will be used instead of sender.</span>
<span class="sd">        number_of_points: Number of points in points_file as an integer.</span>
<span class="sd">        sampling_rays_count: Number of sampling rays (Default: 1000).</span>
<span class="sd">        rfluxmtx_parameters: Radiance parameters for Rfluxmtx command using a</span>
<span class="sd">            RfluxmtxParameters instance (Default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rflux</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="p">()</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">rfluxmtx_parameters</span> <span class="o">=</span> <span class="n">rfluxmtx_parameters</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">rad_files</span> <span class="o">=</span> <span class="n">rad_files</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span> <span class="ow">or</span> <span class="s1">&#39;-&#39;</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">receiver_file</span> <span class="o">=</span> <span class="n">receiver</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> <span class="s1">&#39;fc&#39;</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">view_info_file</span> <span class="o">=</span> <span class="n">view_info_file</span>
    <span class="n">rflux</span><span class="o">.</span><span class="n">view_rays_file</span> <span class="o">=</span> <span class="n">view_rays_file</span>

    <span class="k">return</span> <span class="n">rflux</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.image_based_view_matrix_calculation">
    <p>def <span class="ident">image_based_view_matrix_calculation</span>(</p><p>view, wg, state, sky_matrix, extention=&#39;&#39;, digits=3)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.image_based_view_matrix_calculation', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.image_based_view_matrix_calculation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">image_based_view_matrix_calculation</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">wg</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="p">,</span> <span class="n">extention</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                        <span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">Dctimestep</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">daylight_coeff_spec</span> <span class="o">=</span> \
            <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">dc</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="si">%%</span><span class="s1">0{}d_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">digits</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">daylight_coeff_spec</span> <span class="o">=</span> \
            <span class="s1">&#39;result</span><span class="se">\\</span><span class="s1">dc</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="s1">%0{}d_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">digits</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="n">dct</span><span class="o">.</span><span class="n">sky_vector_file</span> <span class="o">=</span> <span class="n">sky_matrix</span>

    <span class="c1"># sky matrix is annual</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">dctimestep_parameters</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> \
            <span class="s1">&#39; result</span><span class="se">\\</span><span class="s1">hdr</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="si">%%</span><span class="s1">04d_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">dctimestep_parameters</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> \
            <span class="s1">&#39; result</span><span class="se">\\</span><span class="s1">hdr</span><span class="se">\\</span><span class="s1">{}</span><span class="se">\\</span><span class="si">%04d</span><span class="s1">_{}..{}..{}.hdr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">extention</span><span class="p">,</span> <span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dct</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.image_based_view_sampling_commands">
    <p>def <span class="ident">image_based_view_sampling_commands</span>(</p><p>project_folder, view, view_file, vwrays_parameters)</p>
    </div>
    

    
  
    <div class="desc"><p>Return VWrays command for calculating view coefficient matrix.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.image_based_view_sampling_commands', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.image_based_view_sampling_commands" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">image_based_view_sampling_commands</span><span class="p">(</span>
        <span class="n">project_folder</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_file</span><span class="p">,</span> <span class="n">vwrays_parameters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return VWrays command for calculating view coefficient matrix.&quot;&quot;&quot;</span>
    <span class="c1"># calculate view dimensions</span>
    <span class="n">vwr_dim_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">project_folder</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;view</span><span class="se">\\</span><span class="s1">{}.dim&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_view_dimension</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vwr_dim_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">vdfile</span><span class="p">:</span>
        <span class="n">vdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-x </span><span class="si">%d</span><span class="s1"> -y </span><span class="si">%d</span><span class="s1"> -ld-</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="c1"># calculate sampling for each view</span>
    <span class="c1"># the value will be different for each view</span>
    <span class="n">vwrays_parameters</span><span class="o">.</span><span class="n">x_resolution</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">x_res</span>
    <span class="n">vwrays_parameters</span><span class="o">.</span><span class="n">y_resolution</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">y_res</span>

    <span class="n">vwr_samp</span> <span class="o">=</span> <span class="n">Vwrays</span><span class="p">()</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">vwrays_parameters</span> <span class="o">=</span> <span class="n">vwrays_parameters</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">view_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">view_file</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;view</span><span class="se">\\</span><span class="s1">{}.rays&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">vwr_samp</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>

    <span class="k">return</span> <span class="n">vwr_dim_file</span><span class="p">,</span> <span class="n">vwr_samp</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.imaged_based_sun_coeff_matrix_commands">
    <p>def <span class="ident">imaged_based_sun_coeff_matrix_commands</span>(</p><p>output_filename_format, view, view_rays_file, scene_files, analemma, sunlist)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.imaged_based_sun_coeff_matrix_commands', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.imaged_based_sun_coeff_matrix_commands" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">imaged_based_sun_coeff_matrix_commands</span><span class="p">(</span>
        <span class="n">output_filename_format</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_rays_file</span><span class="p">,</span> <span class="n">scene_files</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">):</span>
    <span class="c1"># output, point_file, scene_files, analemma, sunlist, irradiance_calc</span>

    <span class="n">octree</span> <span class="o">=</span> <span class="n">Oconv</span><span class="p">()</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">scene_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scene_files</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">analemma</span><span class="p">]</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;analemma.oct&#39;</span>

    <span class="c1"># Creating sun coefficients</span>
    <span class="c1"># -ab 0 -i -ffc -dj 0 -dc 1 -dt 0</span>
    <span class="n">rctb_param</span> <span class="o">=</span> <span class="n">get_radiance_parameters_image_based</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">smtx</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">x_dimension</span><span class="p">,</span> <span class="n">rctb_param</span><span class="o">.</span><span class="n">y_dimension</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_view_dimension</span><span class="p">()</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">mod_file</span> <span class="o">=</span> <span class="n">sunlist</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">output_data_format</span> <span class="o">=</span> <span class="s1">&#39;fc&#39;</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">irradiance_calc</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># -I</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">i_irradiance_calc</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c1"># -i</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">output_filename_format</span> <span class="o">=</span> <span class="n">output_filename_format</span>

    <span class="n">rctb</span> <span class="o">=</span> <span class="n">Rcontrib</span><span class="p">()</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">octree_file</span> <span class="o">=</span> <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">points_file</span> <span class="o">=</span> <span class="n">view_rays_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">rcontrib_parameters</span> <span class="o">=</span> <span class="n">rctb_param</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">octree</span><span class="p">,</span> <span class="n">rctb</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.matrix_calculation">
    <p>def <span class="ident">matrix_calculation</span>(</p><p>output, v_matrix=None, t_matrix=None, d_matrix=None, sky_matrix=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get commands for matrix calculation.</p>
<p>This method sets up a matrix calculations using Dctimestep.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.matrix_calculation', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.matrix_calculation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">matrix_calculation</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">v_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">t_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">d_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for matrix calculation.</span>

<span class="sd">    This method sets up a matrix calculations using Dctimestep.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">Dctimestep</span><span class="p">()</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">tmatrix_file</span> <span class="o">=</span> <span class="n">t_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">vmatrix_spec</span> <span class="o">=</span> <span class="n">v_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">dmatrix_file</span> <span class="o">=</span> <span class="n">d_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">sky_vector_file</span> <span class="o">=</span> <span class="n">sky_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>
    <span class="k">return</span> <span class="n">dct</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.rgb_matrix_file_to_ill">
    <p>def <span class="ident">rgb_matrix_file_to_ill</span>(</p><p>input, output)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert rgb values in matrix to illuminance values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.rgb_matrix_file_to_ill', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.rgb_matrix_file_to_ill" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rgb_matrix_file_to_ill</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert rgb values in matrix to illuminance values.&quot;&quot;&quot;</span>
    <span class="n">finalmtx</span> <span class="o">=</span> <span class="n">Rmtxop</span><span class="p">(</span><span class="n">matrix_files</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
    <span class="n">finalmtx</span><span class="o">.</span><span class="n">rmtxop_parameters</span><span class="o">.</span><span class="n">output_format</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
    <span class="n">finalmtx</span><span class="o">.</span><span class="n">rmtxop_parameters</span><span class="o">.</span><span class="n">combine_values</span> <span class="o">=</span> <span class="p">(</span><span class="mf">47.4</span><span class="p">,</span> <span class="mf">119.9</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">)</span>
    <span class="n">finalmtx</span><span class="o">.</span><span class="n">rmtxop_parameters</span><span class="o">.</span><span class="n">transpose_matrix</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="n">finalmtx</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.sky_receiver">
    <p>def <span class="ident">sky_receiver</span>(</p><p>filepath, density, ground_file_format=None, sky_file_format=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a receiver sky for daylight coefficient studies.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.sky_receiver', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.sky_receiver" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sky_receiver</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">ground_file_format</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sky_file_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a receiver sky for daylight coefficient studies.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ground_file_format</span> <span class="ow">and</span> <span class="n">sky_file_format</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">default_sky_ground</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">sky_type</span><span class="o">=</span><span class="s1">&#39;r{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">density</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">default_sky_ground</span><span class="p">(</span>
            <span class="n">filepath</span><span class="p">,</span> <span class="n">sky_type</span><span class="o">=</span><span class="s1">&#39;r{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">density</span><span class="p">),</span>
            <span class="n">ground_file_format</span><span class="o">=</span><span class="n">ground_file_format</span><span class="p">,</span>
            <span class="n">sky_file_format</span><span class="o">=</span><span class="n">sky_file_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.skymtx_to_gendaymtx">
    <p>def <span class="ident">skymtx_to_gendaymtx</span>(</p><p>sky_matrix, target_folder)</p>
    </div>
    

    
  
    <div class="desc"><p>Return gendaymtx command based on input sky_matrix.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.skymtx_to_gendaymtx', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.skymtx_to_gendaymtx" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">skymtx_to_gendaymtx</span><span class="p">(</span><span class="n">sky_matrix</span><span class="p">,</span> <span class="n">target_folder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return gendaymtx command based on input sky_matrix.&quot;&quot;&quot;</span>
    <span class="n">wea_filepath</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.wea&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sky_mtx</span> <span class="o">=</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.smx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">hours_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="s1">&#39;sky</span><span class="se">\\</span><span class="s1">{}.hrs&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sky_matrix</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="n">sky_mtx</span><span class="p">))</span> \
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="n">wea_filepath</span><span class="p">))</span> \
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">hours_match</span><span class="p">(</span><span class="n">hours_file</span><span class="p">):</span>
        <span class="c1"># write wea file to folder</span>
        <span class="n">sky_matrix</span><span class="o">.</span><span class="n">write_wea</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_folder</span><span class="p">,</span> <span class="s1">&#39;sky&#39;</span><span class="p">),</span> <span class="n">write_hours</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">gdm</span> <span class="o">=</span> <span class="n">Gendaymtx</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="n">sky_mtx</span><span class="p">,</span> <span class="n">wea_file</span><span class="o">=</span><span class="n">wea_filepath</span><span class="p">)</span>
        <span class="n">gdm</span><span class="o">.</span><span class="n">gendaymtx_parameters</span> <span class="o">=</span> <span class="n">sky_matrix</span><span class="o">.</span><span class="n">sky_matrix_parameters</span>
        <span class="k">return</span> <span class="n">gdm</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.sun_coeff_matrix_commands">
    <p>def <span class="ident">sun_coeff_matrix_commands</span>(</p><p>output, point_file, scene_files, analemma, sunlist, irradiance_calc)</p>
    </div>
    

    
  
    <div class="desc"><p>Return commands for calculating analemma coefficient.</p>
<p>Args:
    output: Output daylight coefficient file (e.g. suncoeff.dc).
    point_file: Path to point / analysis grid file. In case of multiple grid
        put them together in a single file.
    scene_files: A list fo scene files. Usually black scene.
    analemma: Path to analemma file. You can generate analemma file using
        sun_matrix class. Analemma has list of sun positions with their respective
        values.
    sunlist: Path to sunlist. Use sun_matrix to generate sunlist.
    simulation_type:
Returns:
    octree and rcontrib commands ready to be executed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.sun_coeff_matrix_commands', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.sun_coeff_matrix_commands" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sun_coeff_matrix_commands</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">point_file</span><span class="p">,</span> <span class="n">scene_files</span><span class="p">,</span> <span class="n">analemma</span><span class="p">,</span> <span class="n">sunlist</span><span class="p">,</span>
                              <span class="n">irradiance_calc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return commands for calculating analemma coefficient.</span>

<span class="sd">    Args:</span>
<span class="sd">        output: Output daylight coefficient file (e.g. suncoeff.dc).</span>
<span class="sd">        point_file: Path to point / analysis grid file. In case of multiple grid</span>
<span class="sd">            put them together in a single file.</span>
<span class="sd">        scene_files: A list fo scene files. Usually black scene.</span>
<span class="sd">        analemma: Path to analemma file. You can generate analemma file using</span>
<span class="sd">            sun_matrix class. Analemma has list of sun positions with their respective</span>
<span class="sd">            values.</span>
<span class="sd">        sunlist: Path to sunlist. Use sun_matrix to generate sunlist.</span>
<span class="sd">        simulation_type:</span>
<span class="sd">    Returns:</span>
<span class="sd">        octree and rcontrib commands ready to be executed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">octree</span> <span class="o">=</span> <span class="n">Oconv</span><span class="p">()</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">scene_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scene_files</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">analemma</span><span class="p">]</span>
    <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;analemma.oct&#39;</span>

    <span class="c1"># Creating sun coefficients</span>
    <span class="n">rctb_param</span> <span class="o">=</span> <span class="n">get_radiance_parameters_grid_based</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">smtx</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">mod_file</span> <span class="o">=</span> <span class="n">sunlist</span>
    <span class="n">rctb_param</span><span class="o">.</span><span class="n">irradiance_calc</span> <span class="o">=</span> <span class="n">irradiance_calc</span>

    <span class="n">rctb</span> <span class="o">=</span> <span class="n">Rcontrib</span><span class="p">()</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">octree_file</span> <span class="o">=</span> <span class="n">octree</span><span class="o">.</span><span class="n">output_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">points_file</span> <span class="o">=</span> <span class="n">point_file</span>
    <span class="n">rctb</span><span class="o">.</span><span class="n">rcontrib_parameters</span> <span class="o">=</span> <span class="n">rctb_param</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">octree</span><span class="p">,</span> <span class="n">rctb</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.sun_matrix_calculation">
    <p>def <span class="ident">sun_matrix_calculation</span>(</p><p>output, dc_matrix=None, sky_matrix=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get commands for sun matrix calculation.</p>
<p>This method sets up a matrix calculations using Dctimestep.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.sun_matrix_calculation', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.sun_matrix_calculation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sun_matrix_calculation</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dc_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sky_matrix</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get commands for sun matrix calculation.</span>

<span class="sd">    This method sets up a matrix calculations using Dctimestep.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">Dctimestep</span><span class="p">()</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">daylight_coeff_spec</span> <span class="o">=</span> <span class="n">dc_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">sky_vector_file</span> <span class="o">=</span> <span class="n">sky_matrix</span>
    <span class="n">dct</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">output</span>
    <span class="k">return</span> <span class="n">dct</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.window_group_to_receiver">
    <p>def <span class="ident">window_group_to_receiver</span>(</p><p>filepath, upnormal, material_name=&#39;vmtx_glow&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Take a filepath to a window group and create a receiver.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.window_group_to_receiver', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.window_group_to_receiver" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">window_group_to_receiver</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">upnormal</span><span class="p">,</span> <span class="n">material_name</span><span class="o">=</span><span class="s1">&#39;vmtx_glow&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take a filepath to a window group and create a receiver.&quot;&quot;&quot;</span>
    <span class="n">rec_ctrl_par</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">control_parameters</span><span class="p">(</span>
        <span class="n">hemi_type</span><span class="o">=</span><span class="s1">&#39;kf&#39;</span><span class="p">,</span> <span class="n">hemi_up_direction</span><span class="o">=</span><span class="n">upnormal</span><span class="p">)</span>
    <span class="n">wg_m</span> <span class="o">=</span> <span class="n">Rfluxmtx</span><span class="o">.</span><span class="n">add_control_parameters</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">{</span><span class="n">material_name</span><span class="p">:</span> <span class="n">rec_ctrl_par</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">wg_m</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.recipedcutil.write_rad_files_daylight_coeff">
    <p>def <span class="ident">write_rad_files_daylight_coeff</span>(</p><p>working_dir, project_name, opq, glz, wgs)</p>
    </div>
    

    
  
    <div class="desc"><p>Write files to a target directory for daylight coefficeint method.</p>
<p>The files will be written under
    working_dir/opaque
    working_dir/glazing
    working_dir/wgroup</p>
<p>Args:
    working_dir: Path to working directory.
    opq: A RadFile for opaque surfaces.
    glz: A RadFile for glazing surfaces.
    wgs: A collection of RadFiles for window-groups.</p>
<p>Returns:
    A named tuple for each RadFile as (fp, fpblk)
    fp returns the file path to the list of radiance files.
    fpblk returns the file path to the list of blacked radiance files.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.recipedcutil.write_rad_files_daylight_coeff', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.recipedcutil.write_rad_files_daylight_coeff" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">write_rad_files_daylight_coeff</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">opq</span><span class="p">,</span> <span class="n">glz</span><span class="p">,</span> <span class="n">wgs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write files to a target directory for daylight coefficeint method.</span>

<span class="sd">    The files will be written under</span>
<span class="sd">        working_dir/opaque</span>
<span class="sd">        working_dir/glazing</span>
<span class="sd">        working_dir/wgroup</span>

<span class="sd">    Args:</span>
<span class="sd">        working_dir: Path to working directory.</span>
<span class="sd">        opq: A RadFile for opaque surfaces.</span>
<span class="sd">        glz: A RadFile for glazing surfaces.</span>
<span class="sd">        wgs: A collection of RadFiles for window-groups.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A named tuple for each RadFile as (fp, fpblk)</span>
<span class="sd">        fp returns the file path to the list of radiance files.</span>
<span class="sd">        fpblk returns the file path to the list of blacked radiance files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Files</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Files&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span> <span class="s1">&#39;fpblk&#39;</span><span class="p">])</span>

    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="s1">&#39;opaque&#39;</span><span class="p">)</span>
    <span class="n">of</span> <span class="o">=</span> <span class="n">opq</span><span class="o">.</span><span class="n">write_geometries</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..opq.rad&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">om</span> <span class="o">=</span> <span class="n">opq</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..opq.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">bm</span> <span class="o">=</span> <span class="n">opq</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..blk.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">opqf</span> <span class="o">=</span> <span class="n">Files</span><span class="p">((</span><span class="n">om</span><span class="p">,</span> <span class="n">of</span><span class="p">),</span> <span class="p">(</span><span class="n">bm</span><span class="p">,</span> <span class="n">of</span><span class="p">))</span>

    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="s1">&#39;glazing&#39;</span><span class="p">)</span>
    <span class="n">ogf</span> <span class="o">=</span> <span class="n">glz</span><span class="o">.</span><span class="n">write_geometries</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..glz.rad&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ogm</span> <span class="o">=</span> <span class="n">glz</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..glz.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">bgm</span> <span class="o">=</span> <span class="n">glz</span><span class="o">.</span><span class="n">write_materials</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..blk.mat&#39;</span> <span class="o">%</span> <span class="n">project_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">blacked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">glzf</span> <span class="o">=</span> <span class="n">Files</span><span class="p">((</span><span class="n">ogm</span><span class="p">,</span> <span class="n">ogf</span><span class="p">),</span> <span class="p">(</span><span class="n">bgm</span><span class="p">,</span> <span class="n">ogf</span><span class="p">))</span>

    <span class="n">wgfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="s1">&#39;wgroup&#39;</span><span class="p">)</span>
    <span class="c1"># write black material to folder</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">wgf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wgs</span><span class="p">):</span>
        <span class="c1"># write it as a black geometry</span>
        <span class="n">wg</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">hb_surfaces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">wg</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">wgbm</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">write_black_material</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;black.mat&#39;</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">wgbf</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">write_geometries_blacked</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..blk.rad&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># write files for each state</span>
        <span class="n">wgfstate</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">scount</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
            <span class="n">wg</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">scount</span>
            <span class="n">wgfst</span> <span class="o">=</span> <span class="n">wgf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">..</span><span class="si">%s</span><span class="s1">.rad&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">wgfstate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wgfst</span><span class="p">)</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># set the state back to 0</span>
        <span class="n">wgfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Files</span><span class="p">(</span><span class="n">wgfstate</span><span class="p">,</span> <span class="p">(</span><span class="n">wgbm</span><span class="p">,</span> <span class="n">wgbf</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">opqf</span><span class="p">,</span> <span class="n">glzf</span><span class="p">,</span> <span class="n">wgfs</span>
</pre></div>

  </div>
</div>

  </div>
  


  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>
  </footer>
</div>
</body>
</html>