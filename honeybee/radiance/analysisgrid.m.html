<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>honeybee.radiance.analysisgrid API documentation</title>
    <meta name="description" content="Honeybee PointGroup and TestPointGroup." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 0.9em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    margin-left: 25%;
    max-width: 90%;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    position: fixed;
    height: 100%;
    width: 25%;
    float: left;
    padding: 30px;
    overflow: auto;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  .desc {
    white-space: pre-wrap;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      position: inherit;
      float: none;
      width: auto;
    }
    #content {
      width: 95%;
      margin-left: auto;
      border-left: none;
      padding: 30px;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid">AnalysisGrid</a></span>
        
          
  <ul>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.__init__">__init__</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.ToString">ToString</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.add_result_files">add_result_files</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.annual_metrics">annual_metrics</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.annual_solar_exposure">annual_solar_exposure</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.combined_value_by_id">combined_value_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.combined_values_by_id">combined_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.duplicate">duplicate</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.from_file">from_file</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.from_points_and_vectors">from_points_and_vectors</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.load_values_from_files">load_values_from_files</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.max_values_by_id">max_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.parse_blind_states">parse_blind_states</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.parse_header">parse_header</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.set_coupled_values_from_file">set_coupled_values_from_file</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.set_values">set_values</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.set_values_from_file">set_values_from_file</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.spatial_daylight_autonomy">spatial_daylight_autonomy</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.sum_values_by_id">sum_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.to_rad_string">to_rad_string</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.AnalysisGrid.unload">unload</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#honeybee.radiance.analysisgrid.EmptyFileError">EmptyFileError</a></span>
        
          
  <ul>
    <li class="mono"><a href="#honeybee.radiance.analysisgrid.EmptyFileError.__init__">__init__</a></li>
  </ul>

        </li>
      </ul>
    </li>

    
    <li class="set"><h3>Module Index :: <a href="../../honeybee/index.html">honeybee</a></h3>
    
    <ul>
      <li class="mono"><a href="../../honeybee/config.m.html">config</a></li>
      

      <li class="mono"><a href="../../honeybee/dataoperation.m.html">dataoperation</a></li>
      

      <li class="mono"><a href="../../honeybee/energyplus/index.html">energyplus</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/energyplus/filemanager.m.html">filemanager</a></li>
      

      <li class="mono"><a href="../../honeybee/energyplus/geometryrules.m.html">geometryrules</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/futil.m.html">futil</a></li>
      

      <li class="mono"><a href="../../honeybee/geometryoperation.m.html">geometryoperation</a></li>
      

      <li class="mono"><a href="../../honeybee/hbdynamicsurface.m.html">hbdynamicsurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbfensurface.m.html">hbfensurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbobject.m.html">hbobject</a></li>
      

      <li class="mono"><a href="../../honeybee/hbshadesurface.m.html">hbshadesurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbsurface.m.html">hbsurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbzone.m.html">hbzone</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/index.html">radiance</a></li>
      
    <ul>
      <li class="mono"><a href="">analysisgrid</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/analysispoint.m.html">analysispoint</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/index.html">command</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/command/dctimestep.m.html">dctimestep</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/epw2wea.m.html">epw2wea</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/falsecolor.m.html">falsecolor</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/genBSDF.m.html">genBSDF</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/gendaymtx.m.html">gendaymtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/gensky.m.html">gensky</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/genskyvec.m.html">genskyvec</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/getbbox.m.html">getbbox</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/getinfo.m.html">getinfo</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/objview.m.html">objview</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/oconv.m.html">oconv</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/pcomb.m.html">pcomb</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/index.html">pyRad</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/objview.m.html">objview</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/pyRadLib/index.html">pyRadLib</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/pyRadLib/pyrad_proc.m.html">pyrad_proc</a></li>
      

    </ul>

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/command/raBmp.m.html">raBmp</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/raTiff.m.html">raTiff</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rcalc.m.html">rcalc</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rcollate.m.html">rcollate</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rcontrib.m.html">rcontrib</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rfluxmtx.m.html">rfluxmtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rmtxop.m.html">rmtxop</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rpict.m.html">rpict</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rtrace.m.html">rtrace</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/vwrays.m.html">vwrays</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/xform.m.html">xform</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/datatype.m.html">datatype</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/filemanager.m.html">filemanager</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/geometry.m.html">geometry</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/imagecollection.m.html">imagecollection</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/index.html">material</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/material/bsdf.m.html">bsdf</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/custom.m.html">custom</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/glass.m.html">glass</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/glow.m.html">glow</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/light.m.html">light</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/metal.m.html">metal</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/plastic.m.html">plastic</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/parameters/index.html">parameters</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/parameters/dctimestep.m.html">dctimestep</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/falsecolor.m.html">falsecolor</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/genBsdf.m.html">genBsdf</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gendaymtx.m.html">gendaymtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gensky.m.html">gensky</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/imagebased.m.html">imagebased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/oconv.m.html">oconv</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/pcomb.m.html">pcomb</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/raBmp.m.html">raBmp</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/raTiff.m.html">raTiff</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rcalc.m.html">rcalc</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rcollate.m.html">rcollate</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rcontrib.m.html">rcontrib</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rfluxmtx.m.html">rfluxmtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rmtxop.m.html">rmtxop</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/vwrays.m.html">vwrays</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/xform.m.html">xform</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/properties.m.html">properties</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/radfile.m.html">radfile</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/index.html">recipe</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/annual/index.html">annual</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/annual/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightcoeff/index.html">daylightcoeff</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightcoeff/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightcoeff/imagebased.m.html">imagebased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightfactor/index.html">daylightfactor</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightfactor/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/fivephase/index.html">fivephase</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/fivephase/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/parameters.m.html">parameters</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/pointintime/index.html">pointintime</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/pointintime/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/pointintime/imagebased.m.html">imagebased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/radiation/index.html">radiation</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/radiation/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/recipedcutil.m.html">recipedcutil</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/recipeutil.m.html">recipeutil</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/recipexphaseutil.m.html">recipexphaseutil</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/solaraccess/index.html">solaraccess</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/solaraccess/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/threephase/index.html">threephase</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/threephase/gridbased.m.html">gridbased</a></li>
      

    </ul>

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/runmanager.m.html">runmanager</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/scene.m.html">scene</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/index.html">sky</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/sky/certainIlluminance.m.html">certainIlluminance</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/cie.m.html">cie</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/climatebased.m.html">climatebased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/skymatrix.m.html">skymatrix</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/skyvector.m.html">skyvector</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/sunmatrix.m.html">sunmatrix</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/view.m.html">view</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/room.m.html">room</a></li>
      

      <li class="mono"><a href="../../honeybee/schedule.m.html">schedule</a></li>
      

      <li class="mono"><a href="../../honeybee/surfaceproperties.m.html">surfaceproperties</a></li>
      

      <li class="mono"><a href="../../honeybee/surfacetype.m.html">surfacetype</a></li>
      

      <li class="mono"><a href="../../honeybee/utilcol.m.html">utilcol</a></li>
      

      <li class="mono"><a href="../../honeybee/vectormath/index.html">vectormath</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/vectormath/euclid.m.html">euclid</a></li>
      

    </ul>

    </ul>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">honeybee.radiance.analysisgrid</span> module</h1>
  <p>Honeybee PointGroup and TestPointGroup.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;Honeybee PointGroup and TestPointGroup.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">..utilcol</span> <span class="kn">import</span> <span class="n">random_name</span>
<span class="kn">from</span> <span class="nn">..dataoperation</span> <span class="kn">import</span> <span class="n">match_data</span>
<span class="kn">from</span> <span class="nn">..schedule</span> <span class="kn">import</span> <span class="n">Schedule</span>
<span class="kn">from</span> <span class="nn">.analysispoint</span> <span class="kn">import</span> <span class="n">AnalysisPoint</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span><span class="p">,</span> <span class="n">OrderedDict</span>


<span class="k">class</span> <span class="nc">EmptyFileError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exception for trying to load results from an empty file.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Failed to load the results form an empty file: {}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="s1">&#39;Double check inputs and outputs and make sure &#39;</span> \
                <span class="s1">&#39;everything is run correctly.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EmptyFileError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">AnalysisGrid</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A grid of analysis points.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        analysis_points: A collection of analysis points.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_analysis_points&#39;</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;_sources&#39;</span><span class="p">,</span> <span class="s1">&#39;_wgroups&#39;</span><span class="p">,</span> <span class="s1">&#39;_directFiles&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_totalFiles&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis_points</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">window_groups</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a AnalysisPointGroup.</span>

<span class="sd">        analysis_points: A collection of AnalysisPoints.</span>
<span class="sd">        name: A unique name for this AnalysisGrid.</span>
<span class="sd">        window_groups: A collection of window_groups which contribute to this grid.</span>
<span class="sd">            This input is only meaningful in studies such as daylight coefficient</span>
<span class="sd">            and multi-phase studies that the contribution of each source will be</span>
<span class="sd">            calculated separately (default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># name of sources and their state. It&#39;s only meaningful in multi-phase daylight</span>
        <span class="c1"># analysis. In analysis for a single time it will be {None: [None]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">window_groups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">window_groups</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="p">()</span>

        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="n">analysis_points</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="s1">&#39;_dir&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;{} is not an AnalysisPoint.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span> <span class="o">=</span> <span class="n">analysis_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of results files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of results files</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_points_and_vectors</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">window_groups</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysis grid from points and vectors.</span>

<span class="sd">        Args:</span>
<span class="sd">            points: A flatten list of (x, y ,z) points.</span>
<span class="sd">            vectors: An optional list of (x, y, z) for direction of test points.</span>
<span class="sd">                If not provided a (0, 0, 1) vector will be assigned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="n">vectors</span> <span class="ow">or</span> <span class="p">()</span>
        <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">match_data</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">aps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">AnalysisPoint</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">aps</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">window_groups</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysis grid from a pts file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full path to points file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">AnalysisPoint</span>  <span class="c1"># load analysis point locally for better performance</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="n">points</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">fromraw_values</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">inf</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_analysis_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True for AnalysisGrid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AnalysisGrid name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@name.setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">random_name</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A list of window group names that are related to this analysis grid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span>

    <span class="nd">@window_groups.setter</span>
    <span class="k">def</span> <span class="nf">window_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wgs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">wgs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A generator of points as x, y, z.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">location</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get generator of vectors as x, y , z.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">direction</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">analysis_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of analysis points.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sorted list fo sources.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sources</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">srcs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">srcs</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">name</span>
                <span class="k">return</span> <span class="n">srcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if this analysis grid has result values.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">has_values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if direct values are available for this point.</span>

<span class="sd">        In point-in-time and 3phase recipes only total values are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">has_direct_values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hoys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return hours of the year for results if any.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hoys</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_results_point_in_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the grid has the results only for an hour.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hoys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">result_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return result files as a list [[total files], [direct files]].&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span>

    <span class="k">def</span> <span class="nf">add_result_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                         <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add new result files to grid.</span>

<span class="sd">        Use this methods if you want to get annual metrics without loading the values</span>
<span class="sd">        for each point. This method is only useful for cases with no window groups and</span>
<span class="sd">        dynamic blind states. After adding the files you can call &#39;annualMetrics&#39; method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultFile</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
            <span class="s1">&#39;ResultFile&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;hoys&#39;</span><span class="p">,</span> <span class="s1">&#39;start_line&#39;</span><span class="p">,</span> <span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">))</span>

        <span class="n">inf</span> <span class="o">=</span> <span class="n">ResultFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="k">pass</span>
        <span class="c1"># assign the values to points</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
                <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse radiance matrix header.&quot;&quot;&quot;</span>
        <span class="c1"># read the header</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FORMAT&#39;</span><span class="p">:</span>
                <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>  <span class="c1"># pass empty line</span>
                <span class="k">break</span>  <span class="c1"># done with the header!</span>
            <span class="k">elif</span> <span class="n">start_line</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NROWS&#39;</span><span class="p">:</span>
                <span class="n">points_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">check_point_count</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span> <span class="o">==</span> <span class="n">points_count</span><span class="p">,</span> \
                        <span class="s2">&quot;Length of points [{}] must match the number &quot;</span> \
                        <span class="s2">&quot;of rows [{}].&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">),</span> <span class="n">points_count</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">start_line</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NCOLS&#39;</span><span class="p">:</span>
                <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">hoys</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">hours_count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                        <span class="s2">&quot;Number of hours [{}] must match the &quot;</span> \
                        <span class="s2">&quot;number of columns [{}].&quot;</span> \
                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> <span class="n">hours_count</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hoys</span> <span class="o">=</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hours_count</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span>

    <span class="k">def</span> <span class="nf">set_values_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                             <span class="n">check_point_count</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load values for test points from a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full file path to the result file.</span>
<span class="sd">            hoys: A collection of hours of the year for the results. If None the</span>
<span class="sd">                default will be range(0, len(results)).</span>
<span class="sd">            source: Name of the source.</span>
<span class="sd">            state: Name of the state.</span>
<span class="sd">            start_line: Number of start lines after the header from 0 (default: 0).</span>
<span class="sd">            is_direct: A Boolean to declare if the results is direct illuminance</span>
<span class="sd">                (default: False).</span>
<span class="sd">            header: A Boolean to declare if the file has header (default: True).</span>
<span class="sd">            mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value</span>
<span class="sd">                will be 1. This is useful for studies such as sunlight hours. 2 &gt;</span>
<span class="sd">                load the values divided by mode number. Use this mode for daylight</span>
<span class="sd">                factor or radiation analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

            <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># binary 0-1</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># divide values by mode (useful for daylight factor calculation)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

            <span class="c1"># assign the values to points</span>
            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
                    <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_coupled_values_from_file</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">total_file_path</span><span class="p">,</span> <span class="n">direct_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load direct and total values for test points from two files.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full file path to the result file.</span>
<span class="sd">            hoys: A collection of hours of the year for the results. If None the</span>
<span class="sd">                default will be range(0, len(results)).</span>
<span class="sd">            source: Name of the source.</span>
<span class="sd">            state: Name of the state.</span>
<span class="sd">            start_line: Number of start lines after the header from 0 (default: 0).</span>
<span class="sd">            header: A Boolean to declare if the file has header (default: True).</span>
<span class="sd">            mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value</span>
<span class="sd">                will be 1. This is useful for studies such as sunlight hours. 2 &gt;</span>
<span class="sd">                load the values divided by mode number. Use this mode for daylight</span>
<span class="sd">                factor or radiation analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="n">direct_file_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">direct_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dinf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>
                <span class="n">dinf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">dinf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">direct_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

            <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span>
                          <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># binary 0-1</span>
                <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span>
                    <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)),</span>
                     <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)))</span>
                    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># divide values by mode (useful for daylight factor calculation)</span>
                <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span>
                          <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

            <span class="c1"># assign the values to points</span>
            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coupled_values</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_coupled_values</span><span class="p">(</span>
                    <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">combined_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoy: hour of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            total, direct values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">combined_value_by_id</span><span class="p">(</span><span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">combined_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_ids.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a generator for (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">combined_value_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sum_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sum of value for all the hours.</span>

<span class="sd">        This method is mostly useful for radiation and solar access analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a collection of sum values as (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">sum_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">max_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get maximum value for all the hours.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a tuple for sum of (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">max_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">annual_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate annual metrics.</span>

<span class="sd">        Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</span>

<span class="sd">        Args:</span>
<span class="sd">            da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">            udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">                (default: (100, 3000)).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,</span>
<span class="sd">            Less than UDI, More than UDI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No values are assigned to this analysis grid.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="c1"># results are not loaded but are available</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                    <span class="s1">&#39;a single merged result file.&#39;</span>
            <span class="p">)</span>
            <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[])</span>

        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
        <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">annual_metrics</span><span class="p">(</span><span class="n">da_threshhold</span><span class="p">,</span>
                                                            <span class="n">udi_min_max</span><span class="p">,</span>
                                                            <span class="n">blinds_state_ids</span><span class="p">,</span>
                                                            <span class="n">occ_schedule</span>
                                                            <span class="p">)):</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This is a method for annual recipe to load the results line by line</span>
            <span class="c1"># which unlike the other method doesn&#39;t load all the values to the memory</span>
            <span class="c1"># at once.</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="n">calculate_annual_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_calculate_annual_metrics</span>

            <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>

                <span class="c1"># read the results line by line and caluclate the values</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                    <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                        <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                        <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                        <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

                    <span class="c1"># load one line at a time</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
                        <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                            <span class="n">calculate_annual_metrics</span><span class="p">(</span>
                                <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="p">,</span>
                                <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">)):</span>

                            <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">spatial_daylight_autonomy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                  <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_area</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate Spatial Daylight Autonomy (sDA).</span>

<span class="sd">        Args:</span>
<span class="sd">            target_area: Minimum target area percentage for this grid (default: 50)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No values are assigned to this analysis grid.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="c1"># results are not loaded but are available</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                    <span class="s1">&#39;a single merged result file.&#39;</span>
            <span class="p">)</span>
            <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>

        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

            <span class="c1"># get the annual results for each sensor</span>
            <span class="n">hourly_results</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">sensor</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>

                <span class="c1"># read the results line by line and caluclate the values</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                    <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                        <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                        <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                        <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
                    <span class="n">hourly_results</span> <span class="o">=</span> \
                        <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="bp">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                              <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

        <span class="c1"># iterate through the results</span>
        <span class="c1"># find minimum number of points to meet the target_area</span>
        <span class="n">target_area</span> <span class="o">=</span> <span class="n">target_area</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="ow">or</span> \
            <span class="mf">0.50</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">)</span>
        <span class="c1"># change target area to an integer to enhance the performance in the loop</span>
        <span class="n">target</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span><span class="p">)</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span><span class="p">)</span> <span class="o">!=</span> <span class="n">target_area</span> \
            <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">met_hours</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">hr</span><span class="p">,</span> <span class="n">hrv</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="n">hourly_results</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">hr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">occ_schedule</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">da_threshhold</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">hrv</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">target</span><span class="p">:</span>
                <span class="n">met_hours</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">met_hours</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">occ_schedule</span><span class="o">.</span><span class="n">occupied_hours</span><span class="p">),</span> <span class="n">problematic_hours</span>

    <span class="k">def</span> <span class="nf">annual_solar_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_area</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Annual Solar Exposure (ASE)</span>

<span class="sd">        As per IES-LM-83-12 ase is the percent of sensors that are</span>
<span class="sd">        found to be exposed to more than 1000lux of direct sunlight for</span>
<span class="sd">        more than 250hrs per year. For LEED credits No more than 10% of</span>
<span class="sd">        the points in the grid should fail this measure.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshhold: Threshhold for for solar exposure in lux (default: 1000).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys.</span>
<span class="sd">                If you want a source to be removed set the state to -1. ase must</span>
<span class="sd">                be calculated without dynamic blinds but you can use this option</span>
<span class="sd">                to study the effect of different blind states.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>
<span class="sd">            target_hours: Minimum targe hours for each point (default: 250).</span>
<span class="sd">            target_area: Minimum target area percentage for this grid (default: 10)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Success as a Boolean, ase values for each point, Percentage area,</span>
<span class="sd">            Problematic points, Problematic hours for each point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Direct values are not available to calculate ASE.</span><span class="se">\n</span><span class="s1">In most of the cases&#39;</span>
                <span class="s1">&#39; this is because you are using a point in time recipe or the three-&#39;</span>
                <span class="s1">&#39;phase recipe. You should use one of the daylight coefficient based &#39;</span>
                <span class="s1">&#39;recipes or the 5 phase recipe instead.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span><span class="p">:</span>
            <span class="c1"># results are not loaded but are available</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                    <span class="s1">&#39;a single merged result file.&#39;</span>
            <span class="p">)</span>
            <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[])</span>
        <span class="n">threshhold</span> <span class="o">=</span> <span class="n">threshhold</span> <span class="ow">or</span> <span class="mi">1000</span>
        <span class="n">target_hours</span> <span class="o">=</span> <span class="n">target_hours</span> <span class="ow">or</span> <span class="mi">250</span>
        <span class="n">target_area</span> <span class="o">=</span> <span class="n">target_area</span> <span class="ow">or</span> <span class="mi">10</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">annual_solar_exposure</span><span class="p">(</span><span class="n">threshhold</span><span class="p">,</span>
                                                                   <span class="n">blinds_state_ids</span><span class="p">,</span>
                                                                   <span class="n">occ_schedule</span><span class="p">,</span>
                                                                   <span class="n">target_hours</span>
                                                                   <span class="p">)):</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This is a method for annual recipe to load the results line by line</span>
            <span class="c1"># which unlike the other method doesn&#39;t load all the values to the memory</span>
            <span class="c1"># at once.</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="n">calculate_annual_solar_exposure</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_calculate_annual_solar_exposure</span>

            <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>

                <span class="c1"># read the results line by line and caluclate the values</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                    <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                        <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                        <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                        <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

                    <span class="c1"># load one line at a time</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
                        <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                            <span class="n">calculate_annual_solar_exposure</span><span class="p">(</span>
                                <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">,</span>
                                <span class="n">target_hours</span><span class="p">)):</span>

                            <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="c1"># calculate ase for the grid</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span>  <span class="c1"># create a local copy of points for better performance</span>
        <span class="n">problematic_point_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">problematic_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ase_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">ase</span><span class="p">,</span> <span class="n">pHours</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)):</span>
            <span class="n">ase_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ase</span><span class="p">)</span>  <span class="c1"># collect annual ase values for each point</span>
            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">problematic_point_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">problematic_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pHours</span><span class="p">)</span>

        <span class="n">per_problematic</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">problematic_point_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">per_problematic</span> <span class="o">&lt;</span> <span class="n">target_area</span><span class="p">,</span> <span class="n">ase_values</span><span class="p">,</span> <span class="n">per_problematic</span><span class="p">,</span> \
            <span class="n">problematic_points</span><span class="p">,</span> <span class="n">problematic_hours</span>

    <span class="k">def</span> <span class="nf">parse_blind_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse input blind states.</span>

<span class="sd">        The method tries to convert each state to a tuple of a list. Use this method</span>
<span class="sd">        to parse the input from plugins.</span>

<span class="sd">        Args:</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1. If not provided</span>
<span class="sd">                a longest combination of states from sources (window groups) will</span>
<span class="sd">                be used. Length of each item in states should be equal to number</span>
<span class="sd">                of sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parse_blind_states</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_values_from_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load grid values from self.result_files.&quot;&quot;&quot;</span>
        <span class="c1"># remove old results</span>
        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">:</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">d_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># pass</span>
        <span class="k">if</span> <span class="n">r_files</span> <span class="ow">and</span> <span class="n">d_files</span><span class="p">:</span>
            <span class="c1"># both results are available</span>
            <span class="k">for</span> <span class="n">rf</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">r_files</span><span class="p">,</span> <span class="n">d_files</span><span class="p">):</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
                <span class="n">dfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">df</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading total and direct results for {} AnalysisGrid&#39;</span>
                    <span class="s1">&#39; from {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">,</span> <span class="n">dfPath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_coupled_values_from_file</span><span class="p">(</span>
                    <span class="n">rfPath</span><span class="p">,</span> <span class="n">dfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span>
                    <span class="bp">False</span><span class="p">,</span> <span class="n">mode</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">r_files</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">r_files</span><span class="p">:</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading the results for {} AnalysisGrid form {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span>
                      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_valuesFromFile</span><span class="p">(</span>
                    <span class="n">rf</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">d_files</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">d_files</span><span class="p">:</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading the results for {} AnalysisGrid form {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span>
                      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_valuesFromFile</span><span class="p">(</span>
                    <span class="n">rf</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove all the sources and values from analysis_points.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">:</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Duplicate AnalysisGrid.&quot;&quot;&quot;</span>
        <span class="n">aps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
        <span class="n">dup</span> <span class="o">=</span> <span class="n">AnalysisGrid</span><span class="p">(</span><span class="n">aps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="n">dup</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">aps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_sources</span>
        <span class="n">dup</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span>
        <span class="k">return</span> <span class="n">dup</span>

    <span class="k">def</span> <span class="nf">to_rad_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return analysis points group as a Radiance string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">ap</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite ToString .NET method.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add two analysis grids and create a new one.</span>

<span class="sd">        This method won&#39;t duplicate the analysis points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">AnalysisGrid</span><span class="p">),</span> \
            <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected an AnalysisGrid not {}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">hoys</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Two analysis grid must have the same hoys.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_sources</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Two analysis grid with values must have the same window_groups.&#39;</span>
                <span class="p">)</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>

        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">analysis_points</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;{}+{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">addition</span> <span class="o">=</span> <span class="n">AnalysisGrid</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">addition</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">sources</span>

        <span class="k">return</span> <span class="n">addition</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of points in this group.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get value for an index.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterate points.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;String repr.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">digit_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># only x, y, z datat is available</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># results are available but are not loaded yet</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_results_point_in_time</span><span class="p">:</span>
            <span class="c1"># results is loaded for a single hour</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># results is loaded for multiple hours</span>
            <span class="k">return</span> <span class="mi">3</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># only x, y, z datat is available</span>
                <span class="k">return</span> <span class="s1">&#39;[.]&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># results are available but are not loaded yet</span>
                <span class="k">return</span> <span class="s1">&#39;[/]&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_results_point_in_time</span><span class="p">:</span>
            <span class="c1"># results is loaded for a single hour</span>
            <span class="k">return</span> <span class="s1">&#39;[+]&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># results is loaded for multiple hours</span>
            <span class="k">return</span> <span class="s1">&#39;[*]&#39;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return analysis points and directions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;AnalysisGrid::{}::#{}::{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
        <span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="honeybee.radiance.analysisgrid.AnalysisGrid" class="name">class <span class="ident">AnalysisGrid</span></p>
      
  
    <div class="desc"><p>A grid of analysis points.</p>
<p>Attributes:
    analysis_points: A collection of analysis points.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AnalysisGrid</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A grid of analysis points.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        analysis_points: A collection of analysis points.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_analysis_points&#39;</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;_sources&#39;</span><span class="p">,</span> <span class="s1">&#39;_wgroups&#39;</span><span class="p">,</span> <span class="s1">&#39;_directFiles&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_totalFiles&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis_points</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">window_groups</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a AnalysisPointGroup.</span>

<span class="sd">        analysis_points: A collection of AnalysisPoints.</span>
<span class="sd">        name: A unique name for this AnalysisGrid.</span>
<span class="sd">        window_groups: A collection of window_groups which contribute to this grid.</span>
<span class="sd">            This input is only meaningful in studies such as daylight coefficient</span>
<span class="sd">            and multi-phase studies that the contribution of each source will be</span>
<span class="sd">            calculated separately (default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># name of sources and their state. It&#39;s only meaningful in multi-phase daylight</span>
        <span class="c1"># analysis. In analysis for a single time it will be {None: [None]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">window_groups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">window_groups</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="p">()</span>

        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="n">analysis_points</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="s1">&#39;_dir&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;{} is not an AnalysisPoint.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span> <span class="o">=</span> <span class="n">analysis_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of results files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of results files</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_points_and_vectors</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">window_groups</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysis grid from points and vectors.</span>

<span class="sd">        Args:</span>
<span class="sd">            points: A flatten list of (x, y ,z) points.</span>
<span class="sd">            vectors: An optional list of (x, y, z) for direction of test points.</span>
<span class="sd">                If not provided a (0, 0, 1) vector will be assigned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="n">vectors</span> <span class="ow">or</span> <span class="p">()</span>
        <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">match_data</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">aps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">AnalysisPoint</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">aps</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">window_groups</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysis grid from a pts file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full path to points file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">AnalysisPoint</span>  <span class="c1"># load analysis point locally for better performance</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="n">points</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">fromraw_values</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">inf</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_analysis_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True for AnalysisGrid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AnalysisGrid name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@name.setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">random_name</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A list of window group names that are related to this analysis grid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span>

    <span class="nd">@window_groups.setter</span>
    <span class="k">def</span> <span class="nf">window_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wgs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">wgs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A generator of points as x, y, z.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">location</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get generator of vectors as x, y , z.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">direction</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">analysis_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of analysis points.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sorted list fo sources.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sources</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">srcs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">srcs</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">name</span>
                <span class="k">return</span> <span class="n">srcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if this analysis grid has result values.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">has_values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if direct values are available for this point.</span>

<span class="sd">        In point-in-time and 3phase recipes only total values are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">has_direct_values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hoys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return hours of the year for results if any.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hoys</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_results_point_in_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the grid has the results only for an hour.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hoys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">result_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return result files as a list [[total files], [direct files]].&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span>

    <span class="k">def</span> <span class="nf">add_result_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                         <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add new result files to grid.</span>

<span class="sd">        Use this methods if you want to get annual metrics without loading the values</span>
<span class="sd">        for each point. This method is only useful for cases with no window groups and</span>
<span class="sd">        dynamic blind states. After adding the files you can call &#39;annualMetrics&#39; method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultFile</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
            <span class="s1">&#39;ResultFile&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;hoys&#39;</span><span class="p">,</span> <span class="s1">&#39;start_line&#39;</span><span class="p">,</span> <span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">))</span>

        <span class="n">inf</span> <span class="o">=</span> <span class="n">ResultFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="k">pass</span>
        <span class="c1"># assign the values to points</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
                <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse radiance matrix header.&quot;&quot;&quot;</span>
        <span class="c1"># read the header</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FORMAT&#39;</span><span class="p">:</span>
                <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>  <span class="c1"># pass empty line</span>
                <span class="k">break</span>  <span class="c1"># done with the header!</span>
            <span class="k">elif</span> <span class="n">start_line</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NROWS&#39;</span><span class="p">:</span>
                <span class="n">points_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">check_point_count</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span> <span class="o">==</span> <span class="n">points_count</span><span class="p">,</span> \
                        <span class="s2">&quot;Length of points [{}] must match the number &quot;</span> \
                        <span class="s2">&quot;of rows [{}].&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">),</span> <span class="n">points_count</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">start_line</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NCOLS&#39;</span><span class="p">:</span>
                <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">hoys</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">hours_count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                        <span class="s2">&quot;Number of hours [{}] must match the &quot;</span> \
                        <span class="s2">&quot;number of columns [{}].&quot;</span> \
                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> <span class="n">hours_count</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hoys</span> <span class="o">=</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hours_count</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span>

    <span class="k">def</span> <span class="nf">set_values_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                             <span class="n">check_point_count</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load values for test points from a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full file path to the result file.</span>
<span class="sd">            hoys: A collection of hours of the year for the results. If None the</span>
<span class="sd">                default will be range(0, len(results)).</span>
<span class="sd">            source: Name of the source.</span>
<span class="sd">            state: Name of the state.</span>
<span class="sd">            start_line: Number of start lines after the header from 0 (default: 0).</span>
<span class="sd">            is_direct: A Boolean to declare if the results is direct illuminance</span>
<span class="sd">                (default: False).</span>
<span class="sd">            header: A Boolean to declare if the file has header (default: True).</span>
<span class="sd">            mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value</span>
<span class="sd">                will be 1. This is useful for studies such as sunlight hours. 2 &gt;</span>
<span class="sd">                load the values divided by mode number. Use this mode for daylight</span>
<span class="sd">                factor or radiation analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

            <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># binary 0-1</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># divide values by mode (useful for daylight factor calculation)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

            <span class="c1"># assign the values to points</span>
            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
                    <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_coupled_values_from_file</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">total_file_path</span><span class="p">,</span> <span class="n">direct_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load direct and total values for test points from two files.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full file path to the result file.</span>
<span class="sd">            hoys: A collection of hours of the year for the results. If None the</span>
<span class="sd">                default will be range(0, len(results)).</span>
<span class="sd">            source: Name of the source.</span>
<span class="sd">            state: Name of the state.</span>
<span class="sd">            start_line: Number of start lines after the header from 0 (default: 0).</span>
<span class="sd">            header: A Boolean to declare if the file has header (default: True).</span>
<span class="sd">            mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value</span>
<span class="sd">                will be 1. This is useful for studies such as sunlight hours. 2 &gt;</span>
<span class="sd">                load the values divided by mode number. Use this mode for daylight</span>
<span class="sd">                factor or radiation analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="n">direct_file_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">direct_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dinf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>
                <span class="n">dinf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">dinf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">direct_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

            <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span>
                          <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># binary 0-1</span>
                <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span>
                    <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)),</span>
                     <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)))</span>
                    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># divide values by mode (useful for daylight factor calculation)</span>
                <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span>
                          <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

            <span class="c1"># assign the values to points</span>
            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coupled_values</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_coupled_values</span><span class="p">(</span>
                    <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">combined_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoy: hour of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            total, direct values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">combined_value_by_id</span><span class="p">(</span><span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">combined_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_ids.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a generator for (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">combined_value_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sum_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sum of value for all the hours.</span>

<span class="sd">        This method is mostly useful for radiation and solar access analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a collection of sum values as (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">sum_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">max_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get maximum value for all the hours.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a tuple for sum of (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">max_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">annual_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate annual metrics.</span>

<span class="sd">        Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</span>

<span class="sd">        Args:</span>
<span class="sd">            da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">            udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">                (default: (100, 3000)).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,</span>
<span class="sd">            Less than UDI, More than UDI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No values are assigned to this analysis grid.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="c1"># results are not loaded but are available</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                    <span class="s1">&#39;a single merged result file.&#39;</span>
            <span class="p">)</span>
            <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[])</span>

        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
        <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">annual_metrics</span><span class="p">(</span><span class="n">da_threshhold</span><span class="p">,</span>
                                                            <span class="n">udi_min_max</span><span class="p">,</span>
                                                            <span class="n">blinds_state_ids</span><span class="p">,</span>
                                                            <span class="n">occ_schedule</span>
                                                            <span class="p">)):</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This is a method for annual recipe to load the results line by line</span>
            <span class="c1"># which unlike the other method doesn&#39;t load all the values to the memory</span>
            <span class="c1"># at once.</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="n">calculate_annual_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_calculate_annual_metrics</span>

            <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>

                <span class="c1"># read the results line by line and caluclate the values</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                    <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                        <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                        <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                        <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

                    <span class="c1"># load one line at a time</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
                        <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                            <span class="n">calculate_annual_metrics</span><span class="p">(</span>
                                <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="p">,</span>
                                <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">)):</span>

                            <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">spatial_daylight_autonomy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                  <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_area</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate Spatial Daylight Autonomy (sDA).</span>

<span class="sd">        Args:</span>
<span class="sd">            target_area: Minimum target area percentage for this grid (default: 50)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No values are assigned to this analysis grid.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="c1"># results are not loaded but are available</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                    <span class="s1">&#39;a single merged result file.&#39;</span>
            <span class="p">)</span>
            <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>

        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

            <span class="c1"># get the annual results for each sensor</span>
            <span class="n">hourly_results</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">sensor</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>

                <span class="c1"># read the results line by line and caluclate the values</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                    <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                        <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                        <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                        <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
                    <span class="n">hourly_results</span> <span class="o">=</span> \
                        <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="bp">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                              <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

        <span class="c1"># iterate through the results</span>
        <span class="c1"># find minimum number of points to meet the target_area</span>
        <span class="n">target_area</span> <span class="o">=</span> <span class="n">target_area</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="ow">or</span> \
            <span class="mf">0.50</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">)</span>
        <span class="c1"># change target area to an integer to enhance the performance in the loop</span>
        <span class="n">target</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span><span class="p">)</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span><span class="p">)</span> <span class="o">!=</span> <span class="n">target_area</span> \
            <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">met_hours</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">hr</span><span class="p">,</span> <span class="n">hrv</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="n">hourly_results</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">hr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">occ_schedule</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">da_threshhold</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">hrv</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">target</span><span class="p">:</span>
                <span class="n">met_hours</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">met_hours</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">occ_schedule</span><span class="o">.</span><span class="n">occupied_hours</span><span class="p">),</span> <span class="n">problematic_hours</span>

    <span class="k">def</span> <span class="nf">annual_solar_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_area</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Annual Solar Exposure (ASE)</span>

<span class="sd">        As per IES-LM-83-12 ase is the percent of sensors that are</span>
<span class="sd">        found to be exposed to more than 1000lux of direct sunlight for</span>
<span class="sd">        more than 250hrs per year. For LEED credits No more than 10% of</span>
<span class="sd">        the points in the grid should fail this measure.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshhold: Threshhold for for solar exposure in lux (default: 1000).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys.</span>
<span class="sd">                If you want a source to be removed set the state to -1. ase must</span>
<span class="sd">                be calculated without dynamic blinds but you can use this option</span>
<span class="sd">                to study the effect of different blind states.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>
<span class="sd">            target_hours: Minimum targe hours for each point (default: 250).</span>
<span class="sd">            target_area: Minimum target area percentage for this grid (default: 10)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Success as a Boolean, ase values for each point, Percentage area,</span>
<span class="sd">            Problematic points, Problematic hours for each point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Direct values are not available to calculate ASE.</span><span class="se">\n</span><span class="s1">In most of the cases&#39;</span>
                <span class="s1">&#39; this is because you are using a point in time recipe or the three-&#39;</span>
                <span class="s1">&#39;phase recipe. You should use one of the daylight coefficient based &#39;</span>
                <span class="s1">&#39;recipes or the 5 phase recipe instead.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span><span class="p">:</span>
            <span class="c1"># results are not loaded but are available</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                    <span class="s1">&#39;a single merged result file.&#39;</span>
            <span class="p">)</span>
            <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[])</span>
        <span class="n">threshhold</span> <span class="o">=</span> <span class="n">threshhold</span> <span class="ow">or</span> <span class="mi">1000</span>
        <span class="n">target_hours</span> <span class="o">=</span> <span class="n">target_hours</span> <span class="ow">or</span> <span class="mi">250</span>
        <span class="n">target_area</span> <span class="o">=</span> <span class="n">target_area</span> <span class="ow">or</span> <span class="mi">10</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">annual_solar_exposure</span><span class="p">(</span><span class="n">threshhold</span><span class="p">,</span>
                                                                   <span class="n">blinds_state_ids</span><span class="p">,</span>
                                                                   <span class="n">occ_schedule</span><span class="p">,</span>
                                                                   <span class="n">target_hours</span>
                                                                   <span class="p">)):</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This is a method for annual recipe to load the results line by line</span>
            <span class="c1"># which unlike the other method doesn&#39;t load all the values to the memory</span>
            <span class="c1"># at once.</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="n">calculate_annual_solar_exposure</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_calculate_annual_solar_exposure</span>

            <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>

                <span class="c1"># read the results line by line and caluclate the values</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                    <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                        <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                        <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                        <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

                    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

                    <span class="c1"># load one line at a time</span>
                    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
                        <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                            <span class="n">calculate_annual_solar_exposure</span><span class="p">(</span>
                                <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">,</span>
                                <span class="n">target_hours</span><span class="p">)):</span>

                            <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="c1"># calculate ase for the grid</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span>  <span class="c1"># create a local copy of points for better performance</span>
        <span class="n">problematic_point_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">problematic_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ase_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">ase</span><span class="p">,</span> <span class="n">pHours</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)):</span>
            <span class="n">ase_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ase</span><span class="p">)</span>  <span class="c1"># collect annual ase values for each point</span>
            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">problematic_point_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">problematic_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pHours</span><span class="p">)</span>

        <span class="n">per_problematic</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">problematic_point_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">per_problematic</span> <span class="o">&lt;</span> <span class="n">target_area</span><span class="p">,</span> <span class="n">ase_values</span><span class="p">,</span> <span class="n">per_problematic</span><span class="p">,</span> \
            <span class="n">problematic_points</span><span class="p">,</span> <span class="n">problematic_hours</span>

    <span class="k">def</span> <span class="nf">parse_blind_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse input blind states.</span>

<span class="sd">        The method tries to convert each state to a tuple of a list. Use this method</span>
<span class="sd">        to parse the input from plugins.</span>

<span class="sd">        Args:</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1. If not provided</span>
<span class="sd">                a longest combination of states from sources (window groups) will</span>
<span class="sd">                be used. Length of each item in states should be equal to number</span>
<span class="sd">                of sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parse_blind_states</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_values_from_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load grid values from self.result_files.&quot;&quot;&quot;</span>
        <span class="c1"># remove old results</span>
        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">:</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">d_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># pass</span>
        <span class="k">if</span> <span class="n">r_files</span> <span class="ow">and</span> <span class="n">d_files</span><span class="p">:</span>
            <span class="c1"># both results are available</span>
            <span class="k">for</span> <span class="n">rf</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">r_files</span><span class="p">,</span> <span class="n">d_files</span><span class="p">):</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
                <span class="n">dfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">df</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading total and direct results for {} AnalysisGrid&#39;</span>
                    <span class="s1">&#39; from {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">,</span> <span class="n">dfPath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_coupled_values_from_file</span><span class="p">(</span>
                    <span class="n">rfPath</span><span class="p">,</span> <span class="n">dfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span>
                    <span class="bp">False</span><span class="p">,</span> <span class="n">mode</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">r_files</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">r_files</span><span class="p">:</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading the results for {} AnalysisGrid form {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span>
                      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_valuesFromFile</span><span class="p">(</span>
                    <span class="n">rf</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">d_files</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">d_files</span><span class="p">:</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading the results for {} AnalysisGrid form {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span>
                      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_valuesFromFile</span><span class="p">(</span>
                    <span class="n">rf</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove all the sources and values from analysis_points.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">:</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Duplicate AnalysisGrid.&quot;&quot;&quot;</span>
        <span class="n">aps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
        <span class="n">dup</span> <span class="o">=</span> <span class="n">AnalysisGrid</span><span class="p">(</span><span class="n">aps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="n">dup</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">aps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_sources</span>
        <span class="n">dup</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span>
        <span class="k">return</span> <span class="n">dup</span>

    <span class="k">def</span> <span class="nf">to_rad_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return analysis points group as a Radiance string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">ap</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite ToString .NET method.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add two analysis grids and create a new one.</span>

<span class="sd">        This method won&#39;t duplicate the analysis points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">AnalysisGrid</span><span class="p">),</span> \
            <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected an AnalysisGrid not {}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">hoys</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Two analysis grid must have the same hoys.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_sources</span><span class="p">,</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Two analysis grid with values must have the same window_groups.&#39;</span>
                <span class="p">)</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>

        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">analysis_points</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;{}+{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">addition</span> <span class="o">=</span> <span class="n">AnalysisGrid</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">addition</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">sources</span>

        <span class="k">return</span> <span class="n">addition</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of points in this group.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get value for an index.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterate points.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;String repr.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">digit_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># only x, y, z datat is available</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># results are available but are not loaded yet</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_results_point_in_time</span><span class="p">:</span>
            <span class="c1"># results is loaded for a single hour</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># results is loaded for multiple hours</span>
            <span class="k">return</span> <span class="mi">3</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># only x, y, z datat is available</span>
                <span class="k">return</span> <span class="s1">&#39;[.]&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># results are available but are not loaded yet</span>
                <span class="k">return</span> <span class="s1">&#39;[/]&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_results_point_in_time</span><span class="p">:</span>
            <span class="c1"># results is loaded for a single hour</span>
            <span class="k">return</span> <span class="s1">&#39;[+]&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># results is loaded for multiple hours</span>
            <span class="k">return</span> <span class="s1">&#39;[*]&#39;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return analysis points and directions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;AnalysisGrid::{}::#{}::{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sign</span>
        <span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#honeybee.radiance.analysisgrid.AnalysisGrid">AnalysisGrid</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.analysis_points" class="name">var <span class="ident">analysis_points</span></p>
            

            
  
    <div class="desc"><p>Return a list of analysis points.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.digit_sign" class="name">var <span class="ident">digit_sign</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.has_direct_values" class="name">var <span class="ident">has_direct_values</span></p>
            

            
  
    <div class="desc"><p>Check if direct values are available for this point.</p>
<p>In point-in-time and 3phase recipes only total values are available.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.has_values" class="name">var <span class="ident">has_values</span></p>
            

            
  
    <div class="desc"><p>Check if this analysis grid has result values.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.hoys" class="name">var <span class="ident">hoys</span></p>
            

            
  
    <div class="desc"><p>Return hours of the year for results if any.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.is_analysis_grid" class="name">var <span class="ident">is_analysis_grid</span></p>
            

            
  
    <div class="desc"><p>Return True for AnalysisGrid.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.is_results_point_in_time" class="name">var <span class="ident">is_results_point_in_time</span></p>
            

            
  
    <div class="desc"><p>Return True if the grid has the results only for an hour.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.name" class="name">var <span class="ident">name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.points" class="name">var <span class="ident">points</span></p>
            

            
  
    <div class="desc"><p>A generator of points as x, y, z.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.result_files" class="name">var <span class="ident">result_files</span></p>
            

            
  
    <div class="desc"><p>Return result files as a list [[total files], [direct files]].</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.sources" class="name">var <span class="ident">sources</span></p>
            

            
  
    <div class="desc"><p>Get sorted list fo sources.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.vectors" class="name">var <span class="ident">vectors</span></p>
            

            
  
    <div class="desc"><p>Get generator of vectors as x, y , z.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.AnalysisGrid.window_groups" class="name">var <span class="ident">window_groups</span></p>
            

            
  
    <div class="desc"><p>A list of window group names that are related to this analysis grid.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, analysis_points, name=None, window_groups=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize a AnalysisPointGroup.</p>
<p>analysis_points: A collection of AnalysisPoints.
name: A unique name for this AnalysisGrid.
window_groups: A collection of window_groups which contribute to this grid.
    This input is only meaningful in studies such as daylight coefficient
    and multi-phase studies that the contribution of each source will be
    calculated separately (default: None).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.__init__', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis_points</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">window_groups</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a AnalysisPointGroup.</span>
<span class="sd">    analysis_points: A collection of AnalysisPoints.</span>
<span class="sd">    name: A unique name for this AnalysisGrid.</span>
<span class="sd">    window_groups: A collection of window_groups which contribute to this grid.</span>
<span class="sd">        This input is only meaningful in studies such as daylight coefficient</span>
<span class="sd">        and multi-phase studies that the contribution of each source will be</span>
<span class="sd">        calculated separately (default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="c1"># name of sources and their state. It&#39;s only meaningful in multi-phase daylight</span>
    <span class="c1"># analysis. In analysis for a single time it will be {None: [None]}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">window_groups</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">wg</span> <span class="ow">in</span> <span class="n">window_groups</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="n">analysis_points</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="s1">&#39;_dir&#39;</span><span class="p">),</span> \
            <span class="s1">&#39;{} is not an AnalysisPoint.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span> <span class="o">=</span> <span class="n">analysis_points</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of results files</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of results files</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.ToString">
    <p>def <span class="ident">ToString</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Overwrite ToString .NET method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.ToString', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.ToString" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overwrite ToString .NET method.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.add_result_files">
    <p>def <span class="ident">add_result_files</span>(</p><p>self, file_path, hoys, start_line=None, is_direct=False, header=True, mode=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Add new result files to grid.</p>
<p>Use this methods if you want to get annual metrics without loading the values
for each point. This method is only useful for cases with no window groups and
dynamic blind states. After adding the files you can call 'annualMetrics' method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.add_result_files', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.add_result_files" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_result_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                     <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add new result files to grid.</span>
<span class="sd">    Use this methods if you want to get annual metrics without loading the values</span>
<span class="sd">    for each point. This method is only useful for cases with no window groups and</span>
<span class="sd">    dynamic blind states. After adding the files you can call &#39;annualMetrics&#39; method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ResultFile</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
        <span class="s1">&#39;ResultFile&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;hoys&#39;</span><span class="p">,</span> <span class="s1">&#39;start_line&#39;</span><span class="p">,</span> <span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">))</span>
    <span class="n">inf</span> <span class="o">=</span> <span class="n">ResultFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.annual_metrics">
    <p>def <span class="ident">annual_metrics</span>(</p><p>self, da_threshhold=None, udi_min_max=None, blinds_state_ids=None, occ_schedule=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate annual metrics.</p>
<p>Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</p>
<p>Args:
    da_threshhold: Threshhold for daylight autonomy in lux (default: 300).
    udi_min_max: A tuple of min, max value for useful daylight illuminance
        (default: (100, 3000)).
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.
    occ_schedule: An annual occupancy schedule.</p>
<p>Returns:
    Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,
    Less than UDI, More than UDI</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.annual_metrics', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.annual_metrics" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">annual_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate annual metrics.</span>
<span class="sd">    Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</span>
<span class="sd">    Args:</span>
<span class="sd">        da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">        udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">            (default: (100, 3000)).</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">        occ_schedule: An annual occupancy schedule.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,</span>
<span class="sd">        Less than UDI, More than UDI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No values are assigned to this analysis grid.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
        <span class="c1"># results are not loaded but are available</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                <span class="s1">&#39;a single merged result file.&#39;</span>
        <span class="p">)</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[])</span>
    <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
    <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">annual_metrics</span><span class="p">(</span><span class="n">da_threshhold</span><span class="p">,</span>
                                                        <span class="n">udi_min_max</span><span class="p">,</span>
                                                        <span class="n">blinds_state_ids</span><span class="p">,</span>
                                                        <span class="n">occ_schedule</span>
                                                        <span class="p">)):</span>
                <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This is a method for annual recipe to load the results line by line</span>
        <span class="c1"># which unlike the other method doesn&#39;t load all the values to the memory</span>
        <span class="c1"># at once.</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="n">calculate_annual_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_calculate_annual_metrics</span>
        <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>
            <span class="c1"># read the results line by line and caluclate the values</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                    <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                    <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                    <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
                <span class="c1"># load one line at a time</span>
                <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                        <span class="n">calculate_annual_metrics</span><span class="p">(</span>
                            <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="p">,</span>
                            <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">)):</span>
                        <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.annual_solar_exposure">
    <p>def <span class="ident">annual_solar_exposure</span>(</p><p>self, threshhold=None, blinds_state_ids=None, occ_schedule=None, target_hours=None, target_area=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Annual Solar Exposure (ASE)</p>
<p>As per IES-LM-83-12 ase is the percent of sensors that are
found to be exposed to more than 1000lux of direct sunlight for
more than 250hrs per year. For LEED credits No more than 10% of
the points in the grid should fail this measure.</p>
<p>Args:
    threshhold: Threshhold for for solar exposure in lux (default: 1000).
    blinds_state_ids: List of state ids for all the sources for input hoys.
        If you want a source to be removed set the state to -1. ase must
        be calculated without dynamic blinds but you can use this option
        to study the effect of different blind states.
    occ_schedule: An annual occupancy schedule.
    target_hours: Minimum targe hours for each point (default: 250).
    target_area: Minimum target area percentage for this grid (default: 10)</p>
<p>Returns:
    Success as a Boolean, ase values for each point, Percentage area,
    Problematic points, Problematic hours for each point</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.annual_solar_exposure', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.annual_solar_exposure" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">annual_solar_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_area</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Annual Solar Exposure (ASE)</span>
<span class="sd">    As per IES-LM-83-12 ase is the percent of sensors that are</span>
<span class="sd">    found to be exposed to more than 1000lux of direct sunlight for</span>
<span class="sd">    more than 250hrs per year. For LEED credits No more than 10% of</span>
<span class="sd">    the points in the grid should fail this measure.</span>
<span class="sd">    Args:</span>
<span class="sd">        threshhold: Threshhold for for solar exposure in lux (default: 1000).</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys.</span>
<span class="sd">            If you want a source to be removed set the state to -1. ase must</span>
<span class="sd">            be calculated without dynamic blinds but you can use this option</span>
<span class="sd">            to study the effect of different blind states.</span>
<span class="sd">        occ_schedule: An annual occupancy schedule.</span>
<span class="sd">        target_hours: Minimum targe hours for each point (default: 250).</span>
<span class="sd">        target_area: Minimum target area percentage for this grid (default: 10)</span>
<span class="sd">    Returns:</span>
<span class="sd">        Success as a Boolean, ase values for each point, Percentage area,</span>
<span class="sd">        Problematic points, Problematic hours for each point</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Direct values are not available to calculate ASE.</span><span class="se">\n</span><span class="s1">In most of the cases&#39;</span>
            <span class="s1">&#39; this is because you are using a point in time recipe or the three-&#39;</span>
            <span class="s1">&#39;phase recipe. You should use one of the daylight coefficient based &#39;</span>
            <span class="s1">&#39;recipes or the 5 phase recipe instead.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span><span class="p">:</span>
        <span class="c1"># results are not loaded but are available</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                <span class="s1">&#39;a single merged result file.&#39;</span>
        <span class="p">)</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[])</span>
    <span class="n">threshhold</span> <span class="o">=</span> <span class="n">threshhold</span> <span class="ow">or</span> <span class="mi">1000</span>
    <span class="n">target_hours</span> <span class="o">=</span> <span class="n">target_hours</span> <span class="ow">or</span> <span class="mi">250</span>
    <span class="n">target_area</span> <span class="o">=</span> <span class="n">target_area</span> <span class="ow">or</span> <span class="mi">10</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">annual_solar_exposure</span><span class="p">(</span><span class="n">threshhold</span><span class="p">,</span>
                                                               <span class="n">blinds_state_ids</span><span class="p">,</span>
                                                               <span class="n">occ_schedule</span><span class="p">,</span>
                                                               <span class="n">target_hours</span>
                                                               <span class="p">)):</span>
                <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This is a method for annual recipe to load the results line by line</span>
        <span class="c1"># which unlike the other method doesn&#39;t load all the values to the memory</span>
        <span class="c1"># at once.</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="n">calculate_annual_solar_exposure</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_calculate_annual_solar_exposure</span>
        <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>
            <span class="c1"># read the results line by line and caluclate the values</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                    <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                    <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                    <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
                <span class="c1"># load one line at a time</span>
                <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                        <span class="n">calculate_annual_solar_exposure</span><span class="p">(</span>
                            <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">,</span>
                            <span class="n">target_hours</span><span class="p">)):</span>
                        <span class="n">res</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="c1"># calculate ase for the grid</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span>  <span class="c1"># create a local copy of points for better performance</span>
    <span class="n">problematic_point_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">problematic_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ase_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">ase</span><span class="p">,</span> <span class="n">pHours</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)):</span>
        <span class="n">ase_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ase</span><span class="p">)</span>  <span class="c1"># collect annual ase values for each point</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">problematic_point_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">problematic_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pHours</span><span class="p">)</span>
    <span class="n">per_problematic</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">problematic_point_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">per_problematic</span> <span class="o">&lt;</span> <span class="n">target_area</span><span class="p">,</span> <span class="n">ase_values</span><span class="p">,</span> <span class="n">per_problematic</span><span class="p">,</span> \
        <span class="n">problematic_points</span><span class="p">,</span> <span class="n">problematic_hours</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.combined_value_by_id">
    <p>def <span class="ident">combined_value_by_id</span>(</p><p>self, hoy, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get combined value from all sources based on state_id.</p>
<p>Args:
    hoy: hour of the year.
    blinds_state_ids: List of state ids for all the sources for an hour. If you
        want a source to be removed set the state to -1.</p>
<p>Returns:
    total, direct values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.combined_value_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.combined_value_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">combined_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoy: hour of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">            want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        total, direct values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">combined_value_by_id</span><span class="p">(</span><span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.combined_values_by_id">
    <p>def <span class="ident">combined_values_by_id</span>(</p><p>self, hoys=None, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get combined value from all sources based on state_ids.</p>
<p>Args:
    hoys: A collection of hours of the year.
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.</p>
<p>Returns:
    Return a generator for (total, direct) values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.combined_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.combined_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">combined_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_ids.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hours of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Return a generator for (total, direct) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">combined_value_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.duplicate">
    <p>def <span class="ident">duplicate</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Duplicate AnalysisGrid.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.duplicate', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.duplicate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Duplicate AnalysisGrid.&quot;&quot;&quot;</span>
    <span class="n">aps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
    <span class="n">dup</span> <span class="o">=</span> <span class="n">AnalysisGrid</span><span class="p">(</span><span class="n">aps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
    <span class="n">dup</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">aps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_sources</span>
    <span class="n">dup</span><span class="o">.</span><span class="n">_wgroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgroups</span>
    <span class="k">return</span> <span class="n">dup</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.from_file">
    <p>def <span class="ident">from_file</span>(</p><p>cls, file_path)</p>
    </div>
    

    
  
    <div class="desc"><p>Create an analysis grid from a pts file.</p>
<p>Args:
    file_path: Full path to points file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.from_file', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.from_file" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an analysis grid from a pts file.</span>
<span class="sd">    Args:</span>
<span class="sd">        file_path: Full path to points file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">AnalysisPoint</span>  <span class="c1"># load analysis point locally for better performance</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
        <span class="n">points</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">fromraw_values</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">inf</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.from_points_and_vectors">
    <p>def <span class="ident">from_points_and_vectors</span>(</p><p>cls, points, vectors=None, name=None, window_groups=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Create an analysis grid from points and vectors.</p>
<p>Args:
    points: A flatten list of (x, y ,z) points.
    vectors: An optional list of (x, y, z) for direction of test points.
        If not provided a (0, 0, 1) vector will be assigned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.from_points_and_vectors', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.from_points_and_vectors" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_points_and_vectors</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">window_groups</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an analysis grid from points and vectors.</span>
<span class="sd">    Args:</span>
<span class="sd">        points: A flatten list of (x, y ,z) points.</span>
<span class="sd">        vectors: An optional list of (x, y, z) for direction of test points.</span>
<span class="sd">            If not provided a (0, 0, 1) vector will be assigned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="n">vectors</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">match_data</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">aps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">AnalysisPoint</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">aps</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">window_groups</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.load_values_from_files">
    <p>def <span class="ident">load_values_from_files</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Load grid values from self.result_files.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.load_values_from_files', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.load_values_from_files" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_values_from_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load grid values from self.result_files.&quot;&quot;&quot;</span>
    <span class="c1"># remove old results</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">:</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>
    <span class="n">d_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">1</span><span class="p">][:]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># pass</span>
    <span class="k">if</span> <span class="n">r_files</span> <span class="ow">and</span> <span class="n">d_files</span><span class="p">:</span>
        <span class="c1"># both results are available</span>
        <span class="k">for</span> <span class="n">rf</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">r_files</span><span class="p">,</span> <span class="n">d_files</span><span class="p">):</span>
            <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
            <span class="n">dfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">df</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading total and direct results for {} AnalysisGrid&#39;</span>
                <span class="s1">&#39; from {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">,</span> <span class="n">dfPath</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_coupled_values_from_file</span><span class="p">(</span>
                <span class="n">rfPath</span><span class="p">,</span> <span class="n">dfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span>
                <span class="bp">False</span><span class="p">,</span> <span class="n">mode</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">r_files</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">r_files</span><span class="p">:</span>
            <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading the results for {} AnalysisGrid form {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_valuesFromFile</span><span class="p">(</span>
                <span class="n">rf</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">d_files</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">d_files</span><span class="p">:</span>
            <span class="n">rfPath</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">rf</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rfPath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">loading the results for {} AnalysisGrid form {}::{}</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rfPath</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_valuesFromFile</span><span class="p">(</span>
                <span class="n">rf</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
            <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.max_values_by_id">
    <p>def <span class="ident">max_values_by_id</span>(</p><p>self, hoys=None, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get maximum value for all the hours.</p>
<p>Args:
    hoys: A collection of hours of the year.
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.</p>
<p>Returns:
    Return a tuple for sum of (total, direct) values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.max_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.max_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">max_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get maximum value for all the hours.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hours of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Return a tuple for sum of (total, direct) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">max_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.parse_blind_states">
    <p>def <span class="ident">parse_blind_states</span>(</p><p>self, blinds_state_ids)</p>
    </div>
    

    
  
    <div class="desc"><p>Parse input blind states.</p>
<p>The method tries to convert each state to a tuple of a list. Use this method
to parse the input from plugins.</p>
<p>Args:
    blinds_state_ids: List of state ids for all the sources for an hour. If you
        want a source to be removed set the state to -1. If not provided
        a longest combination of states from sources (window groups) will
        be used. Length of each item in states should be equal to number
        of sources.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.parse_blind_states', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.parse_blind_states" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_blind_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse input blind states.</span>
<span class="sd">    The method tries to convert each state to a tuple of a list. Use this method</span>
<span class="sd">    to parse the input from plugins.</span>
<span class="sd">    Args:</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">            want a source to be removed set the state to -1. If not provided</span>
<span class="sd">            a longest combination of states from sources (window groups) will</span>
<span class="sd">            be used. Length of each item in states should be equal to number</span>
<span class="sd">            of sources.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parse_blind_states</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.parse_header">
    <p>def <span class="ident">parse_header</span>(</p><p>self, inf, start_line, hoys, check_point_count=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Parse radiance matrix header.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.parse_header', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.parse_header" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse radiance matrix header.&quot;&quot;&quot;</span>
    <span class="c1"># read the header</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FORMAT&#39;</span><span class="p">:</span>
            <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>  <span class="c1"># pass empty line</span>
            <span class="k">break</span>  <span class="c1"># done with the header!</span>
        <span class="k">elif</span> <span class="n">start_line</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NROWS&#39;</span><span class="p">:</span>
            <span class="n">points_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">check_point_count</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span> <span class="o">==</span> <span class="n">points_count</span><span class="p">,</span> \
                    <span class="s2">&quot;Length of points [{}] must match the number &quot;</span> \
                    <span class="s2">&quot;of rows [{}].&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">),</span> <span class="n">points_count</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">start_line</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NCOLS&#39;</span><span class="p">:</span>
            <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">hoys</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">hours_count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                    <span class="s2">&quot;Number of hours [{}] must match the &quot;</span> \
                    <span class="s2">&quot;number of columns [{}].&quot;</span> \
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> <span class="n">hours_count</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hoys</span> <span class="o">=</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hours_count</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.set_coupled_values_from_file">
    <p>def <span class="ident">set_coupled_values_from_file</span>(</p><p>self, total_file_path, direct_file_path, hoys=None, source=None, state=None, start_line=None, header=True, check_point_count=True, mode=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Load direct and total values for test points from two files.</p>
<p>Args:
    file_path: Full file path to the result file.
    hoys: A collection of hours of the year for the results. If None the
        default will be range(0, len(results)).
    source: Name of the source.
    state: Name of the state.
    start_line: Number of start lines after the header from 0 (default: 0).
    header: A Boolean to declare if the file has header (default: True).
    mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value
        will be 1. This is useful for studies such as sunlight hours. 2 &gt;
        load the values divided by mode number. Use this mode for daylight
        factor or radiation analysis.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.set_coupled_values_from_file', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.set_coupled_values_from_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_coupled_values_from_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">total_file_path</span><span class="p">,</span> <span class="n">direct_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">check_point_count</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load direct and total values for test points from two files.</span>
<span class="sd">    Args:</span>
<span class="sd">        file_path: Full file path to the result file.</span>
<span class="sd">        hoys: A collection of hours of the year for the results. If None the</span>
<span class="sd">            default will be range(0, len(results)).</span>
<span class="sd">        source: Name of the source.</span>
<span class="sd">        state: Name of the state.</span>
<span class="sd">        start_line: Number of start lines after the header from 0 (default: 0).</span>
<span class="sd">        header: A Boolean to declare if the file has header (default: True).</span>
<span class="sd">        mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value</span>
<span class="sd">            will be 1. This is useful for studies such as sunlight hours. 2 &gt;</span>
<span class="sd">            load the values divided by mode number. Use this mode for daylight</span>
<span class="sd">            factor or radiation analysis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="n">direct_file_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">direct_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dinf</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
            <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>
            <span class="n">dinf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">dinf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">total_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">direct_file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
            <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span>
                      <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># binary 0-1</span>
            <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)),</span>
                 <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)))</span>
                <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># divide values by mode (useful for daylight factor calculation)</span>
            <span class="n">coupled_values</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span>
                      <span class="n">izip</span><span class="p">(</span><span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dinf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="c1"># assign the values to points</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coupled_values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_coupled_values</span><span class="p">(</span>
                <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.set_values">
    <p>def <span class="ident">set_values</span>(</p><p>self, hoys, values, source=None, state=None, is_direct=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.set_values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.set_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">pass</span>
    <span class="c1"># assign the values to points</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
            <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.set_values_from_file">
    <p>def <span class="ident">set_values_from_file</span>(</p><p>self, file_path, hoys=None, source=None, state=None, start_line=None, is_direct=False, header=True, check_point_count=True, mode=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Load values for test points from a file.</p>
<p>Args:
    file_path: Full file path to the result file.
    hoys: A collection of hours of the year for the results. If None the
        default will be range(0, len(results)).
    source: Name of the source.
    state: Name of the state.
    start_line: Number of start lines after the header from 0 (default: 0).
    is_direct: A Boolean to declare if the results is direct illuminance
        (default: False).
    header: A Boolean to declare if the file has header (default: True).
    mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value
        will be 1. This is useful for studies such as sunlight hours. 2 &gt;
        load the values divided by mode number. Use this mode for daylight
        factor or radiation analysis.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.set_values_from_file', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.set_values_from_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_values_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">start_line</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                         <span class="n">check_point_count</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load values for test points from a file.</span>
<span class="sd">    Args:</span>
<span class="sd">        file_path: Full file path to the result file.</span>
<span class="sd">        hoys: A collection of hours of the year for the results. If None the</span>
<span class="sd">            default will be range(0, len(results)).</span>
<span class="sd">        source: Name of the source.</span>
<span class="sd">        state: Name of the state.</span>
<span class="sd">        start_line: Number of start lines after the header from 0 (default: 0).</span>
<span class="sd">        is_direct: A Boolean to declare if the results is direct illuminance</span>
<span class="sd">            (default: False).</span>
<span class="sd">        header: A Boolean to declare if the file has header (default: True).</span>
<span class="sd">        mode: 0 &gt; load the values 1 &gt; load values as binary. Any non-zero value</span>
<span class="sd">            will be 1. This is useful for studies such as sunlight hours. 2 &gt;</span>
<span class="sd">            load the values divided by mode number. Use this mode for daylight</span>
<span class="sd">            factor or radiation analysis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
            <span class="n">inf</span><span class="p">,</span> <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">check_point_count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_result_files</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
            <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                      <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># binary 0-1</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                      <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># divide values by mode (useful for daylight factor calculation)</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">mode</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                      <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="c1"># assign the values to points</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hourlyValues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span>
                <span class="n">hourlyValues</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">is_direct</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.spatial_daylight_autonomy">
    <p>def <span class="ident">spatial_daylight_autonomy</span>(</p><p>self, da_threshhold=None, blinds_state_ids=None, occ_schedule=None, target_area=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate Spatial Daylight Autonomy (sDA).</p>
<p>Args:
    target_area: Minimum target area percentage for this grid (default: 50)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.spatial_daylight_autonomy', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.spatial_daylight_autonomy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">spatial_daylight_autonomy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_area</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate Spatial Daylight Autonomy (sDA).</span>
<span class="sd">    Args:</span>
<span class="sd">        target_area: Minimum target area percentage for this grid (default: 50)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No values are assigned to this analysis grid.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
        <span class="c1"># results are not loaded but are available</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
            <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Annual recipe can currently only handle &#39;</span>
                <span class="s1">&#39;a single merged result file.&#39;</span>
        <span class="p">)</span>
        <span class="n">results_loaded</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Loading the results from result files.&#39;</span><span class="p">)</span>
    <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">occ_schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">results_loaded</span><span class="p">:</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="n">blinds_state_ids</span> <span class="ow">or</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="c1"># get the annual results for each sensor</span>
        <span class="n">hourly_results</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">sensor</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">file_data</span>
            <span class="c1"># read the results line by line and caluclate the values</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyFileError</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
                <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Annual results can only be calculated from &#39;</span>
                    <span class="s1">&#39;illuminance studies.&#39;</span><span class="p">)</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
                    <span class="n">inf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
                    <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">)</span>
                <span class="n">hourly_results</span> <span class="o">=</span> \
                    <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="bp">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">inf</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                          <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
    <span class="c1"># iterate through the results</span>
    <span class="c1"># find minimum number of points to meet the target_area</span>
    <span class="n">target_area</span> <span class="o">=</span> <span class="n">target_area</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="ow">or</span> \
        <span class="mf">0.50</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analysis_points</span><span class="p">)</span>
    <span class="c1"># change target area to an integer to enhance the performance in the loop</span>
    <span class="n">target</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span><span class="p">)</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span><span class="p">)</span> <span class="o">!=</span> <span class="n">target_area</span> \
        <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_area</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">met_hours</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">hr</span><span class="p">,</span> <span class="n">hrv</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">izip</span><span class="p">(</span><span class="o">*</span><span class="n">hourly_results</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">hr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">occ_schedule</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">da_threshhold</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">hrv</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">met_hours</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">met_hours</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">occ_schedule</span><span class="o">.</span><span class="n">occupied_hours</span><span class="p">),</span> <span class="n">problematic_hours</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.sum_values_by_id">
    <p>def <span class="ident">sum_values_by_id</span>(</p><p>self, hoys=None, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get sum of value for all the hours.</p>
<p>This method is mostly useful for radiation and solar access analysis.</p>
<p>Args:
    hoys: A collection of hours of the year.
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.</p>
<p>Returns:
    Return a collection of sum values as (total, direct) values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.sum_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.sum_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sum_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get sum of value for all the hours.</span>
<span class="sd">    This method is mostly useful for radiation and solar access analysis.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hours of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Return a collection of sum values as (total, direct) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_values_from_files</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">sum_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.to_rad_string">
    <p>def <span class="ident">to_rad_string</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return analysis points group as a Radiance string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.to_rad_string', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.to_rad_string" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_rad_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return analysis points group as a Radiance string.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">ap</span><span class="o">.</span><span class="n">to_rad_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.AnalysisGrid.unload">
    <p>def <span class="ident">unload</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove all the sources and values from analysis_points.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.AnalysisGrid.unload', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.AnalysisGrid.unload" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove all the sources and values from analysis_points.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_totalFiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_directFiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_points</span><span class="p">:</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="honeybee.radiance.analysisgrid.EmptyFileError" class="name">class <span class="ident">EmptyFileError</span></p>
      
  
    <div class="desc"><p>Exception for trying to load results from an empty file.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.EmptyFileError', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.EmptyFileError" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">EmptyFileError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exception for trying to load results from an empty file.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Failed to load the results form an empty file: {}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="s1">&#39;Double check inputs and outputs and make sure &#39;</span> \
                <span class="s1">&#39;everything is run correctly.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EmptyFileError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#honeybee.radiance.analysisgrid.EmptyFileError">EmptyFileError</a></li>
          <li>exceptions.Exception</li>
          <li>exceptions.BaseException</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.EmptyFileError.args" class="name">var <span class="ident">args</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysisgrid.EmptyFileError.message" class="name">var <span class="ident">message</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysisgrid.EmptyFileError.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, file_path=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysisgrid.EmptyFileError.__init__', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysisgrid.EmptyFileError.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Failed to load the results form an empty file: {}</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;Double check inputs and outputs and make sure &#39;</span> \
            <span class="s1">&#39;everything is run correctly.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">EmptyFileError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>
  </footer>
</div>
</body>
</html>