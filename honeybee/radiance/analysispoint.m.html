<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>honeybee.radiance.analysispoint API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 0.9em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    margin-left: 25%;
    max-width: 90%;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    position: fixed;
    height: 100%;
    width: 25%;
    float: left;
    padding: 30px;
    overflow: auto;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  .desc {
    white-space: pre-wrap;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      position: inherit;
      float: none;
      width: auto;
    }
    #content {
      width: 95%;
      margin-left: auto;
      border-left: none;
      padding: 30px;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#honeybee.radiance.analysispoint.AnalysisPoint">AnalysisPoint</a></span>
        
          
  <ul>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.parse_blind_states">parse_blind_states</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.__init__">__init__</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.ToString">ToString</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.annual_metrics">annual_metrics</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.annual_solar_exposure">annual_solar_exposure</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.blind_state_id">blind_state_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.blinds_state">blinds_state</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.combined_value_by_id">combined_value_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.combined_values_by_id">combined_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.coupled_value">coupled_value</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.coupled_value_by_id">coupled_value_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.coupled_values">coupled_values</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.coupled_values_by_id">coupled_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.daylight_autonomy">daylight_autonomy</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.direct_value">direct_value</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.direct_values">direct_values</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.duplicate">duplicate</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.fromraw_values">fromraw_values</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.max_values_by_id">max_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_value">set_coupled_value</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_values">set_coupled_values</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.set_value">set_value</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.set_values">set_values</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.source_id">source_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.sum_values_by_id">sum_values_by_id</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.to_rad_string">to_rad_string</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.unload">unload</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.useful_daylight_illuminance">useful_daylight_illuminance</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.value">value</a></li>
    <li class="mono"><a href="#honeybee.radiance.analysispoint.AnalysisPoint.values">values</a></li>
  </ul>

        </li>
      </ul>
    </li>

    
    <li class="set"><h3>Module Index :: <a href="../../honeybee/index.html">honeybee</a></h3>
    
    <ul>
      <li class="mono"><a href="../../honeybee/config.m.html">config</a></li>
      

      <li class="mono"><a href="../../honeybee/dataoperation.m.html">dataoperation</a></li>
      

      <li class="mono"><a href="../../honeybee/energyplus/index.html">energyplus</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/energyplus/filemanager.m.html">filemanager</a></li>
      

      <li class="mono"><a href="../../honeybee/energyplus/geometryrules.m.html">geometryrules</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/futil.m.html">futil</a></li>
      

      <li class="mono"><a href="../../honeybee/geometryoperation.m.html">geometryoperation</a></li>
      

      <li class="mono"><a href="../../honeybee/hbdynamicsurface.m.html">hbdynamicsurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbfensurface.m.html">hbfensurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbobject.m.html">hbobject</a></li>
      

      <li class="mono"><a href="../../honeybee/hbshadesurface.m.html">hbshadesurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbsurface.m.html">hbsurface</a></li>
      

      <li class="mono"><a href="../../honeybee/hbzone.m.html">hbzone</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/index.html">radiance</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/analysisgrid.m.html">analysisgrid</a></li>
      

      <li class="mono"><a href="">analysispoint</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/index.html">command</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/command/dctimestep.m.html">dctimestep</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/epw2wea.m.html">epw2wea</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/falsecolor.m.html">falsecolor</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/genBSDF.m.html">genBSDF</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/gendaymtx.m.html">gendaymtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/gensky.m.html">gensky</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/genskyvec.m.html">genskyvec</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/getbbox.m.html">getbbox</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/getinfo.m.html">getinfo</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/objview.m.html">objview</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/oconv.m.html">oconv</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/pcomb.m.html">pcomb</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/index.html">pyRad</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/objview.m.html">objview</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/pyRadLib/index.html">pyRadLib</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/command/pyRad/pyRadLib/pyrad_proc.m.html">pyrad_proc</a></li>
      

    </ul>

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/command/raBmp.m.html">raBmp</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/raTiff.m.html">raTiff</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rcalc.m.html">rcalc</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rcollate.m.html">rcollate</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rcontrib.m.html">rcontrib</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rfluxmtx.m.html">rfluxmtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rmtxop.m.html">rmtxop</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rpict.m.html">rpict</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/rtrace.m.html">rtrace</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/vwrays.m.html">vwrays</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/command/xform.m.html">xform</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/datatype.m.html">datatype</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/filemanager.m.html">filemanager</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/geometry.m.html">geometry</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/imagecollection.m.html">imagecollection</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/index.html">material</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/material/bsdf.m.html">bsdf</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/custom.m.html">custom</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/glass.m.html">glass</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/glow.m.html">glow</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/light.m.html">light</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/metal.m.html">metal</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/material/plastic.m.html">plastic</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/parameters/index.html">parameters</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/parameters/dctimestep.m.html">dctimestep</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/falsecolor.m.html">falsecolor</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/genBsdf.m.html">genBsdf</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gendaymtx.m.html">gendaymtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gensky.m.html">gensky</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/imagebased.m.html">imagebased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/oconv.m.html">oconv</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/pcomb.m.html">pcomb</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/raBmp.m.html">raBmp</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/raTiff.m.html">raTiff</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rcalc.m.html">rcalc</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rcollate.m.html">rcollate</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rcontrib.m.html">rcontrib</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rfluxmtx.m.html">rfluxmtx</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/rmtxop.m.html">rmtxop</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/vwrays.m.html">vwrays</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/parameters/xform.m.html">xform</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/properties.m.html">properties</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/radfile.m.html">radfile</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/index.html">recipe</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/annual/index.html">annual</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/annual/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightcoeff/index.html">daylightcoeff</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightcoeff/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightcoeff/imagebased.m.html">imagebased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightfactor/index.html">daylightfactor</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/daylightfactor/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/fivephase/index.html">fivephase</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/fivephase/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/parameters.m.html">parameters</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/pointintime/index.html">pointintime</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/pointintime/gridbased.m.html">gridbased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/pointintime/imagebased.m.html">imagebased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/radiation/index.html">radiation</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/radiation/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/recipedcutil.m.html">recipedcutil</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/recipeutil.m.html">recipeutil</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/recipexphaseutil.m.html">recipexphaseutil</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/recipe/solaraccess/index.html">solaraccess</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/solaraccess/gridbased.m.html">gridbased</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/recipe/threephase/index.html">threephase</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/recipe/threephase/gridbased.m.html">gridbased</a></li>
      

    </ul>

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/runmanager.m.html">runmanager</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/scene.m.html">scene</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/index.html">sky</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/radiance/sky/certainIlluminance.m.html">certainIlluminance</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/cie.m.html">cie</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/climatebased.m.html">climatebased</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/gendaylit.m.html">gendaylit</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/skymatrix.m.html">skymatrix</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/skyvector.m.html">skyvector</a></li>
      

      <li class="mono"><a href="../../honeybee/radiance/sky/sunmatrix.m.html">sunmatrix</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/radiance/view.m.html">view</a></li>
      

    </ul>

      <li class="mono"><a href="../../honeybee/room.m.html">room</a></li>
      

      <li class="mono"><a href="../../honeybee/schedule.m.html">schedule</a></li>
      

      <li class="mono"><a href="../../honeybee/surfaceproperties.m.html">surfaceproperties</a></li>
      

      <li class="mono"><a href="../../honeybee/surfacetype.m.html">surfacetype</a></li>
      

      <li class="mono"><a href="../../honeybee/utilcol.m.html">utilcol</a></li>
      

      <li class="mono"><a href="../../honeybee/vectormath/index.html">vectormath</a></li>
      
    <ul>
      <li class="mono"><a href="../../honeybee/vectormath/euclid.m.html">euclid</a></li>
      

    </ul>

    </ul>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">honeybee.radiance.analysispoint</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint" class="source">
    <div class="codehilite"><pre><span></span><span class="c1"># &quot;&quot;&quot;Honeybee PointGroup and TestPointGroup.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">..vectormath.euclid</span> <span class="kn">import</span> <span class="n">Point3</span><span class="p">,</span> <span class="n">Vector3</span>
<span class="kn">from</span> <span class="nn">..schedule</span> <span class="kn">import</span> <span class="n">Schedule</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">ladybug.dt</span> <span class="kn">as</span> <span class="nn">dt</span>


<span class="k">class</span> <span class="nc">AnalysisPoint</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A radiance analysis point.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        location: Location of analysis points as (x, y, z).</span>
<span class="sd">        direction: Direction of analysis point as (x, y, z).</span>

<span class="sd">    This class is developed to enable honeybee for running daylight control</span>
<span class="sd">    studies with dynamic shadings without going back to several files.</span>

<span class="sd">    Each AnalysisPoint can load annual total and direct results for every state of</span>
<span class="sd">    each source assigned to it. As a result once can end up with a lot of data for</span>
<span class="sd">    a single point (8760 * sources * states for each source). The data are sorted as</span>
<span class="sd">    integers and in different lists for each source. There are several methods to</span>
<span class="sd">    set or get the data but if you&#39;re interested in more details read the comments</span>
<span class="sd">    under __init__ to know how the data is stored.</span>

<span class="sd">    In this class:</span>
<span class="sd">     - Id stands for &#39;the id of a blind state&#39;. Each state has a name and an ID will</span>
<span class="sd">       be assigned to it based on the order of loading.</span>
<span class="sd">     - coupledValue stands for a tuple of  (total, direct) values. If one the values is</span>
<span class="sd">       not available it will be set to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_loc&#39;</span><span class="p">,</span> <span class="s1">&#39;_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;_sources&#39;</span><span class="p">,</span> <span class="s1">&#39;_values&#39;</span><span class="p">,</span> <span class="s1">&#39;_is_directLoaded&#39;</span><span class="p">,</span> <span class="s1">&#39;logic&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysis point.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>

        <span class="c1"># name of sources and their state. It&#39;s only meaningful in multi-phase daylight</span>
        <span class="c1"># analysis. In analysis for a single time it will be {None: [None]}</span>
        <span class="c1"># It is set inside _createDataStructure method on setting values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1"># an empty list for values</span>
        <span class="c1"># for each source there will be a new list</span>
        <span class="c1"># inside each source list there will be a dictionary for each state</span>
        <span class="c1"># in each dictionary the key is the hoy and the values are a list which</span>
        <span class="c1"># is [total, direct]. If the value is not available it will be None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logic</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromraw_values</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysi point from 6 values.</span>

<span class="sd">        x, y, z are the location of the point and x1, y1 and z1 is the direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Location of analysis points as Point3.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc</span>

    <span class="nd">@location.setter</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loc</span> <span class="o">=</span> <span class="n">Point3</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">location</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Dynamo Points!</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_loc</span> <span class="o">=</span> <span class="n">Point3</span><span class="p">(</span><span class="n">location</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to convert {} to location.</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;location should be a list or a tuple with 3 values.</span><span class="se">\n</span><span class="s1">{}&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Direction of analysis points as Point3.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span>

    <span class="nd">@direction.setter</span>
    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">direction</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Dynamo Points!</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">direction</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">direction</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">direction</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to convert {} to direction.</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;location should be a list or a tuple with 3 values.</span><span class="se">\n</span><span class="s1">{}&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sorted list of light sources.</span>

<span class="sd">        In most of the cases light sources are window groups.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">srcs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">srcs</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">srcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Human readable details.&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;Location: {}</span><span class="se">\n</span><span class="s1">Direction: {}</span><span class="se">\n</span><span class="s1">#hours: {}</span><span class="se">\n</span><span class="s1">#window groups: {}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">),</span>
            <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hoys</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">15</span>
        <span class="n">wg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Window Group {}: {}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s1">&#39;....State {}: {}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># sort sources based on ids</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">sources</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c1"># create the string for eacj window groups</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">states</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]):</span>
                <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if this point has results values.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if direct values are loaded for this point.</span>

<span class="sd">        In some cases and based on the recipe only total values are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hoys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return hours of the year for results if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_logic</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dynamic blinds state logic.</span>

<span class="sd">        If the logic is not met the blind will be moved to the next state.</span>
<span class="sd">        Overwrite this method for optional blind control.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3000</span>

    <span class="k">def</span> <span class="nf">source_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get source id from source name.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid source input: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">blind_state_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get state id if available.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid state input: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of states names for each source.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">longest_state_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get longest combination between blind states as blinds_state_ids.&quot;&quot;&quot;</span>
        <span class="n">states</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">states</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;This sensor is associated with no dynamic blinds.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">states</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_create_data_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create place holders for sources and states if needed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            source id and state id as a tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">double</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>

        <span class="n">current_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_sources</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_sources</span><span class="p">),</span>
                <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span>

            <span class="c1"># append a new list to values for the new source</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]:</span>
            <span class="c1"># add sources</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="c1"># append a new dictionary for this state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>

        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span>

    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set value for a specific hour of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: Value as a number.</span>
<span class="sd">            hoy: The hour of the year that corresponds to this value.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">            is_direct: Set to True if the value is direct contribution of sunlight.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set values for several hours of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            values: List of values as numbers.</span>
<span class="sd">            hoys: List of hours of the year that corresponds to input values.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">            is_direct: Set to True if the value is direct contribution of sunlight.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)</span> <span class="ow">or</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)):</span>

            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Length of values [</span><span class="si">%d</span><span class="s1">] is not equal to length of hoys [</span><span class="si">%d</span><span class="s1">].&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>

        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to load {} results for window_group [{}], state[{}]&#39;</span>
                    <span class="s1">&#39; for hour {}.</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span>
                                               <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_coupled_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set both total and direct values for a specific hour of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: Value as as tuples (total, direct).</span>
<span class="sd">            hoy: The hour of the year that corresponds to this value.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">set_coupled_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set total and direct values for several hours of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            values: List of values as tuples (total, direct).</span>
<span class="sd">            hoys: List of hours of the year that corresponds to input values.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)</span> <span class="ow">or</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)):</span>

            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Length of values [</span><span class="si">%d</span><span class="s1">] is not equal to length of hoys [</span><span class="si">%d</span><span class="s1">].&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>

        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total value for an hour of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">direct_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get direct value for an hour of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get values for several hours of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get direct values for several hours of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">coupled_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for an hoy.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">coupled_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for several hours of year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">coupled_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for an hoy.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="n">source_id</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="n">state_id</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">coupled_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for several hours of year by source id.</span>

<span class="sd">        Use this method to load the values if you have the ids for source and state.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hoys.</span>
<span class="sd">            source_id: Id of source as an integer (default: 0).</span>
<span class="sd">            state_id: Id of state as an integer (default: 0).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="n">source_id</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="n">state_id</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">combined_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoy: hour of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            total, direct values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="k">else</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> \
            <span class="s1">&#39;There should be a state for each source. #sources[{}] != #states[{}]&#39;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">stateid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
                <span class="n">t</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>
                <span class="n">direct</span> <span class="o">+=</span> <span class="n">d</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># direct value is None</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">combined_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a generator for (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;hoys must be an iterable object: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hoys</span><span class="p">))</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)]</span> <span class="o">*</span> <span class="n">hours_count</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> \
            <span class="s1">&#39;There should be a list of states for each hour. #states[{}] != #hours[{}]&#39;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">))</span>

        <span class="n">dir_value</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hoys</span><span class="p">):</span>
            <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">direct</span> <span class="o">=</span> <span class="n">dir_value</span>

            <span class="k">for</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">[</span><span class="n">count</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">stateid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
                    <span class="n">t</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>
                    <span class="n">direct</span> <span class="o">+=</span> <span class="n">d</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="c1"># direct value is None</span>
                    <span class="k">pass</span>

            <span class="k">yield</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">sum_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sum of value for all the hours.</span>

<span class="sd">        This method is mostly useful for radiation and solar access analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a tuple for sum of (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">direct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;&#39;long&#39; and &#39;NoneType&#39;&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="c1"># direct value is not loaded</span>
                <span class="n">direct</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">max_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get maximum value for all the hours.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a tuple for sum of (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">blinds_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculte blinds state based on a control logic.</span>

<span class="sd">        Overwrite self.logic to overwrite the logic for this point.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: List of hours of year. If None default is self.hoys.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1. If not provided</span>
<span class="sd">                a longest combination of states from sources (window groups) will</span>
<span class="sd">                be used. Length of each item in states should be equal to number</span>
<span class="sd">                of sources.</span>
<span class="sd">            args: Additional inputs for self.logic. args will be passed to self.logic</span>
<span class="sd">            kwargs: Additional inputs for self.logic. kwargs will be passed to self.logic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">if</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
            <span class="c1"># recreate the states in case the inputs are the names of the states</span>
            <span class="c1"># and not the numbers.</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span>

            <span class="n">comb_ids</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">)</span>

            <span class="c1"># find state ids for each state if inputs are state names</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">comb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
                        <span class="n">comb_ids</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">comb</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Length of each state should be equal to number of sources: {}&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comb_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longest_state_ids</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Blinds combinations:</span><span class="se">\n</span><span class="s2">{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
              <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">comb_ids</span><span class="p">)))</span>

        <span class="c1"># collect the results for each combination</span>
        <span class="n">results</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">):</span>
            <span class="n">results</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>

        <span class="c1"># assume the last state happens for all</span>
        <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="n">blinds_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
        <span class="n">ill_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
        <span class="n">dir_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
        <span class="n">success</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>

        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hoys</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">)):</span>
                <span class="n">ill</span><span class="p">,</span> <span class="n">ill_dir</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">count</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">logic</span><span class="p">(</span><span class="n">ill</span><span class="p">,</span> <span class="n">ill_dir</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
                    <span class="n">blinds_index</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span>
                    <span class="n">ill_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill</span>
                    <span class="n">dir_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_dir</span>
                    <span class="k">if</span> <span class="n">state</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">success</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">success</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">ill_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill</span>
                <span class="n">dir_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_dir</span>

        <span class="n">blinds_state</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">blinds_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">blinds_state</span><span class="p">,</span> <span class="n">blinds_index</span><span class="p">,</span> <span class="n">ill_values</span><span class="p">,</span> <span class="n">dir_values</span><span class="p">,</span> <span class="n">success</span>

    <span class="k">def</span> <span class="nf">annual_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate annual metrics.</span>

<span class="sd">        Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</span>

<span class="sd">        Args:</span>
<span class="sd">            da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">            udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">                (default: (100, 2000)).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule (default: Office Schedule).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,</span>
<span class="sd">            Less than UDI, More than UDI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_annual_metrics</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">useful_daylight_illuminance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                    <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate useful daylight illuminance.</span>

<span class="sd">        Args:</span>
<span class="sd">            udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">                (default: (100, 2000)).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Useful daylight illuminance, Less than UDI, More than UDI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="n">udiMin</span><span class="p">,</span> <span class="n">udiMax</span> <span class="o">=</span> <span class="n">udi_min_max</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">udi</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_l</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">udiMin</span><span class="p">:</span>
                <span class="n">udi_l</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">udiMax</span><span class="p">:</span>
                <span class="n">udi_m</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">udi</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_l</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
            <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_m</span> <span class="o">/</span> <span class="n">total_hour_count</span>

    <span class="k">def</span> <span class="nf">daylight_autonomy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate daylight autonomy and continious daylight autonomy.</span>

<span class="sd">        Args:</span>
<span class="sd">            da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Daylight autonomy, Continious daylight autonomy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mi">300</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">DA</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cda</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">da_threshhold</span><span class="p">:</span>
                <span class="n">DA</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">da_threshhold</span>

        <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">cda</span> <span class="o">/</span> <span class="n">total_hour_count</span>

    <span class="k">def</span> <span class="nf">annual_solar_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Annual Solar Exposure (ASE).</span>

<span class="sd">        Calculate number of hours that this point is exposed to more than 1000lux</span>
<span class="sd">        of direct sunlight. The point meets the traget in the number of hours is</span>
<span class="sd">        less than 250 hours per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshhold: Threshhold for daylight autonomy in lux (default: 1000).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys.</span>
<span class="sd">                If you want a source to be removed set the state to -1. ase must</span>
<span class="sd">                be calculated without dynamic blinds but you can use this option</span>
<span class="sd">                to study the effect of different blind states.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>
<span class="sd">            target_hours: Target minimum hours (default: 250).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Success as a Boolean, Number of hours, Problematic hours</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Direct values are not loaded. Data is not available to calculate ASE.&#39;</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_annual_solar_exposure</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">,</span> <span class="n">target_hours</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_calculate_annual_solar_exposure</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">threshhold</span> <span class="o">=</span> <span class="n">threshhold</span> <span class="ow">or</span> <span class="mi">1000</span>
        <span class="n">target_hours</span> <span class="o">=</span> <span class="n">target_hours</span> <span class="ow">or</span> <span class="mi">250</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="n">ase</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">threshhold</span><span class="p">:</span>
                <span class="n">ase</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ase</span> <span class="o">&lt;</span> <span class="n">target_hours</span><span class="p">,</span> <span class="n">ase</span><span class="p">,</span> <span class="n">problematic_hours</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_calculate_annual_metrics</span><span class="p">(</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">udiMin</span><span class="p">,</span> <span class="n">udiMax</span> <span class="o">=</span> <span class="n">udi_min_max</span>
        <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>
        <span class="n">DA</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cda</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_l</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">da_threshhold</span><span class="p">:</span>
                <span class="n">DA</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">da_threshhold</span>

            <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">udiMin</span><span class="p">:</span>
                <span class="n">udi_l</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">udiMax</span><span class="p">:</span>
                <span class="n">udi_m</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">udi</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">cda</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
            <span class="mi">100</span> <span class="o">*</span> <span class="n">udi</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_l</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
            <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_m</span> <span class="o">/</span> <span class="n">total_hour_count</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_blind_states</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse input blind states.</span>

<span class="sd">        The method tries to convert each state to a tuple of a list. Use this method</span>
<span class="sd">        to parse the input from plugins.</span>

<span class="sd">        Args:</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1. If not provided</span>
<span class="sd">                a longest combination of states from sources (window groups) will</span>
<span class="sd">                be used. Length of each item in states should be equal to number</span>
<span class="sd">                of sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">combs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">blinds_state_ids</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Failed to convert input blind states:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">combs</span>

    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unload values and sources.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Duplicate the analysis point.&quot;&quot;&quot;</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">AnalysisPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span><span class="p">)</span>
        <span class="c1"># This should be good enough as most of the time an analysis point will be</span>
        <span class="c1"># copied with no values assigned.</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">):</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>

        <span class="n">ap</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span><span class="p">)</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">logic</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logic</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ap</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">to_rad_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Radiance string for a test point.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print and analysis point.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;AnalysisPoint::(</span><span class="si">%s</span><span class="s1">)::(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="honeybee.radiance.analysispoint.AnalysisPoint" class="name">class <span class="ident">AnalysisPoint</span></p>
      
  
    <div class="desc"><p>A radiance analysis point.</p>
<p>Attributes:
    location: Location of analysis points as (x, y, z).
    direction: Direction of analysis point as (x, y, z).</p>
<p>This class is developed to enable honeybee for running daylight control
studies with dynamic shadings without going back to several files.</p>
<p>Each AnalysisPoint can load annual total and direct results for every state of
each source assigned to it. As a result once can end up with a lot of data for
a single point (8760 * sources * states for each source). The data are sorted as
integers and in different lists for each source. There are several methods to
set or get the data but if you're interested in more details read the comments
under <strong>init</strong> to know how the data is stored.</p>
<p>In this class:
 - Id stands for 'the id of a blind state'. Each state has a name and an ID will
   be assigned to it based on the order of loading.
 - coupledValue stands for a tuple of  (total, direct) values. If one the values is
   not available it will be set to None.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AnalysisPoint</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A radiance analysis point.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        location: Location of analysis points as (x, y, z).</span>
<span class="sd">        direction: Direction of analysis point as (x, y, z).</span>

<span class="sd">    This class is developed to enable honeybee for running daylight control</span>
<span class="sd">    studies with dynamic shadings without going back to several files.</span>

<span class="sd">    Each AnalysisPoint can load annual total and direct results for every state of</span>
<span class="sd">    each source assigned to it. As a result once can end up with a lot of data for</span>
<span class="sd">    a single point (8760 * sources * states for each source). The data are sorted as</span>
<span class="sd">    integers and in different lists for each source. There are several methods to</span>
<span class="sd">    set or get the data but if you&#39;re interested in more details read the comments</span>
<span class="sd">    under __init__ to know how the data is stored.</span>

<span class="sd">    In this class:</span>
<span class="sd">     - Id stands for &#39;the id of a blind state&#39;. Each state has a name and an ID will</span>
<span class="sd">       be assigned to it based on the order of loading.</span>
<span class="sd">     - coupledValue stands for a tuple of  (total, direct) values. If one the values is</span>
<span class="sd">       not available it will be set to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_loc&#39;</span><span class="p">,</span> <span class="s1">&#39;_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;_sources&#39;</span><span class="p">,</span> <span class="s1">&#39;_values&#39;</span><span class="p">,</span> <span class="s1">&#39;_is_directLoaded&#39;</span><span class="p">,</span> <span class="s1">&#39;logic&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysis point.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>

        <span class="c1"># name of sources and their state. It&#39;s only meaningful in multi-phase daylight</span>
        <span class="c1"># analysis. In analysis for a single time it will be {None: [None]}</span>
        <span class="c1"># It is set inside _createDataStructure method on setting values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1"># an empty list for values</span>
        <span class="c1"># for each source there will be a new list</span>
        <span class="c1"># inside each source list there will be a dictionary for each state</span>
        <span class="c1"># in each dictionary the key is the hoy and the values are a list which</span>
        <span class="c1"># is [total, direct]. If the value is not available it will be None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logic</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromraw_values</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an analysi point from 6 values.</span>

<span class="sd">        x, y, z are the location of the point and x1, y1 and z1 is the direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Location of analysis points as Point3.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc</span>

    <span class="nd">@location.setter</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loc</span> <span class="o">=</span> <span class="n">Point3</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">location</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Dynamo Points!</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_loc</span> <span class="o">=</span> <span class="n">Point3</span><span class="p">(</span><span class="n">location</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to convert {} to location.</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;location should be a list or a tuple with 3 values.</span><span class="se">\n</span><span class="s1">{}&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Direction of analysis points as Point3.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span>

    <span class="nd">@direction.setter</span>
    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">direction</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Dynamo Points!</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">direction</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">direction</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">direction</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to convert {} to direction.</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;location should be a list or a tuple with 3 values.</span><span class="se">\n</span><span class="s1">{}&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sorted list of light sources.</span>

<span class="sd">        In most of the cases light sources are window groups.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">srcs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">srcs</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">srcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Human readable details.&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;Location: {}</span><span class="se">\n</span><span class="s1">Direction: {}</span><span class="se">\n</span><span class="s1">#hours: {}</span><span class="se">\n</span><span class="s1">#window groups: {}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">),</span>
            <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hoys</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">15</span>
        <span class="n">wg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Window Group {}: {}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s1">&#39;....State {}: {}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># sort sources based on ids</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">sources</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="c1"># create the string for eacj window groups</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">states</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]):</span>
                <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if this point has results values.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if direct values are loaded for this point.</span>

<span class="sd">        In some cases and based on the recipe only total values are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hoys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return hours of the year for results if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_values</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_logic</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dynamic blinds state logic.</span>

<span class="sd">        If the logic is not met the blind will be moved to the next state.</span>
<span class="sd">        Overwrite this method for optional blind control.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3000</span>

    <span class="k">def</span> <span class="nf">source_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get source id from source name.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid source input: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">blind_state_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get state id if available.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid state input: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of states names for each source.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">longest_state_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get longest combination between blind states as blinds_state_ids.&quot;&quot;&quot;</span>
        <span class="n">states</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">states</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;This sensor is associated with no dynamic blinds.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">states</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_create_data_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create place holders for sources and states if needed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            source id and state id as a tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">double</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>

        <span class="n">current_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_sources</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_sources</span><span class="p">),</span>
                <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span>

            <span class="c1"># append a new list to values for the new source</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]:</span>
            <span class="c1"># add sources</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="c1"># append a new dictionary for this state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>

        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span>

    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set value for a specific hour of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: Value as a number.</span>
<span class="sd">            hoy: The hour of the year that corresponds to this value.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">            is_direct: Set to True if the value is direct contribution of sunlight.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set values for several hours of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            values: List of values as numbers.</span>
<span class="sd">            hoys: List of hours of the year that corresponds to input values.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">            is_direct: Set to True if the value is direct contribution of sunlight.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)</span> <span class="ow">or</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)):</span>

            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Length of values [</span><span class="si">%d</span><span class="s1">] is not equal to length of hoys [</span><span class="si">%d</span><span class="s1">].&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>

        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to load {} results for window_group [{}], state[{}]&#39;</span>
                    <span class="s1">&#39; for hour {}.</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span>
                                               <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_coupled_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set both total and direct values for a specific hour of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: Value as as tuples (total, direct).</span>
<span class="sd">            hoy: The hour of the year that corresponds to this value.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">set_coupled_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set total and direct values for several hours of the year.</span>

<span class="sd">        Args:</span>
<span class="sd">            values: List of values as tuples (total, direct).</span>
<span class="sd">            hoys: List of hours of the year that corresponds to input values.</span>
<span class="sd">            source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">                sources / window groups (default: None).</span>
<span class="sd">            state: State of the source if any (default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)</span> <span class="ow">or</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)):</span>

            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Length of values [</span><span class="si">%d</span><span class="s1">] is not equal to length of hoys [</span><span class="si">%d</span><span class="s1">].&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>

        <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total value for an hour of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">direct_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get direct value for an hour of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get values for several hours of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get direct values for several hours of the year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">coupled_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for an hoy.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">coupled_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for several hours of year.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">coupled_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for an hoy.&quot;&quot;&quot;</span>
        <span class="c1"># find the id for source and state</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="n">source_id</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="c1"># find the state id</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="n">state_id</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">coupled_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get total and direct values for several hours of year by source id.</span>

<span class="sd">        Use this method to load the values if you have the ids for source and state.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hoys.</span>
<span class="sd">            source_id: Id of source as an integer (default: 0).</span>
<span class="sd">            state_id: Id of state as an integer (default: 0).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="n">source_id</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">stateid</span> <span class="o">=</span> <span class="n">state_id</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">combined_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoy: hour of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            total, direct values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="k">else</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> \
            <span class="s1">&#39;There should be a state for each source. #sources[{}] != #states[{}]&#39;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">stateid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
                <span class="n">t</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>
                <span class="n">direct</span> <span class="o">+=</span> <span class="n">d</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># direct value is None</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">combined_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a generator for (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;hoys must be an iterable object: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hoys</span><span class="p">))</span>
            <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)]</span> <span class="o">*</span> <span class="n">hours_count</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> \
            <span class="s1">&#39;There should be a list of states for each hour. #states[{}] != #hours[{}]&#39;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">))</span>

        <span class="n">dir_value</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hoys</span><span class="p">):</span>
            <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">direct</span> <span class="o">=</span> <span class="n">dir_value</span>

            <span class="k">for</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">[</span><span class="n">count</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">stateid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
                    <span class="n">t</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>
                    <span class="n">direct</span> <span class="o">+=</span> <span class="n">d</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="c1"># direct value is None</span>
                    <span class="k">pass</span>

            <span class="k">yield</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">sum_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sum of value for all the hours.</span>

<span class="sd">        This method is mostly useful for radiation and solar access analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a tuple for sum of (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">direct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;&#39;long&#39; and &#39;NoneType&#39;&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="c1"># direct value is not loaded</span>
                <span class="n">direct</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">max_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get maximum value for all the hours.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: A collection of hours of the year.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Return a tuple for sum of (total, direct) values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">blinds_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculte blinds state based on a control logic.</span>

<span class="sd">        Overwrite self.logic to overwrite the logic for this point.</span>

<span class="sd">        Args:</span>
<span class="sd">            hoys: List of hours of year. If None default is self.hoys.</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1. If not provided</span>
<span class="sd">                a longest combination of states from sources (window groups) will</span>
<span class="sd">                be used. Length of each item in states should be equal to number</span>
<span class="sd">                of sources.</span>
<span class="sd">            args: Additional inputs for self.logic. args will be passed to self.logic</span>
<span class="sd">            kwargs: Additional inputs for self.logic. kwargs will be passed to self.logic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>

        <span class="k">if</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
            <span class="c1"># recreate the states in case the inputs are the names of the states</span>
            <span class="c1"># and not the numbers.</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span>

            <span class="n">comb_ids</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">)</span>

            <span class="c1"># find state ids for each state if inputs are state names</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">comb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
                        <span class="n">comb_ids</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">comb</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Length of each state should be equal to number of sources: {}&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comb_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longest_state_ids</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Blinds combinations:</span><span class="se">\n</span><span class="s2">{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
              <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">comb_ids</span><span class="p">)))</span>

        <span class="c1"># collect the results for each combination</span>
        <span class="n">results</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">):</span>
            <span class="n">results</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>

        <span class="c1"># assume the last state happens for all</span>
        <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="n">blinds_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
        <span class="n">ill_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
        <span class="n">dir_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
        <span class="n">success</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>

        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hoys</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">)):</span>
                <span class="n">ill</span><span class="p">,</span> <span class="n">ill_dir</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">count</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">logic</span><span class="p">(</span><span class="n">ill</span><span class="p">,</span> <span class="n">ill_dir</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
                    <span class="n">blinds_index</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span>
                    <span class="n">ill_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill</span>
                    <span class="n">dir_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_dir</span>
                    <span class="k">if</span> <span class="n">state</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">success</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">success</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">ill_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill</span>
                <span class="n">dir_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_dir</span>

        <span class="n">blinds_state</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">blinds_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">blinds_state</span><span class="p">,</span> <span class="n">blinds_index</span><span class="p">,</span> <span class="n">ill_values</span><span class="p">,</span> <span class="n">dir_values</span><span class="p">,</span> <span class="n">success</span>

    <span class="k">def</span> <span class="nf">annual_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate annual metrics.</span>

<span class="sd">        Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</span>

<span class="sd">        Args:</span>
<span class="sd">            da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">            udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">                (default: (100, 2000)).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule (default: Office Schedule).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,</span>
<span class="sd">            Less than UDI, More than UDI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_annual_metrics</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">useful_daylight_illuminance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                    <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate useful daylight illuminance.</span>

<span class="sd">        Args:</span>
<span class="sd">            udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">                (default: (100, 2000)).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Useful daylight illuminance, Less than UDI, More than UDI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="n">udiMin</span><span class="p">,</span> <span class="n">udiMax</span> <span class="o">=</span> <span class="n">udi_min_max</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">udi</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_l</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">udiMin</span><span class="p">:</span>
                <span class="n">udi_l</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">udiMax</span><span class="p">:</span>
                <span class="n">udi_m</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">udi</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_l</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
            <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_m</span> <span class="o">/</span> <span class="n">total_hour_count</span>

    <span class="k">def</span> <span class="nf">daylight_autonomy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate daylight autonomy and continious daylight autonomy.</span>

<span class="sd">        Args:</span>
<span class="sd">            da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">                you want a source to be removed set the state to -1.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Daylight autonomy, Continious daylight autonomy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mi">300</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">DA</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cda</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">da_threshhold</span><span class="p">:</span>
                <span class="n">DA</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">da_threshhold</span>

        <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">cda</span> <span class="o">/</span> <span class="n">total_hour_count</span>

    <span class="k">def</span> <span class="nf">annual_solar_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Annual Solar Exposure (ASE).</span>

<span class="sd">        Calculate number of hours that this point is exposed to more than 1000lux</span>
<span class="sd">        of direct sunlight. The point meets the traget in the number of hours is</span>
<span class="sd">        less than 250 hours per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshhold: Threshhold for daylight autonomy in lux (default: 1000).</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for input hoys.</span>
<span class="sd">                If you want a source to be removed set the state to -1. ase must</span>
<span class="sd">                be calculated without dynamic blinds but you can use this option</span>
<span class="sd">                to study the effect of different blind states.</span>
<span class="sd">            occ_schedule: An annual occupancy schedule.</span>
<span class="sd">            target_hours: Target minimum hours (default: 250).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Success as a Boolean, Number of hours, Problematic hours</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Direct values are not loaded. Data is not available to calculate ASE.&#39;</span><span class="p">)</span>

        <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_annual_solar_exposure</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">,</span> <span class="n">target_hours</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_calculate_annual_solar_exposure</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">threshhold</span> <span class="o">=</span> <span class="n">threshhold</span> <span class="ow">or</span> <span class="mi">1000</span>
        <span class="n">target_hours</span> <span class="o">=</span> <span class="n">target_hours</span> <span class="ow">or</span> <span class="mi">250</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="n">ase</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">problematic_hours</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">threshhold</span><span class="p">:</span>
                <span class="n">ase</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">problematic_hours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ase</span> <span class="o">&lt;</span> <span class="n">target_hours</span><span class="p">,</span> <span class="n">ase</span><span class="p">,</span> <span class="n">problematic_hours</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_calculate_annual_metrics</span><span class="p">(</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
        <span class="n">udiMin</span><span class="p">,</span> <span class="n">udiMax</span> <span class="o">=</span> <span class="n">udi_min_max</span>
        <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mf">300.0</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="n">Schedule</span><span class="o">.</span><span class="n">from_workday_hours</span><span class="p">()</span>
        <span class="n">DA</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cda</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_l</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">udi_m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
                <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">da_threshhold</span><span class="p">:</span>
                <span class="n">DA</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cda</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">da_threshhold</span>

            <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">udiMin</span><span class="p">:</span>
                <span class="n">udi_l</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">udiMax</span><span class="p">:</span>
                <span class="n">udi_m</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">udi</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">cda</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
            <span class="mi">100</span> <span class="o">*</span> <span class="n">udi</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_l</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
            <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_m</span> <span class="o">/</span> <span class="n">total_hour_count</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_blind_states</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse input blind states.</span>

<span class="sd">        The method tries to convert each state to a tuple of a list. Use this method</span>
<span class="sd">        to parse the input from plugins.</span>

<span class="sd">        Args:</span>
<span class="sd">            blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">                want a source to be removed set the state to -1. If not provided</span>
<span class="sd">                a longest combination of states from sources (window groups) will</span>
<span class="sd">                be used. Length of each item in states should be equal to number</span>
<span class="sd">                of sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">combs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">blinds_state_ids</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Failed to convert input blind states:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">combs</span>

    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unload values and sources.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Duplicate the analysis point.&quot;&quot;&quot;</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">AnalysisPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span><span class="p">)</span>
        <span class="c1"># This should be good enough as most of the time an analysis point will be</span>
        <span class="c1"># copied with no values assigned.</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">):</span>
            <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>

        <span class="n">ap</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span><span class="p">)</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">logic</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logic</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ap</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">to_rad_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Radiance string for a test point.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print and analysis point.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;AnalysisPoint::(</span><span class="si">%s</span><span class="s1">)::(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#honeybee.radiance.analysispoint.AnalysisPoint">AnalysisPoint</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.parse_blind_states">
    <p>def <span class="ident">parse_blind_states</span>(</p><p>blinds_state_ids)</p>
    </div>
    

    
  
    <div class="desc"><p>Parse input blind states.</p>
<p>The method tries to convert each state to a tuple of a list. Use this method
to parse the input from plugins.</p>
<p>Args:
    blinds_state_ids: List of state ids for all the sources for an hour. If you
        want a source to be removed set the state to -1. If not provided
        a longest combination of states from sources (window groups) will
        be used. Length of each item in states should be equal to number
        of sources.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.parse_blind_states', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.parse_blind_states" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parse_blind_states</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse input blind states.</span>
<span class="sd">    The method tries to convert each state to a tuple of a list. Use this method</span>
<span class="sd">    to parse the input from plugins.</span>
<span class="sd">    Args:</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">            want a source to be removed set the state to -1. If not provided</span>
<span class="sd">            a longest combination of states from sources (window groups) will</span>
<span class="sd">            be used. Length of each item in states should be equal to number</span>
<span class="sd">            of sources.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">combs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">blinds_state_ids</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Failed to convert input blind states:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">combs</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.details" class="name">var <span class="ident">details</span></p>
            

            
  
    <div class="desc"><p>Human readable details.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.direction" class="name">var <span class="ident">direction</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.has_direct_values" class="name">var <span class="ident">has_direct_values</span></p>
            

            
  
    <div class="desc"><p>Check if direct values are loaded for this point.</p>
<p>In some cases and based on the recipe only total values are available.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.has_values" class="name">var <span class="ident">has_values</span></p>
            

            
  
    <div class="desc"><p>Check if this point has results values.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.hoys" class="name">var <span class="ident">hoys</span></p>
            

            
  
    <div class="desc"><p>Return hours of the year for results if any.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.location" class="name">var <span class="ident">location</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.logic" class="name">var <span class="ident">logic</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.longest_state_ids" class="name">var <span class="ident">longest_state_ids</span></p>
            

            
  
    <div class="desc"><p>Get longest combination between blind states as blinds_state_ids.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.sources" class="name">var <span class="ident">sources</span></p>
            

            
  
    <div class="desc"><p>Get sorted list of light sources.</p>
<p>In most of the cases light sources are window groups.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.analysispoint.AnalysisPoint.states" class="name">var <span class="ident">states</span></p>
            

            
  
    <div class="desc"><p>Get list of states names for each source.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, location, direction)</p>
    </div>
    

    
  
    <div class="desc"><p>Create an analysis point.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.__init__', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an analysis point.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
    <span class="c1"># name of sources and their state. It&#39;s only meaningful in multi-phase daylight</span>
    <span class="c1"># analysis. In analysis for a single time it will be {None: [None]}</span>
    <span class="c1"># It is set inside _createDataStructure method on setting values.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="c1"># an empty list for values</span>
    <span class="c1"># for each source there will be a new list</span>
    <span class="c1"># inside each source list there will be a dictionary for each state</span>
    <span class="c1"># in each dictionary the key is the hoy and the values are a list which</span>
    <span class="c1"># is [total, direct]. If the value is not available it will be None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logic</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.ToString">
    <p>def <span class="ident">ToString</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Overwrite .NET ToString.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.ToString', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.ToString" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.annual_metrics">
    <p>def <span class="ident">annual_metrics</span>(</p><p>self, da_threshhold=None, udi_min_max=None, blinds_state_ids=None, occ_schedule=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate annual metrics.</p>
<p>Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</p>
<p>Args:
    da_threshhold: Threshhold for daylight autonomy in lux (default: 300).
    udi_min_max: A tuple of min, max value for useful daylight illuminance
        (default: (100, 2000)).
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.
    occ_schedule: An annual occupancy schedule (default: Office Schedule).</p>
<p>Returns:
    Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,
    Less than UDI, More than UDI</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.annual_metrics', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.annual_metrics" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">annual_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate annual metrics.</span>
<span class="sd">    Daylight autonomy, continious daylight autonomy and useful daylight illuminance.</span>
<span class="sd">    Args:</span>
<span class="sd">        da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">        udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">            (default: (100, 2000)).</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">        occ_schedule: An annual occupancy schedule (default: Office Schedule).</span>
<span class="sd">    Returns:</span>
<span class="sd">        Daylight autonomy, Continious daylight autonomy, Useful daylight illuminance,</span>
<span class="sd">        Less than UDI, More than UDI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_annual_metrics</span><span class="p">(</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.annual_solar_exposure">
    <p>def <span class="ident">annual_solar_exposure</span>(</p><p>self, threshhold=None, blinds_state_ids=None, occ_schedule=None, target_hours=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Annual Solar Exposure (ASE).</p>
<p>Calculate number of hours that this point is exposed to more than 1000lux
of direct sunlight. The point meets the traget in the number of hours is
less than 250 hours per year.</p>
<p>Args:
    threshhold: Threshhold for daylight autonomy in lux (default: 1000).
    blinds_state_ids: List of state ids for all the sources for input hoys.
        If you want a source to be removed set the state to -1. ase must
        be calculated without dynamic blinds but you can use this option
        to study the effect of different blind states.
    occ_schedule: An annual occupancy schedule.
    target_hours: Target minimum hours (default: 250).</p>
<p>Returns:
    Success as a Boolean, Number of hours, Problematic hours</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.annual_solar_exposure', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.annual_solar_exposure" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">annual_solar_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target_hours</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Annual Solar Exposure (ASE).</span>
<span class="sd">    Calculate number of hours that this point is exposed to more than 1000lux</span>
<span class="sd">    of direct sunlight. The point meets the traget in the number of hours is</span>
<span class="sd">    less than 250 hours per year.</span>
<span class="sd">    Args:</span>
<span class="sd">        threshhold: Threshhold for daylight autonomy in lux (default: 1000).</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys.</span>
<span class="sd">            If you want a source to be removed set the state to -1. ase must</span>
<span class="sd">            be calculated without dynamic blinds but you can use this option</span>
<span class="sd">            to study the effect of different blind states.</span>
<span class="sd">        occ_schedule: An annual occupancy schedule.</span>
<span class="sd">        target_hours: Target minimum hours (default: 250).</span>
<span class="sd">    Returns:</span>
<span class="sd">        Success as a Boolean, Number of hours, Problematic hours</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_direct_values</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Direct values are not loaded. Data is not available to calculate ASE.&#39;</span><span class="p">)</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_annual_solar_exposure</span><span class="p">(</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">threshhold</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">,</span> <span class="n">occ_schedule</span><span class="p">,</span> <span class="n">target_hours</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.blind_state_id">
    <p>def <span class="ident">blind_state_id</span>(</p><p>self, source, state)</p>
    </div>
    

    
  
    <div class="desc"><p>Get state id if available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.blind_state_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.blind_state_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">blind_state_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get state id if available.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid state input: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.blinds_state">
    <p>def <span class="ident">blinds_state</span>(</p><p>self, hoys=None, blinds_state_ids=None, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculte blinds state based on a control logic.</p>
<p>Overwrite self.logic to overwrite the logic for this point.</p>
<p>Args:
    hoys: List of hours of year. If None default is self.hoys.
    blinds_state_ids: List of state ids for all the sources for an hour. If you
        want a source to be removed set the state to -1. If not provided
        a longest combination of states from sources (window groups) will
        be used. Length of each item in states should be equal to number
        of sources.
    args: Additional inputs for self.logic. args will be passed to self.logic
    kwargs: Additional inputs for self.logic. kwargs will be passed to self.logic</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.blinds_state', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.blinds_state" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">blinds_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculte blinds state based on a control logic.</span>
<span class="sd">    Overwrite self.logic to overwrite the logic for this point.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: List of hours of year. If None default is self.hoys.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">            want a source to be removed set the state to -1. If not provided</span>
<span class="sd">            a longest combination of states from sources (window groups) will</span>
<span class="sd">            be used. Length of each item in states should be equal to number</span>
<span class="sd">            of sources.</span>
<span class="sd">        args: Additional inputs for self.logic. args will be passed to self.logic</span>
<span class="sd">        kwargs: Additional inputs for self.logic. kwargs will be passed to self.logic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="k">if</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
        <span class="c1"># recreate the states in case the inputs are the names of the states</span>
        <span class="c1"># and not the numbers.</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span>
        <span class="n">comb_ids</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">)</span>
        <span class="c1"># find state ids for each state if inputs are state names</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">comb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
                    <span class="n">comb_ids</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">comb</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Length of each state should be equal to number of sources: {}&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comb_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longest_state_ids</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Blinds combinations:</span><span class="se">\n</span><span class="s2">{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">comb_ids</span><span class="p">)))</span>
    <span class="c1"># collect the results for each combination</span>
    <span class="n">results</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">):</span>
        <span class="n">results</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>
    <span class="c1"># assume the last state happens for all</span>
    <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
    <span class="n">blinds_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
    <span class="n">ill_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
    <span class="n">dir_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
    <span class="n">success</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">hours_count</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hoys</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">)):</span>
            <span class="n">ill</span><span class="p">,</span> <span class="n">ill_dir</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">count</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">logic</span><span class="p">(</span><span class="n">ill</span><span class="p">,</span> <span class="n">ill_dir</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="n">blinds_index</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span>
                <span class="n">ill_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill</span>
                <span class="n">dir_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_dir</span>
                <span class="k">if</span> <span class="n">state</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">success</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">success</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">ill_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill</span>
            <span class="n">dir_values</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_dir</span>
    <span class="n">blinds_state</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">comb_ids</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">blinds_index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">blinds_state</span><span class="p">,</span> <span class="n">blinds_index</span><span class="p">,</span> <span class="n">ill_values</span><span class="p">,</span> <span class="n">dir_values</span><span class="p">,</span> <span class="n">success</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.combined_value_by_id">
    <p>def <span class="ident">combined_value_by_id</span>(</p><p>self, hoy, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get combined value from all sources based on state_id.</p>
<p>Args:
    hoy: hour of the year.
    blinds_state_ids: List of state ids for all the sources for an hour. If you
        want a source to be removed set the state to -1.</p>
<p>Returns:
    total, direct values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.combined_value_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.combined_value_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">combined_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoy: hour of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for an hour. If you</span>
<span class="sd">            want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        total, direct values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">direct</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="k">else</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> \
        <span class="s1">&#39;There should be a state for each source. #sources[{}] != #states[{}]&#39;</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">stateid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>
            <span class="n">direct</span> <span class="o">+=</span> <span class="n">d</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># direct value is None</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.combined_values_by_id">
    <p>def <span class="ident">combined_values_by_id</span>(</p><p>self, hoys=None, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get combined value from all sources based on state_id.</p>
<p>Args:
    hoys: A collection of hours of the year.
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.</p>
<p>Returns:
    Return a generator for (total, direct) values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.combined_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.combined_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">combined_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get combined value from all sources based on state_id.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hours of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Return a generator for (total, direct) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">blinds_state_ids</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">hours_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;hoys must be an iterable object: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hoys</span><span class="p">))</span>
        <span class="n">blinds_state_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">)]</span> <span class="o">*</span> <span class="n">hours_count</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> \
        <span class="s1">&#39;There should be a list of states for each hour. #states[{}] != #hours[{}]&#39;</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">))</span>
    <span class="n">dir_value</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="k">else</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hoys</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="n">dir_value</span>
        <span class="k">for</span> <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blinds_state_ids</span><span class="p">[</span><span class="n">count</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">stateid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
                <span class="n">t</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>
                <span class="n">direct</span> <span class="o">+=</span> <span class="n">d</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># direct value is None</span>
                <span class="k">pass</span>
        <span class="k">yield</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.coupled_value">
    <p>def <span class="ident">coupled_value</span>(</p><p>self, hoy, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get total and direct values for an hoy.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_value', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">coupled_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get total and direct values for an hoy.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.coupled_value_by_id">
    <p>def <span class="ident">coupled_value_by_id</span>(</p><p>self, hoy, source_id=None, state_id=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get total and direct values for an hoy.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_value_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_value_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">coupled_value_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get total and direct values for an hoy.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="n">source_id</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="n">state_id</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.coupled_values">
    <p>def <span class="ident">coupled_values</span>(</p><p>self, hoys=None, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get total and direct values for several hours of year.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">coupled_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get total and direct values for several hours of year.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.coupled_values_by_id">
    <p>def <span class="ident">coupled_values_by_id</span>(</p><p>self, hoys=None, source_id=None, state_id=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get total and direct values for several hours of year by source id.</p>
<p>Use this method to load the values if you have the ids for source and state.</p>
<p>Args:
    hoys: A collection of hoys.
    source_id: Id of source as an integer (default: 0).
    state_id: Id of state as an integer (default: 0).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.coupled_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">coupled_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get total and direct values for several hours of year by source id.</span>
<span class="sd">    Use this method to load the values if you have the ids for source and state.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hoys.</span>
<span class="sd">        source_id: Id of source as an integer (default: 0).</span>
<span class="sd">        state_id: Id of state as an integer (default: 0).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="n">source_id</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="n">state_id</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.daylight_autonomy">
    <p>def <span class="ident">daylight_autonomy</span>(</p><p>self, da_threshhold=None, blinds_state_ids=None, occ_schedule=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate daylight autonomy and continious daylight autonomy.</p>
<p>Args:
    da_threshhold: Threshhold for daylight autonomy in lux (default: 300).
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.
    occ_schedule: An annual occupancy schedule.</p>
<p>Returns:
    Daylight autonomy, Continious daylight autonomy</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.daylight_autonomy', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.daylight_autonomy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">daylight_autonomy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da_threshhold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate daylight autonomy and continious daylight autonomy.</span>
<span class="sd">    Args:</span>
<span class="sd">        da_threshhold: Threshhold for daylight autonomy in lux (default: 300).</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">        occ_schedule: An annual occupancy schedule.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Daylight autonomy, Continious daylight autonomy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">da_threshhold</span> <span class="o">=</span> <span class="n">da_threshhold</span> <span class="ow">or</span> <span class="mi">300</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
    <span class="n">DA</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">cda</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
            <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">da_threshhold</span><span class="p">:</span>
            <span class="n">DA</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cda</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cda</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">da_threshhold</span>
    <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">cda</span> <span class="o">/</span> <span class="n">total_hour_count</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.direct_value">
    <p>def <span class="ident">direct_value</span>(</p><p>self, hoy, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get direct value for an hour of the year.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.direct_value', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.direct_value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">direct_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get direct value for an hour of the year.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.direct_values">
    <p>def <span class="ident">direct_values</span>(</p><p>self, hoys=None, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get direct values for several hours of the year.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.direct_values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.direct_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">direct_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get direct values for several hours of the year.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.duplicate">
    <p>def <span class="ident">duplicate</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Duplicate the analysis point.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.duplicate', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.duplicate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Duplicate the analysis point.&quot;&quot;&quot;</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">AnalysisPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir</span><span class="p">)</span>
    <span class="c1"># This should be good enough as most of the time an analysis point will be</span>
    <span class="c1"># copied with no values assigned.</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">):</span>
        <span class="n">ap</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span><span class="p">)</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">logic</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logic</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ap</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.fromraw_values">
    <p>def <span class="ident">fromraw_values</span>(</p><p>cls, x, y, z, x1, y1, z1)</p>
    </div>
    

    
  
    <div class="desc"><p>Create an analysi point from 6 values.</p>
<p>x, y, z are the location of the point and x1, y1 and z1 is the direction.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.fromraw_values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.fromraw_values" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromraw_values</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an analysi point from 6 values.</span>
<span class="sd">    x, y, z are the location of the point and x1, y1 and z1 is the direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.max_values_by_id">
    <p>def <span class="ident">max_values_by_id</span>(</p><p>self, hoys=None, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get maximum value for all the hours.</p>
<p>Args:
    hoys: A collection of hours of the year.
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.</p>
<p>Returns:
    Return a tuple for sum of (total, direct) values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.max_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.max_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">max_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get maximum value for all the hours.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hours of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Return a tuple for sum of (total, direct) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
    <span class="n">direct</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_value">
    <p>def <span class="ident">set_coupled_value</span>(</p><p>self, value, hoy, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Set both total and direct values for a specific hour of the year.</p>
<p>Args:
    value: Value as as tuples (total, direct).
    hoy: The hour of the year that corresponds to this value.
    source: Name of the source of light. Only needed in case of multiple
        sources / window groups (default: None).
    state: State of the source if any (default: None).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_value', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_coupled_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set both total and direct values for a specific hour of the year.</span>
<span class="sd">    Args:</span>
<span class="sd">        value: Value as as tuples (total, direct).</span>
<span class="sd">        hoy: The hour of the year that corresponds to this value.</span>
<span class="sd">        source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">            sources / window groups (default: None).</span>
<span class="sd">        state: State of the source if any (default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_values">
    <p>def <span class="ident">set_coupled_values</span>(</p><p>self, values, hoys, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Set total and direct values for several hours of the year.</p>
<p>Args:
    values: List of values as tuples (total, direct).
    hoys: List of hours of the year that corresponds to input values.
    source: Name of the source of light. Only needed in case of multiple
        sources / window groups (default: None).
    state: State of the source if any (default: None).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.set_coupled_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_coupled_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set total and direct values for several hours of the year.</span>
<span class="sd">    Args:</span>
<span class="sd">        values: List of values as tuples (total, direct).</span>
<span class="sd">        hoys: List of hours of the year that corresponds to input values.</span>
<span class="sd">        source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">            sources / window groups (default: None).</span>
<span class="sd">        state: State of the source if any (default: None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)</span> <span class="ow">or</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
            <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Length of values [</span><span class="si">%d</span><span class="s1">] is not equal to length of hoys [</span><span class="si">%d</span><span class="s1">].&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>
    <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Wrong input: {}. Input values must be of length of 2.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.set_value">
    <p>def <span class="ident">set_value</span>(</p><p>self, value, hoy, source=None, state=None, is_direct=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Set value for a specific hour of the year.</p>
<p>Args:
    value: Value as a number.
    hoy: The hour of the year that corresponds to this value.
    source: Name of the source of light. Only needed in case of multiple
        sources / window groups (default: None).
    state: State of the source if any (default: None).
    is_direct: Set to True if the value is direct contribution of sunlight.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.set_value', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.set_value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set value for a specific hour of the year.</span>
<span class="sd">    Args:</span>
<span class="sd">        value: Value as a number.</span>
<span class="sd">        hoy: The hour of the year that corresponds to this value.</span>
<span class="sd">        source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">            sources / window groups (default: None).</span>
<span class="sd">        state: State of the source if any (default: None).</span>
<span class="sd">        is_direct: Set to True if the value is direct contribution of sunlight.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.set_values">
    <p>def <span class="ident">set_values</span>(</p><p>self, values, hoys, source=None, state=None, is_direct=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Set values for several hours of the year.</p>
<p>Args:
    values: List of values as numbers.
    hoys: List of hours of the year that corresponds to input values.
    source: Name of the source of light. Only needed in case of multiple
        sources / window groups (default: None).
    state: State of the source if any (default: None).
    is_direct: Set to True if the value is direct contribution of sunlight.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.set_values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.set_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">hoys</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_direct</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set values for several hours of the year.</span>
<span class="sd">    Args:</span>
<span class="sd">        values: List of values as numbers.</span>
<span class="sd">        hoys: List of hours of the year that corresponds to input values.</span>
<span class="sd">        source: Name of the source of light. Only needed in case of multiple</span>
<span class="sd">            sources / window groups (default: None).</span>
<span class="sd">        state: State of the source if any (default: None).</span>
<span class="sd">        is_direct: Set to True if the value is direct contribution of sunlight.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)</span> <span class="ow">or</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">GeneratorType</span><span class="p">)):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">),</span> \
            <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Length of values [</span><span class="si">%d</span><span class="s1">] is not equal to length of hoys [</span><span class="si">%d</span><span class="s1">].&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hoys</span><span class="p">)))</span>
    <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_structure</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_direct</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_directLoaded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Failed to load {} results for window_group [{}], state[{}]&#39;</span>
                <span class="s1">&#39; for hour {}.</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span> <span class="k">if</span> <span class="n">is_direct</span> <span class="k">else</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span>
                                           <span class="n">sid</span><span class="p">,</span> <span class="n">stateid</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.source_id">
    <p>def <span class="ident">source_id</span>(</p><p>self, source)</p>
    </div>
    

    
  
    <div class="desc"><p>Get source id from source name.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.source_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.source_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">source_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get source id from source name.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid source input: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.sum_values_by_id">
    <p>def <span class="ident">sum_values_by_id</span>(</p><p>self, hoys=None, blinds_state_ids=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get sum of value for all the hours.</p>
<p>This method is mostly useful for radiation and solar access analysis.</p>
<p>Args:
    hoys: A collection of hours of the year.
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.</p>
<p>Returns:
    Return a tuple for sum of (total, direct) values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.sum_values_by_id', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.sum_values_by_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sum_values_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get sum of value for all the hours.</span>
<span class="sd">    This method is mostly useful for radiation and solar access analysis.</span>
<span class="sd">    Args:</span>
<span class="sd">        hoys: A collection of hours of the year.</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Return a tuple for sum of (total, direct) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hoys</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;&#39;long&#39; and &#39;NoneType&#39;&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="c1"># direct value is not loaded</span>
            <span class="n">direct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span><span class="p">,</span> <span class="n">direct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.to_rad_string">
    <p>def <span class="ident">to_rad_string</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return Radiance string for a test point.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.to_rad_string', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.to_rad_string" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_rad_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return Radiance string for a test point.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.unload">
    <p>def <span class="ident">unload</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Unload values and sources.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.unload', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.unload" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unload values and sources.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.useful_daylight_illuminance">
    <p>def <span class="ident">useful_daylight_illuminance</span>(</p><p>self, udi_min_max=None, blinds_state_ids=None, occ_schedule=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate useful daylight illuminance.</p>
<p>Args:
    udi_min_max: A tuple of min, max value for useful daylight illuminance
        (default: (100, 2000)).
    blinds_state_ids: List of state ids for all the sources for input hoys. If
        you want a source to be removed set the state to -1.
    occ_schedule: An annual occupancy schedule.</p>
<p>Returns:
    Useful daylight illuminance, Less than UDI, More than UDI</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.useful_daylight_illuminance', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.useful_daylight_illuminance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">useful_daylight_illuminance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udi_min_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                <span class="n">occ_schedule</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate useful daylight illuminance.</span>
<span class="sd">    Args:</span>
<span class="sd">        udi_min_max: A tuple of min, max value for useful daylight illuminance</span>
<span class="sd">            (default: (100, 2000)).</span>
<span class="sd">        blinds_state_ids: List of state ids for all the sources for input hoys. If</span>
<span class="sd">            you want a source to be removed set the state to -1.</span>
<span class="sd">        occ_schedule: An annual occupancy schedule.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Useful daylight illuminance, Less than UDI, More than UDI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">udi_min_max</span> <span class="o">=</span> <span class="n">udi_min_max</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="n">udiMin</span><span class="p">,</span> <span class="n">udiMax</span> <span class="o">=</span> <span class="n">udi_min_max</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="n">schedule</span> <span class="o">=</span> <span class="n">occ_schedule</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
    <span class="n">udi</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">udi_l</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">udi_m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_hour_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">combined_values_by_id</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">blinds_state_ids</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">h</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">:</span>
            <span class="n">total_hour_count</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">udiMin</span><span class="p">:</span>
            <span class="n">udi_l</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">udiMax</span><span class="p">:</span>
            <span class="n">udi_m</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">udi</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">total_hour_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There is 0 hours available in the schedule.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_l</span> <span class="o">/</span> <span class="n">total_hour_count</span><span class="p">,</span> \
        <span class="mi">100</span> <span class="o">*</span> <span class="n">udi_m</span> <span class="o">/</span> <span class="n">total_hour_count</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.value">
    <p>def <span class="ident">value</span>(</p><p>self, hoy, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get total value for an hour of the year.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.value', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoy</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get total value for an hour of the year.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.analysispoint.AnalysisPoint.values">
    <p>def <span class="ident">values</span>(</p><p>self, hoys=None, source=None, state=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get values for several hours of the year.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.analysispoint.AnalysisPoint.values', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.analysispoint.AnalysisPoint.values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get values for several hours of the year.&quot;&quot;&quot;</span>
    <span class="c1"># find the id for source and state</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1"># find the state id</span>
    <span class="n">stateid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blind_state_id</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoys</span>
    <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hoy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hourly values are not available for {}.&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">DateTime</span><span class="o">.</span><span class="n">fromHoy</span><span class="p">(</span><span class="n">hoy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sid</span><span class="p">][</span><span class="n">stateid</span><span class="p">][</span><span class="n">hoy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>
  </footer>
</div>
</body>
</html>